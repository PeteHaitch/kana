{"version":3,"file":"static/js/612.3ce4e32d.chunk.js","mappings":"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","sources":["workers/KanaDBHandler.js","workers/DownloadsDBHandler.js","workers/helpers.js","utils/utils.js","workers/scran.worker.js","workers/translate.js","../webpack/bootstrap","../webpack/runtime/chunk loaded","../webpack/runtime/compat get default export","../webpack/runtime/define property getters","../webpack/runtime/ensure chunk","../webpack/runtime/get javascript chunk filename","../webpack/runtime/get mini-css chunk filename","../webpack/runtime/global","../webpack/runtime/hasOwnProperty shorthand","../webpack/runtime/make namespace object","../webpack/runtime/node module decorator","../webpack/runtime/publicPath","../webpack/runtime/importScripts chunk loading","../webpack/runtime/startup chunk dependencies","../webpack/startup"],"sourcesContent":["var kanaDB;\nvar init = null;\n\nexport function initialize() {\n  init = new Promise((resolve) => {\n    // initialize database on worker creation\n    kanaDB = indexedDB.open(\"KanaDB\", 2);\n\n    kanaDB.onupgradeneeded = (e) => {\n      var kanaDBClient = e.target.result;\n\n      // Currently purging all existing stores when the version is updated.\n      // At some point we may add a more sophisticated upgrade mechanism.\n      try {\n        kanaDBClient.deleteObjectStore(\"analysis\");\n      } catch (e) {}\n      try {\n        kanaDBClient.deleteObjectStore(\"analysis_meta\");\n      } catch (e) {}\n      try {\n        kanaDBClient.deleteObjectStore(\"file\");\n      } catch (e) {}\n      try {\n        kanaDBClient.deleteObjectStore(\"file_meta\");\n      } catch (e) {}\n\n      kanaDBClient.createObjectStore(\"analysis\", { keyPath: \"id\" });\n      kanaDBClient.createObjectStore(\"analysis_meta\", { keyPath: \"id\" });\n      kanaDBClient.createObjectStore(\"file\", { keyPath: \"id\" });\n      kanaDBClient.createObjectStore(\"file_meta\", { keyPath: \"id\" });\n    };\n\n    // Send existing stored analyses, if available.\n    kanaDB.onsuccess = () => {\n      getRecordsResolver(resolve);\n    };\n\n    kanaDB.onerror = () => {\n      resolve(null);\n    };\n  });\n\n  return init;\n}\n\nfunction getRecordsResolver(resolve, store = null) {\n  if (store === null) {\n    store = kanaDB.result\n      .transaction([\"analysis_meta\"], \"readonly\")\n      .objectStore(\"analysis_meta\");\n  }\n\n  var allAnalysis = store.getAll();\n\n  allAnalysis.onsuccess = function () {\n    let vals = allAnalysis.result;\n    vals.forEach((x) => {\n      delete x.files;\n    }); // no need to transfer that.\n    resolve(vals);\n  };\n  allAnalysis.onerror = function () {\n    resolve(null);\n  };\n}\n\n/** Helper functions **/\nasync function loadContent(id, store) {\n  return new Promise((resolve) => {\n    let request = store.get(id);\n    request.onsuccess = function () {\n      if (request.result !== undefined) {\n        resolve(request.result);\n      } else {\n        resolve(null);\n      }\n    };\n    request.onerror = function () {\n      resolve(null);\n    };\n  });\n}\n\nfunction allOK(promises) {\n  return Promise.allSettled(promises).then((vals) => {\n    for (const x of vals) {\n      if (!x) {\n        return false;\n      }\n    }\n    return true;\n  });\n}\n\nexport async function getRecords() {\n  await init;\n  return new Promise((resolve) => {\n    getRecordsResolver(resolve);\n  });\n}\n\n/** Functions to save content **/\nexport async function saveFile(id, buffer) {\n  await init;\n  let trans = kanaDB.result.transaction([\"file\", \"file_meta\"], \"readwrite\");\n  let file_store = trans.objectStore(\"file\");\n  let meta_store = trans.objectStore(\"file_meta\");\n\n  var meta = await loadContent(id, meta_store);\n  var refcount;\n  if (meta === null) {\n    refcount = 0;\n  } else {\n    refcount = meta[\"count\"];\n  }\n  refcount++;\n\n  var data_saving = new Promise((resolve) => {\n    var putrequest = file_store.put({ id: id, payload: buffer.buffer });\n    putrequest.onsuccess = function (event) {\n      resolve(true);\n    };\n    putrequest.onerror = function (event) {\n      resolve(false);\n    };\n  });\n\n  var ref_saving = new Promise((resolve) => {\n    meta.count = refcount;\n    var putrequest = meta_store.put(meta);\n    putrequest.onsuccess = function (event) {\n      resolve(true);\n    };\n    putrequest.onerror = function (event) {\n      resolve(false);\n    };\n  });\n\n  return allOK([data_saving, ref_saving]);\n}\n\nexport async function saveAnalysis(id, state, files, title) {\n  await init;\n  let trans = kanaDB.result.transaction(\n    [\"analysis\", \"analysis_meta\"],\n    \"readwrite\"\n  );\n  let analysis_store = trans.objectStore(\"analysis\");\n  let meta_store = trans.objectStore(\"analysis_meta\");\n\n  if (id == null) {\n    let already = await new Promise((resolve) =>\n      getRecordsResolver(resolve, meta_store)\n    );\n    id = String(already.length);\n  }\n\n  var data_saving = new Promise((resolve) => {\n    var putrequest = analysis_store.put({ id: id, payload: state.buffer });\n    putrequest.onsuccess = function (event) {\n      resolve(true);\n    };\n    putrequest.onerror = function (event) {\n      resolve(false);\n    };\n  });\n\n  var id_saving = new Promise((resolve) => {\n    var putrequest = meta_store.put({\n      id: id,\n      files: files,\n      time: Number(new Date()),\n      title: title,\n    });\n    putrequest.onsuccess = function (event) {\n      resolve(true);\n    };\n    putrequest.onerror = function (event) {\n      resolve(false);\n    };\n  });\n\n  if (await allOK([data_saving, id_saving])) {\n    return id;\n  } else {\n    return null;\n  }\n}\n\n/** Functions to load content **/\nexport async function loadFile(id) {\n  await init;\n  let file_store = kanaDB.result\n    .transaction([\"file\"], \"readonly\")\n    .objectStore(\"file\");\n\n  var meta = await loadContent(id, file_store);\n  return new Uint8Array(meta[\"payload\"]);\n}\n\nexport async function loadAnalysis(id) {\n  await init;\n  let analysis_store = kanaDB.result\n    .transaction([\"analysis\"], \"readonly\")\n    .objectStore(\"analysis\");\n  var meta = await loadContent(id, analysis_store);\n  return new Uint8Array(meta[\"payload\"]);\n}\n\n/** Functions to load content **/\nexport async function removeFile(id) {\n  await init;\n  let trans = kanaDB.result.transaction([\"file\", \"file_meta\"], \"readwrite\");\n  let file_store = trans.objectStore(\"file\");\n  let meta_store = trans.objectStore(\"file_meta\");\n\n  var meta = await loadContent(id, meta_store);\n  var refcount = meta[\"count\"];\n  refcount--;\n  var promises = [];\n\n  if (refcount === 0) {\n    promises.push(\n      new Promise((resolve) => {\n        let request = file_store.remove(id);\n        request.onerror = function (event) {\n          resolve(false);\n        };\n        request.onsuccess = function (event) {\n          resolve(true);\n        };\n      })\n    );\n    promises.push(\n      new Promise((resolve) => {\n        let request = meta_store.delete(id);\n        request.onerror = function (event) {\n          resolve(false);\n        };\n        request.onsuccess = function (event) {\n          resolve(true);\n        };\n      })\n    );\n  } else {\n    promises.push(\n      new Promise((resolve) => {\n        meta.count = refcount;\n        let request = meta_store.put(meta);\n        request.onsuccess = function (event) {\n          resolve(true);\n        };\n        request.onerror = function (event) {\n          resolve(false);\n        };\n      })\n    );\n  }\n\n  return allOK(promises);\n}\n\nexport async function removeAnalysis(id) {\n  await init;\n  let trans = kanaDB.result.transaction(\n    [\"analysis\", \"analysis_meta\"],\n    \"readwrite\"\n  );\n  let analysis_store = trans.objectStore(\"analysis\");\n  let meta_store = trans.objectStore(\"analysis_meta\");\n\n  var promises = [];\n\n  promises.push(\n    new Promise((resolve) => {\n      let request = analysis_store.delete(id);\n      request.onsuccess = function (event) {\n        resolve(true);\n      };\n      request.onerror = function (event) {\n        resolve(false);\n      };\n    })\n  );\n\n  // Removing all files as well.\n  var meta = await loadContent(id, meta_store);\n  for (const [k, v] of Object.entries(meta[\"files\"][\"datasets\"])) {\n    for (const f of v[\"files\"]) {\n      promises.push(removeFile(f[\"id\"]));\n    }\n  }\n\n  promises.push(\n    new Promise((resolve) => {\n      let request = meta_store.delete(id);\n      request.onsuccess = function (event) {\n        resolve(true);\n      };\n      request.onerror = function (event) {\n        resolve(false);\n      };\n    })\n  );\n\n  return allOK(promises);\n}\n","var DownloadsDB;\nvar init = null;\n\nexport function initialize() {\n  if (init === null) {\n    init = new Promise((resolve, reject) => {\n      // initialize database on worker creation\n      DownloadsDB = indexedDB.open(\"DownloadsDB\", 3);\n\n      DownloadsDB.onupgradeneeded = (e) => {\n        var DownloadsDBClient = e.target.result;\n\n        // Currently purging all existing stores when the version is updated.\n        // At some point we may add a more sophisticated upgrade mechanism.\n        try {\n          DownloadsDBClient.deleteObjectStore(\"downloads\");\n        } catch (e) {}\n\n        DownloadsDBClient.createObjectStore(\"downloads\", { keyPath: \"url\" });\n      };\n\n      DownloadsDB.onsuccess = () => {\n        resolve(null);\n      };\n\n      DownloadsDB.onerror = () => {\n        reject(\"failed to initialize DownloadsDB\");\n      };\n    });\n  }\n\n  return init;\n}\n\nexport async function list() {\n  await init;\n  let trans = DownloadsDB.result.transaction([\"downloads\"], \"readonly\");\n  let download_store = trans.objectStore(\"downloads\");\n  return download_store.getAllKeys();\n}\n\nexport async function get(url, params = null, force = false) {\n  await init;\n\n  if (!force) {\n    let trans = DownloadsDB.result.transaction([\"downloads\"], \"readonly\");\n    let download_store = trans.objectStore(\"downloads\");\n    var data_check = new Promise((resolve) => {\n      var already = download_store.get(url);\n      already.onsuccess = function (event) {\n        if (already.result !== undefined) {\n          resolve(already.result.payload);\n        } else {\n          resolve(null);\n        }\n      };\n      already.onerror = function (event) {\n        resolve(null);\n      };\n    });\n\n    var found = await data_check;\n    if (found !== null) {\n      return found;\n    }\n  }\n\n  var req;\n  if (params == null) {\n    req = fetch(url);\n  } else {\n    req = fetch(url, params);\n  }\n\n  var res = await req;\n  if (!res.ok) {\n    throw \"failed to download '\" + url + \"' (\" + res.status + \")\";\n  }\n  var buffer = await res.arrayBuffer();\n\n  // Technically, this isn't quite right, because we need to close the read\n  // transaction before opening the write transaction; multiple queries to\n  // the same URL from different workers could cause multiple downloads if\n  // they each miss each other's read check. But oh well; the auto-commit\n  // of IDB transactions means that it's hard to do any better. (Specifically,\n  // we can't do an async fetch while the transaction is still open, because\n  // it just closes before the fetch is done.)\n  let trans = DownloadsDB.result.transaction([\"downloads\"], \"readwrite\");\n  let download_store = trans.objectStore(\"downloads\");\n  var data_saving = new Promise((resolve) => {\n    var putrequest = download_store.put({ url: url, payload: buffer });\n    putrequest.onsuccess = function (event) {\n      resolve(true);\n    };\n    putrequest.onerror = function (event) {\n      resolve(false);\n    };\n  });\n\n  let success = await data_saving;\n  if (!success) {\n    throw \"failed to download resources for '\" + url + \"'\";\n  }\n\n  return buffer;\n}\n\nexport async function remove(url) {\n  await init;\n  let trans = DownloadsDB.result.transaction([\"downloads\"], \"readwrite\");\n  let download_store = trans.objectStore(\"downloads\");\n\n  var removal = new Promise((resolve) => {\n    let request = download_store.delete(url);\n    request.onsuccess = function (event) {\n      resolve(true);\n    };\n    request.onerror = function (event) {\n      resolve(false);\n    };\n  });\n\n  return await removal;\n}\n","import * as bakana from \"bakana\";\nimport * as gesel from \"gesel\";\nimport * as remotes from \"bakana-remotes\";\nimport * as downloads from \"./DownloadsDBHandler.js\";\n\n// Evade CORS problems and enable caching.\nconst proxy = \"https://cors-proxy.aaron-lun.workers.dev\";\nasync function proxyAndCache(url) {\n  let buffer = await downloads.get(proxy + \"/\" + encodeURIComponent(url));\n  return new Uint8Array(buffer);\n}\n\nbakana.CellLabellingState.setDownload(proxyAndCache);\ngesel.setGeneDownload(proxyAndCache);\nbakana.RnaQualityControlState.setDownload(proxyAndCache);\n\ngesel.referenceDownload(async (file, start, end) => {\n  let url = gesel.referenceBaseUrl() + \"/\" + file;\n  let full = proxy + \"/\" + encodeURIComponent(url);\n  if (start == null && end == null) {\n    let buffer = await downloads.get(full);\n    return new Response(buffer);\n  } else {\n    return fetch(full + \"?start=\" + String(start) + \"&end=\" + String(end));\n  }\n});\n\ngesel.geneDownload(async (file) => {\n  let url = gesel.geneBaseUrl() + \"/\" + file;\n  let buffer = await downloads.get(proxy + \"/\" + encodeURIComponent(url));\n  return new Response(buffer);\n});\n\nremotes.ExperimentHubDataset.setDownloadFun(proxyAndCache);\nbakana.availableReaders[\"ExperimentHub\"] = remotes.ExperimentHubDataset;\n\nexport function extractBuffers(object, store) {\n  if (!object) {\n    return;\n  }\n\n  if (Array.isArray(object)) {\n    for (const element of object) {\n      extractBuffers(element, store);\n    }\n  } else if (object.constructor == Object) {\n    for (const [key, element] of Object.entries(object)) {\n      extractBuffers(element, store);\n    }\n  } else if (ArrayBuffer.isView(object)) {\n    if (!(object.buffer instanceof ArrayBuffer)) {\n      throw \"only ArrayBuffers should be in the message payload\";\n    }\n    store.push(object.buffer);\n  }\n}\n\nexport function postAttempt(step) {\n  postMessage({\n    type: `${step}_START`,\n  });\n}\n\nexport function postSuccess(step, info) {\n  if (typeof info == \"undefined\") {\n    postMessage({\n      type: `${step}_CACHE`,\n    });\n  } else {\n    var transferable = [];\n    extractBuffers(info, transferable);\n    postMessage(\n      {\n        type: `${step}_DATA`,\n        resp: info,\n      },\n      transferable\n    );\n  }\n}\n\nexport function postError(type, err, fatal) {\n  postMessage({\n    type: `${type}_ERROR`,\n    resp: {\n      reason: err.toString(),\n      fatal: fatal,\n    },\n  });\n}\n\nexport function splitMetricsByBlock(metrics, blockLevels, blockIds) {\n  var output = {};\n  var blocks = blockIds.slice();\n  for (var b = 0; b < blockLevels.length; b++) {\n    let current = {};\n    for (const [key, val] of Object.entries(metrics)) {\n      current[key] = val.slice().filter((x, i) => blocks[i] == b);\n    }\n    output[blockLevels[b]] = current;\n  }\n  return output;\n}\n\nexport function splitThresholdsByBlock(thresholds, blockLevels) {\n  var output = {};\n  for (const x of blockLevels) {\n    output[x] = {};\n  }\n\n  for (const [key, val] of Object.entries(thresholds)) {\n    for (var b = 0; b < blockLevels.length; b++) {\n      output[blockLevels[b]][key] = val[b];\n    }\n  }\n\n  return output;\n}\n\nexport async function fetchStepSummary(state, step) {\n  // do not send any response to UI if they have not changed\n  if (!state[step].changed) {\n    return undefined;\n  }\n\n  if (step === \"inputs\") {\n    let output = {};\n\n    let ngenes = {};\n    for (const a of state[step].fetchCountMatrix().available()) {\n      ngenes[a] = state[step].fetchCountMatrix().get(a).numberOfRows();\n    }\n\n    let gene_info = {};\n    for (const [k, v] of Object.entries(\n      state[step].fetchFeatureAnnotations()\n    )) {\n      let info = {};\n      for (const c of v.columnNames()) {\n        let col = v.column(c);\n        if (Array.isArray(col)) {\n          info[c] = col;\n        }\n      }\n\n      if (Array.isArray(v.rowNames())) {\n        info[\"rownames\"] = v.rowNames();\n      }\n\n      gene_info[k] = info;\n    }\n\n    let cell_info = {};\n    for (const c of state[step].fetchCellAnnotations().columnNames()) {\n      let col = state[step].fetchCellAnnotations().column(c);\n      if (isArrayOrView(col)) {\n        const ksumm = describeColumn(col, {\n          all: false,\n          unique: true,\n          colname: c,\n        });\n        cell_info[c] = ksumm;\n      }\n    }\n\n    var blocks = state[step].fetchBlockLevels();\n    if (blocks !== null) {\n      const col = state[step].fetchBlock().slice();\n      if (isArrayOrView(col)) {\n        const ksumm = describeColumn(col, {\n          all: false,\n          unique: true,\n          colname: \"__batch__\",\n        });\n        cell_info[\"__batch__\"] = ksumm;\n      }\n    }\n\n    output = {\n      num_cells: state[step].fetchCountMatrix().numberOfColumns(),\n      num_genes: ngenes,\n      genes: gene_info,\n      annotations: cell_info,\n    };\n\n    return output;\n  } else if (step === \"rna_quality_control\") {\n    let metrics = {\n      sums: state[step].fetchMetrics().sums(),\n      detected: state[step].fetchMetrics().detected(),\n      proportion: state[step].fetchMetrics().subsetProportions(0),\n    };\n\n    let output = {};\n    var blocks = state[\"inputs\"].fetchBlockLevels();\n\n    if (blocks === null) {\n      blocks = [\"default\"];\n      output.data = { default: metrics };\n    } else {\n      let bids = state[\"inputs\"].fetchBlock();\n      output.data = splitMetricsByBlock(metrics, blocks, bids);\n    }\n\n    let listed = {\n      sums: state[step].fetchFilters().thresholdsSums(),\n      detected: state[step].fetchFilters().thresholdsDetected(),\n      proportion: state[step].fetchFilters().thresholdsSubsetProportions(0),\n    };\n    output.thresholds = splitThresholdsByBlock(listed, blocks);\n\n    return output;\n  } else if (step === \"adt_quality_control\") {\n    let metrics = {\n      sums: state[step].fetchMetrics().sums(),\n      detected: state[step].fetchMetrics().detected(),\n      proportion: state[step].fetchMetrics().subsetTotals(0),\n    };\n\n    var output = {};\n    var blocks = state[\"inputs\"].fetchBlockLevels();\n    if (blocks === null) {\n      blocks = [\"default\"];\n      output.data = { default: metrics };\n    } else {\n      let bids = state[\"inputs\"].fetchBlock();\n      output.data = splitMetricsByBlock(metrics, blocks, bids);\n    }\n\n    let listed = {\n      detected: state[step].fetchFilters().thresholdsDetected(),\n      proportion: state[step].fetchFilters().thresholdsSubsetTotals(0),\n    };\n    output.thresholds = splitThresholdsByBlock(listed, blocks);\n\n    // We don't use sums for filtering but we do report it in the metrics,\n    // so we just add some NaNs to the thresholds for consistency.\n    for (const [k, v] of Object.entries(output.thresholds)) {\n      v.sums = NaN;\n    }\n\n    return output;\n  } else if (step === \"crispr_quality_control\") {\n    let metrics = {\n      sums: state[step].fetchMetrics().sums(),\n      detected: state[step].fetchMetrics().detected(),\n      proportion: state[step].fetchMetrics().maxProportions(),\n    };\n\n    let output = {};\n    var blocks = state[\"inputs\"].fetchBlockLevels();\n    if (blocks === null) {\n      blocks = [\"default\"];\n      output.data = { default: metrics };\n    } else {\n      let bids = state[\"inputs\"].fetchBlock();\n      output.data = splitMetricsByBlock(metrics, blocks, bids);\n    }\n\n    let listed = {\n      count: state[step].fetchFilters().thresholdsMaxCount(0),\n    };\n    output.thresholds = splitThresholdsByBlock(listed, blocks);\n\n    return output;\n  } else if (step === \"cell_filtering\") {\n    let remaining = 0,\n      discard_vec = null;\n    const discardBuff = state[step].fetchDiscards();\n    if (discardBuff) {\n      discardBuff.forEach((x) => {\n        remaining += x == 0;\n      });\n      discard_vec = discardBuff.slice();\n    } else {\n      remaining = state.inputs.fetchCountMatrix().numberOfColumns();\n    }\n    let output = { retained: remaining, discard: discard_vec };\n    return output;\n  } else if (step === \"rna_normalization\") {\n    return {};\n  } else if (step === \"adt_normalization\") {\n    return {};\n  } else if (step === \"crispr_normalization\") {\n    return {};\n  } else if (step === \"feature_selection\") {\n    let output = {\n      means: state[step].fetchResults().means(),\n      vars: state[step].fetchResults().variances(),\n      fitted: state[step].fetchResults().fitted(),\n      resids: state[step].fetchResults().residuals(),\n    };\n    return output;\n  } else if (\n    step === \"rna_pca\" ||\n    step === \"adt_pca\" ||\n    step === \"crispr_pca\"\n  ) {\n    let pcs = state[step].fetchPCs();\n    var var_exp = pcs.varianceExplained();\n    var total_var = pcs.totalVariance();\n    var_exp.forEach((x, i) => {\n      var_exp[i] = x / total_var;\n    });\n    return {\n      var_exp: var_exp,\n    };\n  } else if (step === \"combine_embeddings\") {\n    return {};\n  } else if (step === \"batch_correction\") {\n    return {};\n  } else if (step === \"neighbor_index\") {\n    return {};\n  } else if (step === \"tsne\" || step === \"umap\") {\n    return await state[step].fetchResults();\n  } else if (step === \"kmeans_cluster\") {\n    return {};\n  } else if (step === \"snn_graph_cluster\") {\n    return {};\n  } else if (step === \"choose_clustering\") {\n    var clusters = state[step].fetchClusters();\n    return { clusters: clusters.slice() };\n  } else if (step === \"marker_detection\") {\n    return {};\n  } else if (step === \"cell_labelling\") {\n    return await state[step].fetchResults();\n  } else if (step === \"custom_selections\") {\n    return {};\n  } else if (step === \"feature_set_enrichment\") {\n    let collections = state.feature_set_enrichment.fetchCollectionDetails();\n    let sets = state.feature_set_enrichment.fetchSetDetails();\n    return {\n      collections: collections,\n      sets: {\n        names: sets.names,\n        descriptions: sets.descriptions,\n        sizes: sets.sizes.slice(),\n        collections: sets.collections.slice(),\n      },\n    };\n  }\n}\n\nexport function isArrayOrView(col) {\n  return Array.isArray(col) || ArrayBuffer.isView(col);\n}\n\nexport function describeColumn(\n  col,\n  { all = false, unique = false, colname = null } = {}\n) {\n  let res;\n  if (isArrayOrView(col)) {\n    res = bakana.summarizeArray(col);\n    const uqVals = new Set(col);\n    res[\"num_unique\"] = uqVals.size;\n\n    if ((uqVals.size <= 50) & unique) res[\"__unique__\"] = [...uqVals].sort();\n    if (all) res[\"_all_\"] = col;\n\n    // if type is continous and unique values is less than 50, type is both\n    if (res[\"type\"] === \"continuous\" && uqVals.size <= 50) res[\"type\"] = \"both\";\n\n    if (typeof colname === \"string\" || colname instanceof String)\n      res[\"name\"] = colname;\n  }\n\n  return res;\n}\n","import { randomColor } from \"randomcolor\";\n\nexport const getColors = (data) => {\n  const palette = {\n    1: [\"#1b9e77\"],\n    2: [\"#1b9e77\", \"#d95f02\"],\n    3: [\"#1b9e77\", \"#d95f02\", \"#7570b3\"],\n    4: [\"#1b9e77\", \"#d95f02\", \"#7570b3\", \"#e7298a\"],\n    5: [\"#1b9e77\", \"#d95f02\", \"#7570b3\", \"#e7298a\", \"#66a61e\"],\n    6: [\"#1b9e77\", \"#d95f02\", \"#7570b3\", \"#e7298a\", \"#66a61e\", \"#e6ab02\"],\n    7: [\n      \"#1b9e77\",\n      \"#d95f02\",\n      \"#7570b3\",\n      \"#e7298a\",\n      \"#66a61e\",\n      \"#e6ab02\",\n      \"#a6761d\",\n    ],\n    8: [\n      \"#1b9e77\",\n      \"#d95f02\",\n      \"#7570b3\",\n      \"#e7298a\",\n      \"#66a61e\",\n      \"#e6ab02\",\n      \"#a6761d\",\n      \"#666666\",\n    ],\n    9: [\n      \"#a6cee3\",\n      \"#1f78b4\",\n      \"#b2df8a\",\n      \"#33a02c\",\n      \"#fb9a99\",\n      \"#e31a1c\",\n      \"#fdbf6f\",\n      \"#ff7f00\",\n      \"#cab2d6\",\n    ],\n    10: [\n      \"#a6cee3\",\n      \"#1f78b4\",\n      \"#b2df8a\",\n      \"#33a02c\",\n      \"#fb9a99\",\n      \"#e31a1c\",\n      \"#fdbf6f\",\n      \"#ff7f00\",\n      \"#cab2d6\",\n      \"#6a3d9a\",\n    ],\n    11: [\n      \"#a6cee3\",\n      \"#1f78b4\",\n      \"#b2df8a\",\n      \"#33a02c\",\n      \"#fb9a99\",\n      \"#e31a1c\",\n      \"#fdbf6f\",\n      \"#ff7f00\",\n      \"#cab2d6\",\n      \"#6a3d9a\",\n      \"#ffff99\",\n    ],\n    12: [\n      \"#a6cee3\",\n      \"#1f78b4\",\n      \"#b2df8a\",\n      \"#33a02c\",\n      \"#fb9a99\",\n      \"#e31a1c\",\n      \"#fdbf6f\",\n      \"#ff7f00\",\n      \"#cab2d6\",\n      \"#6a3d9a\",\n      \"#ffff99\",\n      \"#b15928\",\n    ],\n  };\n\n  let cluster_count = Math.max(...data) + 1;\n  let cluster_colors = null;\n  if (cluster_count > Object.keys(palette).length) {\n    cluster_colors = randomColor({\n      luminosity: \"dark\",\n      count: cluster_count + 1,\n    });\n  } else {\n    cluster_colors = palette[cluster_count.toString()];\n  }\n\n  return cluster_colors;\n};\n\nexport function isObject(object) {\n  return typeof object === \"object\" && Array.isArray(object) === false;\n}\n\nexport const code = \"K@𝜂a#$c3ll\";\n\n// this function is from https://developer.mozilla.org/en-US/docs/Glossary/Base64\nexport function utf8_to_b64(str) {\n  return window.btoa(unescape(encodeURIComponent(str)));\n}\n\nexport function generateUID(resource) {\n  let base = `${resource.format}`;\n  switch (resource.format) {\n    case \"SummarizedExperiment\":\n      base += `::${resource.rds.name}::${resource.rds.lastModified}::${resource.rds.size}`;\n      return utf8_to_b64(base);\n    case \"MatrixMarket\":\n      for (let key of [\"genes\", \"mtx\", \"annotations\"]) {\n        if (resource[key]) {\n          base += `::${resource[key].name}::${resource[key].lastModified}::${resource[key].size}`;\n        }\n      }\n      return utf8_to_b64(base);\n    case \"10X\":\n    case \"H5AD\":\n      base += `::${resource.h5.name}::${resource.h5.lastModified}::${resource.h5.size}`;\n      return utf8_to_b64(base);\n    case \"ExperimentHub\":\n      base += `::${resource.id}`;\n      return utf8_to_b64(base);\n    case \"ZippedArtifactdb\":\n      base += `::${resource.zipname}::${resource.zipfile}`;\n      return utf8_to_b64(base);\n    case \"ZippedADB\":\n      base += `::${resource.zipname}::${resource.zipfile}`;\n      return utf8_to_b64(base);\n    default:\n      throw Error(`format: ${resource.format} does not exist`);\n      break;\n  }\n}\n\nexport const MODALITIES = [\"RNA\", \"ADT\", \"CRISPR\"];\n\nexport const getMinMax = (arr) => {\n  var max = -Number.MAX_VALUE,\n    min = Number.MAX_VALUE;\n  arr.forEach(function (x) {\n    if (max < x) {\n      max = x;\n    }\n    if (min > x) {\n      min = x;\n    }\n  });\n  return [min, max];\n};\n\nexport const defaultColor = \"#5F6B7C\";\n\nexport const default_cluster = `${code}::CLUSTERS`;\nexport const default_selection = `${code}::SELECTION`;\n\nexport const getComputedCols = (cols) => {\n  return Object.keys(cols)\n    .filter(\n      (x) =>\n        cols[x].name === default_cluster ||\n        ((cols[x].name.startsWith(code) || cols[x].name === \"__batch__\") &&\n          cols[x].type !== \"continuous\" &&\n          (cols[x][\"type\"] === \"both\" ||\n            (cols[x][\"type\"] === \"categorical\" &&\n              cols[x][\"truncated\"] === false)))\n    )\n    .filter((x) => !cols[x].name.replace(`${code}::`, \"\").startsWith(\"QC\"));\n};\n\nexport const showComputedSection = (cols, custom) => {\n  return getComputedCols(cols).length > 0 || Object.keys(custom).length > 0;\n};\n\nexport const getSuppliedCols = (cols) => {\n  return Object.keys(cols).filter(\n    (x) =>\n      !cols[x].name.startsWith(code) &&\n      cols[x].name !== \"__batch__\" &&\n      cols[x].type !== \"continuous\" &&\n      (cols[x][\"type\"] === \"both\" ||\n        (cols[x][\"type\"] === \"categorical\" && cols[x][\"truncated\"] === false))\n  );\n};\n\nexport const resetApp = () => {\n  window.location.reload();\n};\n","import * as bakana from \"bakana\";\nimport * as scran from \"scran.js\";\nimport * as kana_db from \"./KanaDBHandler.js\";\nimport * as gesel from \"gesel\";\nimport * as hashwasm from \"hash-wasm\";\nimport * as remotes from \"bakana-remotes\";\nimport * as downloads from \"./DownloadsDBHandler.js\";\nimport JSZip from \"jszip\";\n\nimport * as translate from \"./translate.js\";\nimport {\n  extractBuffers,\n  postAttempt,\n  postSuccess,\n  postError,\n  fetchStepSummary,\n  describeColumn,\n  isArrayOrView,\n} from \"./helpers.js\";\nimport { code } from \"../utils/utils.js\";\n/***************************************/\n\nconst default_cluster = `${code}::CLUSTERS`;\nconst default_selection = `${code}::SELECTION`;\n\nlet superstate = null;\nlet preflights = {};\nlet preflights_summary = {};\nlet cache_matrix = null;\nlet cache_anno_markers = {};\n\nfunction createDataset(args) {\n  if (args.format === \"10X\") {\n    return new bakana.TenxHdf5Dataset(\n      args.h5,\n      args.options ? args.options : {}\n    );\n  } else if (args.format === \"MatrixMarket\") {\n    return new bakana.TenxMatrixMarketDataset(\n      args.mtx,\n      args.genes || null,\n      args.annotations || null,\n      args.options ? args.options : {}\n    );\n  } else if (args.format === \"H5AD\") {\n    return new bakana.H5adDataset(args.h5, args.options ? args.options : {});\n  } else if (args.format === \"SummarizedExperiment\") {\n    return new bakana.SummarizedExperimentDataset(\n      args.rds,\n      args.options ? args.options : {}\n    );\n  } else if (args.format === \"ZippedADB\") {\n    return new bakana.ZippedArtifactdbDataset(\n      args.zipname,\n      args.zipfile,\n      args.options ? args.options : {}\n    );\n  } else if (args.format === \"ExperimentHub\") {\n    return new remotes.ExperimentHubDataset(\n      args.id,\n      args.options ? args.options : {}\n    );\n  } else {\n    throw new Error(\"unknown format '\" + args.format + \"'\");\n  }\n}\n\nfunction summarizeDataset(summary, args) {\n  // TODO: figure out a way to deal with nested dataframes later\n  let cells_summary = {};\n  for (const k of summary.cells.columnNames()) {\n    const kcol = summary.cells.column(k);\n    if (isArrayOrView(kcol))\n      cells_summary[k] = describeColumn(kcol, {\n        all: true,\n        unique: true,\n        colname: k,\n      });\n  }\n  let tmp_meta = {\n    cells: {\n      columns: cells_summary,\n      numberOfCells: summary.cells.numberOfRows(),\n    },\n  };\n\n  if (args.format === \"H5AD\") {\n    tmp_meta[\"all_features\"] = {};\n    let tmod_summary = {};\n    for (const k of summary[\"all_features\"].columnNames()) {\n      const kcol = summary[\"all_features\"].column(k);\n      if (isArrayOrView(kcol)) {\n        tmod_summary[k] = describeColumn(kcol, {\n          all: true,\n          unique: true,\n          colname: k,\n        });\n      }\n    }\n    tmp_meta[\"all_features\"] = {\n      columns: tmod_summary,\n      numberOfFeatures: summary[\"all_features\"].numberOfRows(),\n      rownames: Array.isArray(summary[\"all_features\"].rowNames()),\n    };\n  } else if (args.format === \"SummarizedExperiment\") {\n    tmp_meta[\"modality_features\"] = {};\n    if (\"modality_features\" in summary) {\n      for (const [k, v] of Object.entries(summary.modality_features)) {\n        let tmod_summary = {};\n        for (const k of v.columnNames()) {\n          const kcol = v.column(k);\n          if (isArrayOrView(kcol)) {\n            tmod_summary[k] = describeColumn(kcol, {\n              all: true,\n              unique: true,\n              colname: k,\n            });\n          }\n        }\n        tmp_meta[\"modality_features\"][k] = {\n          columns: tmod_summary,\n          numberOfFeatures: v.numberOfRows(),\n          rownames: Array.isArray(v.rowNames()),\n        };\n      }\n    }\n  } else {\n    tmp_meta[\"modality_features\"] = {};\n    if (\"modality_features\" in summary) {\n      for (const [k, v] of Object.entries(summary.modality_features)) {\n        let tmod_summary = {};\n        for (const k of v.columnNames()) {\n          const kcol = v.column(k);\n          if (isArrayOrView(kcol)) {\n            tmod_summary[k] = describeColumn(kcol, {\n              all: true,\n              unique: true,\n              colname: k,\n            });\n          }\n        }\n        tmp_meta[\"modality_features\"][k] = {\n          columns: tmod_summary,\n          numberOfFeatures: v.numberOfRows(),\n          rownames: Array.isArray(v.rowNames()),\n        };\n      }\n    }\n  }\n\n  if (args.format === \"H5AD\") {\n    tmp_meta[\"all_assay_names\"] = summary.all_assay_names;\n  } else if (\n    args.format === \"SummarizedExperiment\" ||\n    args.format === \"ZippedADB\"\n  ) {\n    tmp_meta[\"modality_assay_names\"] = summary.modality_assay_names;\n  }\n  return tmp_meta;\n}\n\nbakana.setVisualizationAnimate((type, x, y, iter) => {\n  postMessage(\n    {\n      type: type + \"_iter\",\n      x: x,\n      y: y,\n      iteration: iter,\n    },\n    [x.buffer, y.buffer]\n  );\n});\n\nfunction linkKanaDb(collected) {\n  return async (type, file) => {\n    let buffer = file.buffer();\n    var md5 = await hashwasm.md5(buffer);\n    var id = type + \"_\" + file.name() + \"_\" + buffer.length + \"_\" + md5;\n    var ok = await kana_db.saveFile(id, buffer);\n    if (!ok) {\n      throw new Error(\"failed to save file '\" + id + \"' to KanaDB\");\n    }\n    collected.push(id);\n    return id;\n  };\n}\n\nbakana.setResolveLink(kana_db.loadFile);\n\nasync function unserializeAllSteps(contents) {\n  const h5path = \"serialized_out.h5\";\n\n  let output;\n  try {\n    let loader = await bakana.parseKanaFile(contents, h5path);\n    let loaded_state = await bakana.loadAnalysis(h5path, loader, {\n      finishFun: postSuccess,\n    });\n\n    if (superstate !== null) {\n      await bakana.freeAnalysis(superstate);\n    }\n    superstate = loaded_state;\n\n    output = {\n      parameters: translate.toUI(bakana.retrieveParameters(superstate)),\n      other: {\n        custom_selections: superstate.custom_selections.fetchSelections(),\n      },\n    };\n  } finally {\n    bakana.callScran((scran) => scran.removeFile(h5path));\n  }\n\n  return output;\n}\n\nasync function postStepSummary(step) {\n  try {\n    let output = await fetchStepSummary(superstate, step);\n\n    postSuccess(step, output);\n  } catch (err) {\n    console.error(err);\n    postError(step, err, true);\n  }\n}\n\nfunction getMarkerStandAloneForAnnot(annotation, annotation_vec) {\n  let mds;\n  if (!(annotation in cache_anno_markers)) {\n    mds = new bakana.MarkerDetectionStandalone(\n      getMatrix(),\n      annotation_vec.ids.slice()\n    );\n\n    mds.computeAll();\n    cache_anno_markers[annotation] = mds;\n  }\n\n  return cache_anno_markers[annotation];\n}\n\nconst getAnnotation = (annotation, unfiltered = false) => {\n  let vec;\n  if (annotation === \"__batch__\") {\n    vec = superstate.inputs.fetchBlock().slice();\n  } else if (annotation.startsWith(`${code}::QC::`)) {\n    let metric = annotation.replace(`${code}::QC::`, \"\");\n    let split_metric = metric.split(\"_\");\n    let metrics =\n      superstate[\n        `${split_metric[0].toLowerCase()}_quality_control`\n      ].fetchMetrics();\n\n    if (split_metric[1] === \"sums\") {\n      vec = metrics.sums();\n    } else if (split_metric[1] === \"detected\") {\n      vec = metrics.detected();\n    } else if (split_metric[1] === \"proportion\") {\n      if (split_metric[0].toLowerCase() === \"rna\") {\n        vec = metrics.subsetProportions(0);\n      } else if (split_metric[0].toLowerCase() === \"adt\") {\n        vec = metrics.subsetTotals(0);\n      } else if (split_metric[0].toLowerCase() === \"crispr\") {\n        vec = metrics.maxProportions(0);\n      }\n    }\n  } else {\n    vec = superstate.inputs.fetchCellAnnotations().column(annotation);\n  }\n\n  if (!unfiltered) {\n    vec = superstate.cell_filtering.applyFilter(vec);\n  }\n\n  return vec.slice();\n};\n\nconst getMatrix = () => {\n  if (cache_matrix === null) {\n    cache_matrix = new scran.MultiMatrix();\n    let mapping = {\n      RNA: \"rna_normalization\",\n      ADT: \"adt_normalization\",\n      CRISPR: \"crispr_normalization\",\n    };\n    for (const [k, v] of Object.entries(mapping)) {\n      let state = superstate[v];\n      if (state.valid()) {\n        cache_matrix.add(k, state.fetchNormalizedMatrix());\n      }\n    }\n  }\n  return cache_matrix;\n};\n\nconst resetMarkerState = () => {\n  for (const [k, v] of Object.entries(cache_anno_markers)) {\n    v.free();\n  }\n\n  cache_anno_markers = {};\n};\n\n/***************************************/\n\nvar loaded;\nonmessage = function (msg) {\n  const { type, payload } = msg.data;\n\n  // console.log(\"WORKER::RCV::\", type, payload);\n\n  let fatal = false;\n  if (type === \"INIT\") {\n    fatal = true;\n    let nthreads = Math.round((navigator.hardwareConcurrency * 2) / 3);\n    let back_init = bakana.initialize({ numberOfThreads: nthreads });\n\n    let state_init = back_init.then(() => {\n      return bakana.createAnalysis();\n    });\n\n    state_init.then((x) => {\n      superstate = x;\n      postMessage({\n        type: type,\n        msg: \"Success: analysis state created\",\n      });\n    });\n\n    let kana_init = kana_db.initialize();\n    kana_init\n      .then((output) => {\n        if (output !== null) {\n          postMessage({\n            type: \"KanaDB_store\",\n            resp: output,\n            msg: \"Success: KanaDB initialized\",\n          });\n        }\n      })\n      .catch((error) => {\n        console.error(error);\n        postMessage({\n          type: \"KanaDB_ERROR\",\n          msg: \"Error: Cannot initialize KanaDB\",\n        });\n      });\n\n    let down_init = downloads.initialize();\n    down_init\n      .then((output) => {\n        postMessage({\n          type: \"DownloadsDB_store\",\n          resp: output,\n          msg: \"Success: DownloadsDB initialized\",\n        });\n      })\n      .catch((error) => {\n        console.error(error);\n        postMessage({\n          type: \"DownloadsDB_ERROR\",\n          msg: \"Error: Cannot initialize DownloadsDB\",\n        });\n      });\n\n    try {\n      let ehub_ids = remotes.ExperimentHubDataset.availableDatasets();\n      postMessage({\n        type: \"ExperimentHub_store\",\n        resp: ehub_ids,\n        msg: \"Success: ExperimentHub initialized\",\n      });\n    } catch (err) {\n      console.error(err);\n      postMessage({\n        type: \"ExperimentHub_ERROR\",\n        msg: \"Error: Cannot access datasets in ExperimentHub\",\n      });\n    }\n\n    loaded = Promise.all([back_init, kana_init, down_init, state_init]);\n\n    loaded\n      .then(() => {\n        postMessage({\n          type: type,\n          msg: \"Success: bakana initialized\",\n        });\n      })\n      .catch((err) => {\n        console.error(err);\n        postError(type, err, fatal);\n      });\n\n    /**************** RUNNING AN ANALYSIS *******************/\n  } else if (type === \"RUN\") {\n    fatal = true;\n    loaded\n      .then((x) => {\n        let inputs = payload.inputs;\n        let files = inputs.files;\n\n        if (files !== null) {\n          // Extracting existing datasets from the preflights.\n          let current = {};\n          for (const [k, v] of Object.entries(files)) {\n            if (\"uid\" in v && v.uid in preflights) {\n              current[k] = preflights[v.uid];\n            } else {\n              current[k] = createDataset(v);\n            }\n            current[k].setOptions(v.options);\n          }\n\n          // Cleaning out the preflight datasets that weren't used.\n          for (const [k, v] of Object.entries(preflights)) {\n            v.clear();\n            delete preflights[k];\n          }\n\n          files = current;\n        }\n\n        resetMarkerState();\n\n        let formatted = translate.fromUI(inputs, payload.params);\n        bakana\n          .runAnalysis(superstate, files, formatted, {\n            startFun: postAttempt,\n            finishFun: postStepSummary,\n          })\n          .catch((err) => {\n            console.error(err);\n            postError(type, err, fatal);\n          });\n      })\n      .catch((err) => {\n        console.error(err);\n        postError(type, err, fatal);\n      });\n    /**************** LOADING EXISTING ANALYSES *******************/\n  } else if (type === \"LOAD\") {\n    fatal = true;\n    let fs = payload.inputs.files;\n\n    if (fs[Object.keys(fs)[0]].format === \"kana\") {\n      let f = fs[Object.keys(fs)[0]].file;\n      loaded\n        .then(async (x) => {\n          const reader = new FileReaderSync(); // eslint-disable-line\n          const zipbuffer = reader.readAsArrayBuffer(f);\n          const unzipped = await JSZip.loadAsync(zipbuffer);\n          let config = JSON.parse(\n            await unzipped.file(\"config.json\").async(\"string\")\n          );\n\n          let buffers = {};\n          for (const x in unzipped.files) {\n            if (x.startsWith(\"datasets/\")) {\n              let current = await unzipped.files[x].async(\"uint8array\");\n              buffers[x.split(\"/\")[1]] = current;\n            }\n          }\n\n          // This re-runs the entire analysis, so throw startFun/finishFun callbacks here.\n          superstate = await bakana.unserializeConfiguration(\n            config,\n            (id) => buffers[id],\n            {\n              state: superstate,\n              startFun: postAttempt,\n              finishFun: postStepSummary,\n            }\n          );\n\n          const other = {\n            custom_selections: superstate.custom_selections.fetchSelections(),\n          };\n\n          var transferrable = [];\n          extractBuffers(config.parameters, transferrable);\n          postMessage(\n            {\n              type: \"loadedParameters\",\n              resp: {\n                parameters: config.parameters,\n                other: other,\n              },\n            },\n            transferrable\n          );\n\n          let features = {};\n          let resp = {};\n          const loaded_ds = superstate.inputs.fetchDatasets();\n          for (const [k, v] of Object.entries(loaded_ds)) {\n            let res = await v.previewPrimaryIds({ cache: true });\n\n            for (const i_mod of [\"RNA\", \"ADT\", \"CRISPR\"]) {\n              if (i_mod in res) {\n                if (!features[i_mod]) {\n                  features[i_mod] = [res[i_mod]];\n                } else {\n                  features[i_mod].push(res[i_mod]);\n                }\n              }\n            }\n          }\n\n          for (const [k, v] of Object.entries(features)) {\n            resp[k] = gesel.intersect(v).length;\n          }\n\n          postMessage({\n            type: \"PREFLIGHT_OPTIONS_DATA\",\n            resp: resp,\n            msg: \"Success: PREFLIGHT_OPTIONS done\",\n          });\n        })\n        .catch((err) => {\n          console.error(err);\n          postError(type, err, fatal);\n        });\n    } else if (fs[Object.keys(fs)[0]].format === \"kanadb\") {\n      loaded\n        .then(async (x) => {\n          var id = fs[Object.keys(fs)[0]].file;\n\n          const jsonbuffer = await kana_db.loadAnalysis(id);\n          const dec = new TextDecoder();\n          let config = JSON.parse(dec.decode(jsonbuffer));\n\n          superstate = await bakana.unserializeConfiguration(\n            config,\n            kana_db.loadFile,\n            {\n              state: superstate,\n              startFun: postAttempt,\n              finishFun: postStepSummary,\n            }\n          );\n        })\n        .catch((err) => {\n          console.error(err);\n          postError(type, err, fatal);\n        });\n    }\n    /**************** SAVING EXISTING ANALYSES *******************/\n  } else if (type === \"EXPORT\") {\n    loaded\n      .then(async (x) => {\n        let buffers = [];\n        let saver = (name, format, file) => {\n          let id = String(buffers.length);\n          buffers.push(file.buffer());\n          return id;\n        };\n\n        // Returns a configuration object.\n        let collected = await bakana.serializeConfiguration(superstate, saver);\n\n        // Let's zip it all up!\n        const zipper = new JSZip();\n        zipper.file(\"config.json\", JSON.stringify(collected));\n        for (var i = 0; i < buffers.length; i++) {\n          zipper.file(\"datasets/\" + String(i), buffers[i]);\n        }\n        let zipbuffer = await zipper.generateAsync({ type: \"uint8array\" });\n        postMessage(\n          {\n            type: \"exportState\",\n            resp: zipbuffer,\n            msg: \"Success: application state exported\",\n          },\n          [zipbuffer.buffer]\n        );\n      })\n      .catch((err) => {\n        console.error(err);\n        postError(type, err, fatal);\n      });\n  } else if (type === \"EXPORT_RDS\") {\n    loaded\n      .then(async (x) => {\n        let files = await bakana.saveSingleCellExperiment(superstate, \"sce\", {\n          forceBuffer: true,\n        });\n\n        let gene_files = await bakana.saveGenewiseResults(superstate, \"\", {\n          forceBuffer: true,\n        });\n\n        for (const f of gene_files) {\n          files.push(f);\n        }\n        let zipbuffer = await bakana.zipFiles(files);\n\n        postMessage(\n          {\n            type: \"exportRDSState\",\n            resp: zipbuffer,\n            msg: \"Success: application state exported\",\n          },\n          [zipbuffer.buffer]\n        );\n      })\n      .catch((err) => {\n        console.error(err);\n        postError(type, err, fatal);\n      });\n  } else if (type === \"SAVEKDB\") {\n    // save analysis to inbrowser indexedDB\n    var title = payload.title;\n    loaded\n      .then(async (x) => {\n        let buffers = [];\n        let saver = async (name, format, file) => {\n          // basically linkKanaDb with an extra arg.\n          let buffer = file.buffer();\n          var md5 = await hashwasm.md5(buffer);\n          var id = type + \"_\" + file.name() + \"_\" + buffer.length + \"_\" + md5;\n          var ok = await kana_db.saveFile(id, buffer);\n          if (!ok) {\n            throw new Error(\"failed to save file '\" + id + \"' to KanaDB\");\n          }\n          buffers.push(id);\n          return id;\n        };\n\n        let collected = await bakana.serializeConfiguration(superstate, saver);\n        const enc = new TextEncoder();\n        let config = enc.encode(JSON.stringify(collected));\n        let id = await kana_db.saveAnalysis(null, config, collected, title);\n\n        if (id !== null) {\n          let recs = await kana_db.getRecords();\n          postMessage({\n            type: \"KanaDB_store\",\n            resp: recs,\n            msg: `Success: Saved analysis to browser (${id})`,\n          });\n        } else {\n          postMessage({\n            type: \"KanaDB_ERROR\",\n            msg: `Fail: Cannot save analysis to browser`,\n          });\n        }\n      })\n      .catch((err) => {\n        console.error(err);\n        postError(type, err, fatal);\n      });\n\n    /**************** KANADB EVENTS *******************/\n  } else if (type === \"REMOVEKDB\") {\n    // remove a saved analysis\n    var id = payload.id;\n    kana_db\n      .removeAnalysis(id)\n      .then(async (output) => {\n        if (output) {\n          let recs = await kana_db.getRecords();\n          postMessage({\n            type: \"KanaDB_store\",\n            resp: recs,\n            msg: `Success: Removed file from cache (${id})`,\n          });\n        } else {\n          postMessage({\n            type: \"KanaDB_ERROR\",\n            msg: `fail: cannot remove file from cache (${id})`,\n          });\n        }\n      })\n      .catch((err) => {\n        console.error(err);\n        postError(type, err, fatal);\n      });\n  } else if (type === \"PREFLIGHT_OPTIONS\") {\n    loaded.then(async (x) => {\n      let resp = {};\n      try {\n        let counter = 0;\n        let features = {};\n\n        for (const [k, v] of Object.entries(payload.inputs.files)) {\n          if (\"uid\" in v) {\n            let ds = preflights[v.uid];\n\n            if (\n              Array.isArray(payload.options) &&\n              payload.options.length > counter\n            ) {\n              ds.setOptions(payload.options[counter]);\n\n              let res = await ds.previewPrimaryIds({ cache: true });\n\n              for (const i_mod of [\"RNA\", \"ADT\", \"CRISPR\"]) {\n                if (i_mod in res) {\n                  if (!features[i_mod]) {\n                    features[i_mod] = [res[i_mod]];\n                  } else {\n                    features[i_mod].push(res[i_mod]);\n                  }\n                }\n              }\n            }\n          }\n          counter++;\n        }\n\n        for (const [k, v] of Object.entries(features)) {\n          if (v.length !== payload.options.length) {\n            resp[k] = 0;\n          } else {\n            resp[k] = gesel.intersect(v).length;\n          }\n        }\n      } catch (e) {\n        console.error(e);\n        resp.status = \"ERROR\";\n        resp.reason = e.toString();\n      }\n\n      postMessage({\n        type: \"PREFLIGHT_OPTIONS_DATA\",\n        resp: resp,\n        msg: \"Success: PREFLIGHT_OPTIONS done\",\n      });\n    });\n  } else if (type === \"PREFLIGHT_INPUT\") {\n    loaded\n      .then(async (x) => {\n        let resp = {};\n        try {\n          // Registering the UIDs of each new dataset.\n          let current = {};\n          let summary = {};\n          for (const [k, v] of Object.entries(payload.inputs.files)) {\n            if (\"uid\" in v) {\n              if (!(v.uid in preflights)) {\n                preflights[v.uid] = createDataset(v);\n                preflights_summary[v.uid] = await preflights[v.uid].summary({\n                  cache: true,\n                });\n              }\n              current[k] = preflights[v.uid];\n              summary[k] = summarizeDataset(preflights_summary[v.uid], v);\n            } else {\n              let tmp_dataset = createDataset(v);\n              current[k] = tmp_dataset;\n              summary[k] = summarizeDataset(\n                await current[k].summary({ cache: true }),\n                v\n              );\n            }\n          }\n\n          resp.status = \"SUCCESS\";\n          resp.details = summary;\n          // resp.details = await bakana.validateAnnotations(current, { cache: true });\n          // i guess iterate through each dataset and call summary\n        } catch (e) {\n          console.error(e);\n          resp.status = \"ERROR\";\n          resp.reason = e.toString();\n        }\n\n        postMessage({\n          type: \"PREFLIGHT_INPUT_DATA\",\n          resp: resp,\n          msg: \"Success: PREFLIGHT_INPUT done\",\n        });\n      })\n      .catch((err) => {\n        console.error(err);\n        postError(type, err, fatal);\n      });\n\n    /**************** VERSUS MODE *******************/\n  } else if (type === \"computeVersusClusters\") {\n    loaded\n      .then((x) => {\n        let rank_type = payload.rank_type;\n        let modality = payload.modality;\n        let annotation = payload.annotation;\n\n        let resp, raw_res;\n        if (default_cluster === annotation) {\n          raw_res = superstate.marker_detection.computeVersus(\n            payload.left,\n            payload.right\n          );\n\n          resp = bakana.formatMarkerResults(\n            raw_res.results[modality],\n            raw_res.left,\n            rank_type\n          );\n        } else {\n          let annotation_vec = scran.factorize(getAnnotation(annotation));\n\n          let mds = getMarkerStandAloneForAnnot(annotation, annotation_vec);\n          raw_res = mds.computeVersus(\n            annotation_vec.levels.indexOf(payload.left),\n            annotation_vec.levels.indexOf(payload.right)\n          );\n          resp = bakana.formatMarkerResults(\n            raw_res.results[modality],\n            raw_res.left,\n            rank_type\n          );\n        }\n\n        var transferrable = [];\n        extractBuffers(resp, transferrable);\n        postMessage(\n          {\n            type: \"computeVersusClusters\",\n            resp: resp,\n            msg: \"Success: COMPUTE_VERSUS_CLUSTERS done\",\n          },\n          transferrable\n        );\n      })\n      .catch((err) => {\n        console.error(err);\n        postError(type, err, fatal);\n      });\n  } else if (type === \"computeVersusSelections\") {\n    loaded\n      .then((x) => {\n        let rank_type = payload.rank_type;\n        let res = superstate.custom_selections.computeVersus(\n          payload.left,\n          payload.right\n        );\n        let resp = bakana.formatMarkerResults(\n          res[\"results\"][payload.modality],\n          res.left,\n          rank_type\n        );\n\n        var transferrable = [];\n        extractBuffers(resp, transferrable);\n        postMessage(\n          {\n            type: \"computeVersusSelections\",\n            resp: resp,\n            msg: \"Success: COMPUTE_VERSUS_SELECTIONS done\",\n          },\n          transferrable\n        );\n      })\n      .catch((err) => {\n        console.error(err);\n        postError(type, err, fatal);\n      });\n\n    /**************** OTHER EVENTS FROM UI *******************/\n  } else if (type === \"getMarkersForCluster\") {\n    loaded\n      .then((x) => {\n        let cluster = payload.cluster;\n        let rank_type = payload.rank_type;\n        let modality = payload.modality;\n        let annotation = payload.annotation;\n        let resp;\n        let raw_res;\n        if (default_cluster === annotation) {\n          raw_res = superstate.marker_detection.fetchResults()[modality];\n          resp = bakana.formatMarkerResults(raw_res, cluster, rank_type);\n        } else {\n          let annotation_vec = scran.factorize(getAnnotation(annotation));\n          let mds = getMarkerStandAloneForAnnot(annotation, annotation_vec);\n\n          raw_res = mds.fetchResults()[modality];\n          // cache_anno_markers[annotation][modality];\n\n          resp = bakana.formatMarkerResults(\n            raw_res,\n            annotation_vec.levels.indexOf(cluster),\n            rank_type\n          );\n        }\n\n        var transferrable = [];\n        extractBuffers(resp, transferrable);\n        postMessage(\n          {\n            type: \"setMarkersForCluster\",\n            resp: resp,\n            msg: \"Success: GET_MARKERS_FOR_CLUSTER done\",\n          },\n          transferrable\n        );\n      })\n      .catch((err) => {\n        console.error(err);\n        postError(type, err, fatal);\n      });\n  } else if (type === \"getGeneExpression\") {\n    loaded\n      .then((x) => {\n        let row_idx = payload.gene;\n        let modality = payload.modality;\n\n        const matrix = getMatrix(modality);\n        let vec;\n        if (modality === \"RNA\") {\n          vec = matrix.get(modality).row(row_idx);\n        } else if (modality === \"ADT\") {\n          vec = matrix.get(modality).row(row_idx);\n        } else if (modality === \"CRISPR\") {\n          vec = matrix.get(modality).row(row_idx);\n        } else {\n          throw new Error(\"unknown feature type '\" + modality + \"'\");\n        }\n\n        postMessage(\n          {\n            type: \"setGeneExpression\",\n            resp: {\n              gene: row_idx,\n              expr: vec,\n            },\n            msg: \"Success: GET_GENE_EXPRESSION done\",\n          },\n          [vec.buffer]\n        );\n      })\n      .catch((err) => {\n        console.error(err);\n        postError(type, err, fatal);\n      });\n  } else if (type === \"computeCustomMarkers\") {\n    loaded\n      .then((x) => {\n        superstate.custom_selections.addSelection(\n          payload.id,\n          payload.selection\n        );\n        postMessage({\n          type: \"computeCustomMarkers\",\n          msg: \"Success: COMPUTE_CUSTOM_MARKERS done\",\n        });\n      })\n      .catch((err) => {\n        console.error(err);\n        postError(type, err, fatal);\n      });\n  } else if (type === \"getMarkersForSelection\") {\n    loaded\n      .then((x) => {\n        let raw_res = superstate.custom_selections.fetchResults(\n          payload.cluster\n        )[payload.modality];\n        let resp = bakana.formatMarkerResults(raw_res, 1, payload.rank_type);\n\n        var transferrable = [];\n        extractBuffers(resp, transferrable);\n        postMessage(\n          {\n            type: \"setMarkersForCustomSelection\",\n            resp: resp,\n            msg: \"Success: GET_MARKERS_FOR_SELECTION done\",\n          },\n          transferrable\n        );\n      })\n      .catch((err) => {\n        console.error(err);\n        postError(type, err, fatal);\n      });\n  } else if (type === \"removeCustomMarkers\") {\n    loaded\n      .then((x) => {\n        superstate.custom_selections.removeSelection(payload.id);\n      })\n      .catch((err) => {\n        console.error(err);\n        postError(type, err, fatal);\n      });\n  } else if (type === \"animateTSNE\") {\n    loaded\n      .then(async (x) => {\n        await superstate.tsne.animate();\n        postSuccess(\"tsne\", await superstate.tsne.fetchResults());\n      })\n      .catch((err) => {\n        console.error(err);\n        postError(type, err, fatal);\n      });\n  } else if (type === \"animateUMAP\") {\n    loaded\n      .then(async (x) => {\n        await superstate.umap.animate();\n        postSuccess(\"umap\", await superstate.umap.fetchResults());\n      })\n      .catch((err) => {\n        console.error(err);\n        postError(type, err, fatal);\n      });\n  } else if (type === \"getAnnotation\") {\n    loaded\n      .then((x) => {\n        let annot = payload.annotation;\n        let vec, output;\n\n        vec = getAnnotation(annot, !!payload.unfiltered);\n\n        if (ArrayBuffer.isView(vec)) {\n          output = {\n            type: \"array\",\n            values: vec.slice(),\n          };\n        } else {\n          let uniq_vals = [];\n          let uniq_map = {};\n          let indices = new Int32Array(vec.length);\n          vec.map((x, i) => {\n            if (!(x in uniq_map)) {\n              uniq_map[x] = uniq_vals.length;\n              uniq_vals.push(x);\n            }\n            indices[i] = uniq_map[x];\n          });\n\n          output = {\n            type: \"factor\",\n            index: indices,\n            levels: uniq_vals,\n          };\n        }\n\n        let extracted = [];\n        extractBuffers(output, extracted);\n        postMessage(\n          {\n            type: \"setAnnotation\",\n            resp: {\n              annotation: annot,\n              values: output,\n            },\n            msg: \"Success: GET_ANNOTATION done\",\n          },\n          extracted\n        );\n      })\n      .catch((err) => {\n        console.error(err);\n        postError(type, err, fatal);\n      });\n  } else if (type === \"computeFeaturesetSummary\") {\n    loaded\n      .then(async (x) => {\n        let { annotation, rank_type, cluster } = payload;\n        let index = rank_type.indexOf(\"-\");\n        let resp;\n        if (default_cluster === annotation) {\n          resp = superstate.feature_set_enrichment.computeEnrichment(\n            superstate.marker_detection.fetchResults()[\"RNA\"],\n            cluster,\n            rank_type.slice(0, index),\n            rank_type.slice(index + 1)\n          );\n          postSuccess(\"computeFeaturesetSummary\", resp);\n        } else if (default_selection === annotation) {\n          let sel_indices =\n            superstate.custom_selections.fetchSelectionIndices(cluster);\n          let num_cells = superstate.cell_filtering\n            .fetchFilteredMatrix()\n            .numberOfColumns();\n\n          let arr_sel_indices = new Uint8Array(num_cells);\n          sel_indices.map((x) => arr_sel_indices.set([1], x));\n          let annotation_vec = scran.factorize(arr_sel_indices);\n\n          let mds = getMarkerStandAloneForAnnot(annotation, annotation_vec);\n          let anno_markers = mds.fetchResults()[\"RNA\"];\n\n          resp = superstate.feature_set_enrichment.computeEnrichment(\n            anno_markers,\n            annotation_vec.levels.indexOf(1),\n            rank_type.slice(0, index),\n            rank_type.slice(index + 1)\n          );\n          postSuccess(\"computeFeaturesetSummary\", resp);\n        } else {\n          let annotation_vec = scran.factorize(getAnnotation(annotation));\n\n          let mds = getMarkerStandAloneForAnnot(annotation, annotation_vec);\n          let anno_markers = mds.fetchResults()[\"RNA\"];\n\n          resp = superstate.feature_set_enrichment.computeEnrichment(\n            anno_markers,\n            annotation_vec.levels.indexOf(cluster),\n            rank_type.slice(0, index),\n            rank_type.slice(index + 1)\n          );\n          postSuccess(\"computeFeaturesetSummary\", resp);\n        }\n      })\n      .catch((err) => {\n        console.error(err);\n        postError(type, err, fatal);\n      });\n  } else if (type === \"computeFeaturesetVSSummary\") {\n    loaded\n      .then(async (x) => {\n        let { annotation, rank_type, left, right } = payload;\n        let index = rank_type.indexOf(\"-\");\n        let resp;\n        if (default_cluster === annotation) {\n          let raw_res = superstate.marker_detection.computeVersus(left, right);\n          resp = superstate.feature_set_enrichment.computeEnrichment(\n            raw_res.results[\"RNA\"],\n            raw_res.left,\n            rank_type.slice(0, index),\n            rank_type.slice(index + 1)\n          );\n          postSuccess(\"computeFeaturesetVSSummary\", resp);\n        } else if (default_selection === annotation) {\n          let anno_markers = superstate.custom_selections.computeVersus(\n            left,\n            right\n          );\n          resp = superstate.feature_set_enrichment.computeEnrichment(\n            anno_markers.results[\"RNA\"],\n            0,\n            rank_type.slice(0, index),\n            rank_type.slice(index + 1)\n          );\n          postSuccess(\"computeFeaturesetVSSummary\", resp);\n        } else {\n          let annotation_vec = scran.factorize(getAnnotation(annotation));\n\n          let mds = getMarkerStandAloneForAnnot(annotation, annotation_vec);\n\n          let raw_res = mds.computeVersus(\n            annotation_vec.levels.indexOf(payload.left),\n            annotation_vec.levels.indexOf(payload.right)\n          );\n\n          resp = superstate.feature_set_enrichment.computeEnrichment(\n            raw_res.results[\"RNA\"],\n            raw_res.left,\n            rank_type.slice(0, index),\n            rank_type.slice(index + 1)\n          );\n          postSuccess(\"computeFeaturesetVSSummary\", resp);\n        }\n      })\n      .catch((err) => {\n        console.error(err);\n        postError(type, err, fatal);\n      });\n  } else if (type === \"getFeatureScores\") {\n    loaded\n      .then((x) => {\n        let { index } = payload;\n\n        let resp =\n          superstate.feature_set_enrichment.computePerCellScores(index);\n        postSuccess(\"setFeatureScores\", resp);\n      })\n      .catch((err) => {\n        console.error(err);\n        postError(type, err, fatal);\n      });\n  } else if (type === \"getFeatureGeneIndices\") {\n    loaded\n      .then((x) => {\n        let { index, cluster, annotation, modality, rank_type } = payload;\n\n        let resp =\n          superstate.feature_set_enrichment.fetchFeatureSetIndices(index);\n\n        let raw_res, marker_resp;\n\n        if (default_cluster === annotation) {\n          raw_res = superstate.marker_detection.fetchResults()[modality];\n          marker_resp = bakana.formatMarkerResults(raw_res, cluster, rank_type);\n        } else if (default_selection === annotation) {\n          raw_res = superstate.custom_selections.fetchResults(payload.cluster)[\n            payload.modality\n          ];\n          marker_resp = bakana.formatMarkerResults(\n            raw_res,\n            1,\n            payload.rank_type\n          );\n        } else {\n          let annotation_vec = scran.factorize(getAnnotation(annotation));\n          let mds = getMarkerStandAloneForAnnot(annotation, annotation_vec);\n\n          raw_res = mds.fetchResults()[modality];\n          // cache_anno_markers[annotation][modality];\n\n          marker_resp = bakana.formatMarkerResults(\n            raw_res,\n            annotation_vec.levels.indexOf(cluster),\n            rank_type\n          );\n        }\n\n        let indices = marker_resp.ordering\n          .map((x, i) => (resp.includes(x) ? i : -100))\n          .filter((x) => x !== -100);\n\n        let filtered_marker_resp = {};\n        for (const [k, v] of Object.entries(marker_resp)) {\n          filtered_marker_resp[k] = v\n            .map((x, i) => (indices.includes(i) ? x : -100))\n            .filter((x) => x !== -100);\n        }\n\n        postSuccess(\"setFeatureGeneIndices\", filtered_marker_resp);\n      })\n      .catch((err) => {\n        console.error(err);\n        postError(type, err, fatal);\n      });\n  } else {\n    console.error(`Type: ${type} not defined`);\n    postError(type, `Type: ${type} not defined`, fatal);\n  }\n};\n","/*****************************************************\n * This file is intended to be vendored into kanapi,\n * so you shouldn't add too many dependencies here.\n * The canonical version of the file is expected to\n * live at src/workers/translate.js in the kana repo.\n *****************************************************/\n\nimport * as bakana from \"bakana\";\n\nconst mappings = {\n  quality_control: {\n    use_mito_default: [\"qc\", \"qc-usemitodefault\"],\n    mito_prefix: [\"qc\", \"qc-mito\"],\n    nmads: [\"qc\", \"qc-nmads\"],\n    skip: [\"qc\", \"skip\"],\n  },\n  adt_quality_control: {\n    nmads: [\"adt_qualitycontrol\", \"nmads\"],\n    min_detected_drop: [\"adt_qualitycontrol\", \"min_detected_drop\"],\n    igg_prefix: [\"adt_qualitycontrol\", \"igg_prefix\"],\n    skip: [\"adt_qualitycontrol\", \"skip\"],\n  },\n  adt_normalization: {\n    num_pcs: [\"adt_normalization\", \"num_pcs\"],\n    num_clusters: [\"adt_normalization\", \"num_clusters\"],\n  },\n  feature_selection: {\n    span: [\"fSelection\", \"fsel-span\"],\n  },\n  pca: {\n    num_hvgs: [\"pca\", \"pca-hvg\"],\n    num_pcs: [\"pca\", \"pca-npc\"],\n  },\n  adt_pca: {\n    num_pcs: [\"adt_pca\", \"num_pcs\"],\n  },\n  combine_embeddings: {\n    weights: [\"combine_embeddings\", \"weights\"],\n  },\n  batch_correction: {\n    // method is handled by configureBatchCorrection.\n    num_neighbors: [\"batch_correction\", \"num_neighbors\"],\n  },\n  choose_clustering: {\n    method: [\"cluster\", \"clus-method\"],\n  },\n  // Neighbor indexing is handled by configureApproximateNeighbors.\n  tsne: {\n    perplexity: [\"tsne\", \"tsne-perp\"],\n    iterations: [\"tsne\", \"tsne-iter\"],\n    animate: [\"tsne\", \"animate\"],\n  },\n  umap: {\n    num_neighbors: [\"umap\", \"umap-nn\"],\n    num_epochs: [\"umap\", \"umap-epochs\"],\n    min_dist: [\"umap\", \"umap-min_dist\"],\n    animate: [\"umap\", \"animate\"],\n  },\n  kmeans_cluster: {\n    k: [\"cluster\", \"kmeans-k\"],\n  },\n  snn_graph_cluster: {\n    k: [\"cluster\", \"clus-k\"],\n    scheme: [\"cluster\", \"clus-scheme\"],\n    resolution: [\"cluster\", \"clus-res\"],\n  },\n  cell_labelling: {\n    human_references: [\"annotateCells\", \"annotateCells-human_references\"],\n    mouse_references: [\"annotateCells\", \"annotateCells-mouse_references\"],\n  },\n};\n\nexport function fromUI(inputs, params) {\n  let formatted = params;\n\n  // Replacing all 1:1 mappings.\n  let safeReplace = (step, par, value) => {\n    if (typeof value == \"undefined\") {\n      throw new Error(\n        \"cannot assign undefined parameter to '\" + step + \".\" + par + \"'\"\n      );\n    }\n    if (!(step in formatted)) {\n      throw new Error(\"unknown analysis step '\" + step + \"'\");\n    }\n    let target = formatted[step];\n    if (!(par in target)) {\n      throw new Error(\n        \"unknown analysis parameter '\" + par + \"' for step '\" + step + \"'\"\n      );\n    }\n    target[par] = value;\n  };\n\n  safeReplace(\"inputs\", \"block_factor\", inputs.batch);\n  safeReplace(\"inputs\", \"subset\", inputs.subset);\n\n  // Special handling for multi-step parameters.\n  bakana.configureBatchCorrection(formatted, params.batch_correction[\"method\"]);\n  bakana.configureApproximateNeighbors(\n    formatted,\n    params.neighbor_index[\"approximate\"]\n  );\n\n  // Simplify the combine_embeddings if we see it is all equal.\n  if (formatted.combine_embeddings.weights !== null) {\n    let uniq_weights = new Set([\n      formatted.combine_embeddings.rna_weight,\n      formatted.combine_embeddings.adt_weight,\n      formatted.combine_embeddings.crispr_weight,\n    ]);\n    if (uniq_weights.size <= 1) {\n      formatted.combine_embeddings.weights = null;\n    }\n  }\n\n  return formatted;\n}\n\nexport function toUI(params) {\n  // Setting all 1:1 mappings.\n  let safeExtract = (step, par) => {\n    if (!(step in params)) {\n      throw new Error(\n        \"no available step '\" + step + \"' in the supplied parameters\"\n      );\n    }\n\n    let curstep = params[step];\n    if (!(par in curstep)) {\n      throw new Error(\n        \"no available parameter '\" + par + \"' in step '\" + step + \"'\"\n      );\n    }\n\n    return curstep[par];\n  };\n\n  let reversed = {\n    inputs: {\n      batch: safeExtract(\"inputs\", \"sample_factor\"),\n      subset: safeExtract(\"inputs\", \"subset\"),\n    },\n  };\n\n  for (const [step, spars] of Object.entries(mappings)) {\n    for (const [par, target] of Object.entries(spars)) {\n      if (!(target[0] in reversed)) {\n        reversed[target[0]] = {};\n      }\n\n      let currev = reversed[target[0]];\n      if (target[1] in currev) {\n        throw new Error(\n          \"duplicate entry for parameter '\" + target[0] + \".\" + target[1] + \"'\"\n        );\n      }\n      currev[target[1]] = safeExtract(step, par);\n    }\n  }\n\n  // Mopping up the rest.\n  reversed.batch_correction.method = bakana.guessBatchCorrectionConfig(params);\n  reversed.ann = {\n    approximate: bakana.guessApproximateNeighborsConfig(params),\n  };\n\n  // Converting it into a dictionary for easier consumption by the UI.\n  if (reversed.combine_embeddings.weights === null) {\n    reversed.combine_embeddings.weights = {};\n  }\n\n  return reversed;\n}\n","// The module cache\nvar __webpack_module_cache__ = {};\n\n// The require function\nfunction __webpack_require__(moduleId) {\n\t// Check if module is in cache\n\tvar cachedModule = __webpack_module_cache__[moduleId];\n\tif (cachedModule !== undefined) {\n\t\treturn cachedModule.exports;\n\t}\n\t// Create a new module (and put it into the cache)\n\tvar module = __webpack_module_cache__[moduleId] = {\n\t\tid: moduleId,\n\t\tloaded: false,\n\t\texports: {}\n\t};\n\n\t// Execute the module function\n\t__webpack_modules__[moduleId].call(module.exports, module, module.exports, __webpack_require__);\n\n\t// Flag the module as loaded\n\tmodule.loaded = true;\n\n\t// Return the exports of the module\n\treturn module.exports;\n}\n\n// expose the modules object (__webpack_modules__)\n__webpack_require__.m = __webpack_modules__;\n\n// the startup function\n__webpack_require__.x = function() {\n\t// Load entry module and return exports\n\t// This entry module depends on other loaded chunks and execution need to be delayed\n\tvar __webpack_exports__ = __webpack_require__.O(undefined, [660,830,797], function() { return __webpack_require__(9612); })\n\t__webpack_exports__ = __webpack_require__.O(__webpack_exports__);\n\treturn __webpack_exports__;\n};\n\n","var deferred = [];\n__webpack_require__.O = function(result, chunkIds, fn, priority) {\n\tif(chunkIds) {\n\t\tpriority = priority || 0;\n\t\tfor(var i = deferred.length; i > 0 && deferred[i - 1][2] > priority; i--) deferred[i] = deferred[i - 1];\n\t\tdeferred[i] = [chunkIds, fn, priority];\n\t\treturn;\n\t}\n\tvar notFulfilled = Infinity;\n\tfor (var i = 0; i < deferred.length; i++) {\n\t\tvar chunkIds = deferred[i][0];\n\t\tvar fn = deferred[i][1];\n\t\tvar priority = deferred[i][2];\n\t\tvar fulfilled = true;\n\t\tfor (var j = 0; j < chunkIds.length; j++) {\n\t\t\tif ((priority & 1 === 0 || notFulfilled >= priority) && Object.keys(__webpack_require__.O).every(function(key) { return __webpack_require__.O[key](chunkIds[j]); })) {\n\t\t\t\tchunkIds.splice(j--, 1);\n\t\t\t} else {\n\t\t\t\tfulfilled = false;\n\t\t\t\tif(priority < notFulfilled) notFulfilled = priority;\n\t\t\t}\n\t\t}\n\t\tif(fulfilled) {\n\t\t\tdeferred.splice(i--, 1)\n\t\t\tvar r = fn();\n\t\t\tif (r !== undefined) result = r;\n\t\t}\n\t}\n\treturn result;\n};","// getDefaultExport function for compatibility with non-harmony modules\n__webpack_require__.n = function(module) {\n\tvar getter = module && module.__esModule ?\n\t\tfunction() { return module['default']; } :\n\t\tfunction() { return module; };\n\t__webpack_require__.d(getter, { a: getter });\n\treturn getter;\n};","// define getter functions for harmony exports\n__webpack_require__.d = function(exports, definition) {\n\tfor(var key in definition) {\n\t\tif(__webpack_require__.o(definition, key) && !__webpack_require__.o(exports, key)) {\n\t\t\tObject.defineProperty(exports, key, { enumerable: true, get: definition[key] });\n\t\t}\n\t}\n};","__webpack_require__.f = {};\n// This file contains only the entry chunk.\n// The chunk loading function for additional chunks\n__webpack_require__.e = function(chunkId) {\n\treturn Promise.all(Object.keys(__webpack_require__.f).reduce(function(promises, key) {\n\t\t__webpack_require__.f[key](chunkId, promises);\n\t\treturn promises;\n\t}, []));\n};","// This function allow to reference async chunks and sibling chunks for the entrypoint\n__webpack_require__.u = function(chunkId) {\n\t// return url for filenames based on template\n\treturn \"static/js/\" + chunkId + \".\" + {\"484\":\"0f697b69\",\"660\":\"35c3e400\",\"797\":\"f34b60e0\",\"830\":\"1c075690\",\"909\":\"19a9898f\",\"933\":\"6cd42160\"}[chunkId] + \".chunk.js\";\n};","// This function allow to reference async chunks and sibling chunks for the entrypoint\n__webpack_require__.miniCssF = function(chunkId) {\n\t// return url for filenames based on template\n\treturn undefined;\n};","__webpack_require__.g = (function() {\n\tif (typeof globalThis === 'object') return globalThis;\n\ttry {\n\t\treturn this || new Function('return this')();\n\t} catch (e) {\n\t\tif (typeof window === 'object') return window;\n\t}\n})();","__webpack_require__.o = function(obj, prop) { return Object.prototype.hasOwnProperty.call(obj, prop); }","// define __esModule on exports\n__webpack_require__.r = function(exports) {\n\tif(typeof Symbol !== 'undefined' && Symbol.toStringTag) {\n\t\tObject.defineProperty(exports, Symbol.toStringTag, { value: 'Module' });\n\t}\n\tObject.defineProperty(exports, '__esModule', { value: true });\n};","__webpack_require__.nmd = function(module) {\n\tmodule.paths = [];\n\tif (!module.children) module.children = [];\n\treturn module;\n};","__webpack_require__.p = \"/kana/\";","__webpack_require__.b = self.location + \"/../../../\";\n\n// object to store loaded chunks\n// \"1\" means \"already loaded\"\nvar installedChunks = {\n\t612: 1\n};\n\n// importScripts chunk loading\nvar installChunk = function(data) {\n\tvar chunkIds = data[0];\n\tvar moreModules = data[1];\n\tvar runtime = data[2];\n\tfor(var moduleId in moreModules) {\n\t\tif(__webpack_require__.o(moreModules, moduleId)) {\n\t\t\t__webpack_require__.m[moduleId] = moreModules[moduleId];\n\t\t}\n\t}\n\tif(runtime) runtime(__webpack_require__);\n\twhile(chunkIds.length)\n\t\tinstalledChunks[chunkIds.pop()] = 1;\n\tparentChunkLoadingFunction(data);\n};\n__webpack_require__.f.i = function(chunkId, promises) {\n\t// \"1\" is the signal for \"already loaded\"\n\tif(!installedChunks[chunkId]) {\n\t\tif(true) { // all chunks have JS\n\t\t\timportScripts(__webpack_require__.p + __webpack_require__.u(chunkId));\n\t\t}\n\t}\n};\n\nvar chunkLoadingGlobal = self[\"webpackChunkkana\"] = self[\"webpackChunkkana\"] || [];\nvar parentChunkLoadingFunction = chunkLoadingGlobal.push.bind(chunkLoadingGlobal);\nchunkLoadingGlobal.push = installChunk;\n\n// no HMR\n\n// no HMR manifest","var next = __webpack_require__.x;\n__webpack_require__.x = function() {\n\treturn Promise.all([660,830,797].map(__webpack_require__.e, __webpack_require__)).then(next);\n};","// run startup\nvar __webpack_exports__ = __webpack_require__.x();\n"],"names":["kanaDB","init","getRecordsResolver","resolve","store","arguments","length","undefined","result","transaction","objectStore","allAnalysis","getAll","onsuccess","vals","forEach","x","files","onerror","loadContent","_x","_x2","_loadContent","apply","_asyncToGenerator","_regeneratorRuntime","mark","_callee","id","wrap","_context","prev","next","abrupt","Promise","request","get","stop","allOK","promises","allSettled","then","_step","_iterator","_createForOfIteratorHelper","s","n","done","value","err","e","f","getRecords","_getRecords","_callee2","_context2","saveFile","_x3","_x4","_saveFile","_callee3","buffer","trans","file_store","meta_store","meta","refcount","data_saving","ref_saving","_context3","sent","putrequest","put","payload","event","count","saveAnalysis","_x5","_x6","_x7","_x8","_saveAnalysis","_callee4","state","title","analysis_store","already","id_saving","_context4","String","time","Number","Date","loadFile","_x9","_loadFile","_callee5","_context5","Uint8Array","loadAnalysis","_x10","_loadAnalysis","_callee6","_context6","removeFile","_x11","_removeFile","_callee7","_context7","push","remove","delete","_removeAnalysis","_callee8","_i","_Object$entries","_Object$entries$_i","v","_iterator2","_step2","_context8","Object","entries","_slicedToArray","DownloadsDB","_get","url","params","force","_trans","_download_store","data_check","found","req","res","download_store","_args2","fetch","ok","status","arrayBuffer","proxy","proxyAndCache","_proxyAndCache","downloads","encodeURIComponent","extractBuffers","object","Array","isArray","constructor","ArrayBuffer","isView","postAttempt","step","postMessage","type","concat","postSuccess","info","transferable","resp","postError","fatal","reason","toString","splitMetricsByBlock","metrics","blockLevels","blockIds","output","blocks","slice","b","current","_i2","_Object$entries2","_Object$entries2$_i","key","val","filter","i","splitThresholdsByBlock","thresholds","_i3","_Object$entries3","_Object$entries3$_i","fetchStepSummary","_fetchStepSummary","_output","ngenes","_iterator3","_step3","a","gene_info","_i4","_Object$entries4","_Object$entries4$_i","k","_iterator4","_step4","c","col","cell_info","_iterator5","_step5","_c","_col2","_ksumm","_col","ksumm","_output2","bids","listed","_metrics","_bids","_listed","_i5","_Object$entries5","_Object$entries5$_i","_metrics2","_output3","_bids2","_listed2","remaining","discard_vec","discardBuff","_output4","_output5","pcs","var_exp","total_var","clusters","collections","sets","changed","fetchCountMatrix","available","numberOfRows","fetchFeatureAnnotations","columnNames","column","rowNames","fetchCellAnnotations","isArrayOrView","describeColumn","all","unique","colname","fetchBlockLevels","fetchBlock","num_cells","numberOfColumns","num_genes","genes","annotations","sums","fetchMetrics","detected","proportion","subsetProportions","data","default","fetchFilters","thresholdsSums","thresholdsDetected","thresholdsSubsetProportions","subsetTotals","thresholdsSubsetTotals","NaN","maxProportions","thresholdsMaxCount","fetchDiscards","inputs","retained","discard","means","fetchResults","vars","variances","fitted","resids","residuals","fetchPCs","varianceExplained","totalVariance","fetchClusters","feature_set_enrichment","fetchCollectionDetails","fetchSetDetails","names","descriptions","sizes","_ref3","_ref3$all","_ref3$unique","_ref3$colname","bakana","uqVals","Set","size","_toConsumableArray","sort","gesel","_ref","file","start","end","full","Response","_ref2","remotes","code","default_cluster","default_selection","superstate","preflights","preflights_summary","cache_matrix","cache_anno_markers","createDataset","args","format","h5","options","mtx","rds","zipname","zipfile","Error","summarizeDataset","summary","cells_summary","cells","kcol","tmp_meta","columns","numberOfCells","tmod_summary","numberOfFeatures","rownames","modality_features","all_assay_names","modality_assay_names","postStepSummary","_postStepSummary","_callee16","_context16","t0","console","error","getMarkerStandAloneForAnnot","annotation","annotation_vec","mds","getMatrix","ids","computeAll","y","iter","iteration","kana_db","loaded","getAnnotation","vec","unfiltered","startsWith","split_metric","replace","split","toLowerCase","cell_filtering","applyFilter","scran","RNA","ADT","CRISPR","valid","add","fetchNormalizedMatrix","onmessage","msg","_msg$data","nthreads","Math","round","navigator","hardwareConcurrency","back_init","numberOfThreads","state_init","kana_init","indexedDB","open","onupgradeneeded","kanaDBClient","target","deleteObjectStore","createObjectStore","keyPath","catch","down_init","reject","DownloadsDBClient","ehub_ids","uid","setOptions","_i6","_Object$entries6","_Object$entries6$_i","clear","free","resetMarkerState","formatted","safeReplace","par","batch","subset","batch_correction","neighbor_index","combine_embeddings","weights","rna_weight","adt_weight","crispr_weight","translate","startFun","finishFun","fs","keys","reader","zipbuffer","unzipped","config","buffers","other","transferrable","features","loaded_ds","_i7","_Object$entries7","_Object$entries7$_i","_i8","_arr","i_mod","_i9","_Object$entries8","_Object$entries8$_i","_k7","_v3","FileReaderSync","readAsArrayBuffer","JSZip","JSON","async","t1","parse","call","t2","t3","custom_selections","fetchSelections","parameters","fetchDatasets","previewPrimaryIds","cache","jsonbuffer","dec","TextDecoder","decode","_ref4","saver","collected","zipper","name","stringify","generateAsync","_ref5","gene_files","_f","forceBuffer","_ref6","enc","recs","_ref7","md5","hashwasm","_x12","_x13","TextEncoder","encode","_ref8","_x14","_ref9","_callee9","counter","_i10","_Object$entries9","_Object$entries9$_i","ds","_i11","_arr2","_i12","_Object$entries10","_Object$entries10$_i","_k8","_v4","_context9","_x15","_ref10","_callee10","_i13","_Object$entries11","_Object$entries11$_i","tmp_dataset","_context10","details","_x16","raw_res","rank_type","modality","marker_detection","computeVersus","left","right","results","levels","indexOf","cluster","row_idx","gene","matrix","row","expr","addSelection","selection","removeSelection","_ref11","_callee11","_context11","tsne","animate","_x17","_ref12","_callee12","_context12","umap","_x18","annot","values","uniq_vals","uniq_map","indices","Int32Array","map","index","extracted","_ref13","_callee13","sel_indices","arr_sel_indices","anno_markers","_annotation_vec","_mds","_anno_markers","_context13","computeEnrichment","fetchSelectionIndices","fetchFilteredMatrix","set","_x19","_ref14","_callee14","_raw_res","_context14","_x20","computePerCellScores","marker_resp","fetchFeatureSetIndices","ordering","includes","filtered_marker_resp","_i14","_Object$entries12","_Object$entries12$_i","__webpack_module_cache__","__webpack_require__","moduleId","cachedModule","exports","module","__webpack_modules__","m","__webpack_exports__","O","deferred","chunkIds","fn","priority","notFulfilled","Infinity","fulfilled","j","every","splice","r","getter","__esModule","d","definition","o","defineProperty","enumerable","chunkId","reduce","u","miniCssF","g","globalThis","this","Function","window","obj","prop","prototype","hasOwnProperty","Symbol","toStringTag","nmd","paths","children","p","self","location","installedChunks","importScripts","chunkLoadingGlobal","parentChunkLoadingFunction","bind","moreModules","runtime","pop"],"sourceRoot":""}