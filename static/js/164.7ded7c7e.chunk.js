/*! For license information please see 164.7ded7c7e.chunk.js.LICENSE.txt */
(self.webpackChunkkana=self.webpackChunkkana||[]).push([[164],{8109:function(e,t,r){"use strict";r.d(t,{FB:function(){return M}});var n=r(5671),i=r(3144),a=r(7757),s=r.n(a);function o(e,t,r,n){return new(r||(r=Promise))((function(i,a){function s(e){try{u(n.next(e))}catch(t){a(t)}}function o(e){try{u(n.throw(e))}catch(t){a(t)}}function u(e){var t;e.done?i(e.value):(t=e.value,t instanceof r?t:new r((function(e){e(t)}))).then(s,o)}u((n=n.apply(e,t||[])).next())}))}var u,l=function(){function e(){(0,n.Z)(this,e),this.mutex=Promise.resolve()}return(0,i.Z)(e,[{key:"lock",value:function(){var e=function(){};return this.mutex=this.mutex.then((function(){return new Promise(e)})),new Promise((function(t){e=t}))}},{key:"dispatch",value:function(e){return o(this,void 0,void 0,s().mark((function t(){var r;return s().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,this.lock();case 2:return r=t.sent,t.prev=3,t.next=6,Promise.resolve(e());case 6:return t.abrupt("return",t.sent);case 7:return t.prev=7,r(),t.finish(7);case 10:case"end":return t.stop()}}),t,this,[[3,,7,10]])})))}}]),e}();var c="undefined"!==typeof globalThis?globalThis:"undefined"!==typeof self?self:"undefined"!==typeof window?window:r.g,h=null!==(u=c.Buffer)&&void 0!==u?u:null,f=c.TextEncoder?new c.TextEncoder:null;function d(e,t){return(15&e)+(e>>6|e>>3&8)<<4|(15&t)+(t>>6|t>>3&8)}function v(e,t){for(var r=t.length>>1,n=0;n<r;n++){var i=n<<1;e[n]=d(t.charCodeAt(i),t.charCodeAt(i+1))}}function m(e,t){if(e.length!==2*t.length)return!1;for(var r=0;r<t.length;r++){var n=r<<1;if(t[r]!==d(e.charCodeAt(n),e.charCodeAt(n+1)))return!1}return!0}var p="a".charCodeAt(0)-10,w="0".charCodeAt(0);function g(e,t,r){for(var n=0,i=0;i<r;i++){var a=t[i]>>>4;e[n++]=a>9?a+p:a+w,a=15&t[i],e[n++]=a>9?a+p:a+w}return String.fromCharCode.apply(null,e)}for(var b=null!==h?function(e){if("string"===typeof e){var t=h.from(e,"utf8");return new Uint8Array(t.buffer,t.byteOffset,t.length)}if(h.isBuffer(e))return new Uint8Array(e.buffer,e.byteOffset,e.length);if(ArrayBuffer.isView(e))return new Uint8Array(e.buffer,e.byteOffset,e.byteLength);throw new Error("Invalid data type!")}:function(e){if("string"===typeof e)return f.encode(e);if(ArrayBuffer.isView(e))return new Uint8Array(e.buffer,e.byteOffset,e.byteLength);throw new Error("Invalid data type!")},y="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/",Z=new Uint8Array(256),_=0;_<y.length;_++)Z[y.charCodeAt(_)]=_;function k(e){var t=Math.floor(.75*e.length),r=e.length;return"="===e[r-1]&&(t-=1,"="===e[r-2]&&(t-=1)),t}function A(e){for(var t=k(e),r=e.length,n=new Uint8Array(t),i=0,a=0;a<r;a+=4){var s=Z[e.charCodeAt(a)],o=Z[e.charCodeAt(a+1)],u=Z[e.charCodeAt(a+2)],l=Z[e.charCodeAt(a+3)];n[i]=s<<2|o>>4,n[i+=1]=(15&o)<<4|u>>2,n[i+=1]=(3&u)<<6|63&l,i+=1}return n}var x=16384,E=new l,S=new Map;function O(e,t){return o(this,void 0,void 0,s().mark((function r(){var n,i,a,u,l,c,h,f,d,p,w,y,Z,_,k,O,I,C,R,N,M=this;return s().wrap((function(r){for(;;)switch(r.prev=r.next){case 0:if(n=null,i=null,a=!1,"undefined"!==typeof WebAssembly){r.next=5;break}throw new Error("WebAssembly is not supported in this environment!");case 5:u=function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0;i.set(e,t)},l=function(){return i},c=function(){return n.exports},h=function(e){n.exports.Hash_SetMemorySize(e);var t=n.exports.Hash_GetBuffer(),r=n.exports.memory.buffer;i=new Uint8Array(r,t,e)},f=function(){return new DataView(n.exports.memory.buffer).getUint32(n.exports.STATE_SIZE,!0)},d=E.dispatch((function(){return o(M,void 0,void 0,s().mark((function t(){var r,i,a;return s().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return S.has(e.name)||(r=A(e.data),i=WebAssembly.compile(r),S.set(e.name,i)),t.next=3,S.get(e.name);case 3:return a=t.sent,t.next=6,WebAssembly.instantiate(a,{});case 6:n=t.sent;case 7:case"end":return t.stop()}}),t)})))})),p=function(){return o(M,void 0,void 0,s().mark((function e(){var t,r;return s().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(n){e.next=3;break}return e.next=3,d;case 3:t=n.exports.Hash_GetBuffer(),r=n.exports.memory.buffer,i=new Uint8Array(r,t,x);case 6:case"end":return e.stop()}}),e)})))},w=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:null;a=!0,n.exports.Hash_Init(e)},y=function(e){for(var t=0;t<e.length;){var r=e.subarray(t,t+x);t+=r.length,i.set(r),n.exports.Hash_Update(r.length)}},Z=function(e){if(!a)throw new Error("update() called before init()");var t=b(e);y(t)},_=new Uint8Array(2*t),k=function(e){var r=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null;if(!a)throw new Error("digest() called before init()");return a=!1,n.exports.Hash_Final(r),"binary"===e?i.slice(0,t):g(_,i,t)},O=function(){if(!a)throw new Error("save() can only be called after init() and before digest()");var t=n.exports.Hash_GetState(),r=f(),i=n.exports.memory.buffer,s=new Uint8Array(i,t,r),o=new Uint8Array(4+r);return v(o,e.hash),o.set(s,4),o},I=function(t){if(!(t instanceof Uint8Array))throw new Error("load() expects an Uint8Array generated by save()");var r=n.exports.Hash_GetState(),i=f(),s=4+i,o=n.exports.memory.buffer;if(t.length!==s)throw new Error("Bad state length (expected ".concat(s," bytes, got ").concat(t.length,")"));if(!m(e.hash,t.subarray(0,4)))throw new Error("This state was written by an incompatible hash implementation");var u=t.subarray(4);new Uint8Array(o,r,i).set(u),a=!0},C=function(e){return"string"===typeof e?e.length<4096:e.byteLength<x},R=C,r.t0=e.name,r.next="argon2"===r.t0||"scrypt"===r.t0?24:"blake2b"===r.t0||"blake2s"===r.t0?26:"blake3"===r.t0?28:"xxhash64"===r.t0||"xxhash3"===r.t0||"xxhash128"===r.t0?30:32;break;case 24:return R=function(){return!0},r.abrupt("break",32);case 26:return R=function(e,t){return t<=512&&C(e)},r.abrupt("break",32);case 28:return R=function(e,t){return 0===t&&C(e)},r.abrupt("break",32);case 30:return R=function(){return!1},r.abrupt("break",32);case 32:return N=function(e){var r=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null,a=arguments.length>2&&void 0!==arguments[2]?arguments[2]:null;if(!R(e,r))return w(r),Z(e),k("hex",a);var s=b(e);return i.set(s),n.exports.Hash_Calculate(s.length,r,a),g(_,i,t)},r.next=35,p();case 35:return r.abrupt("return",{getMemory:l,writeMemory:u,getExports:c,setMemorySize:h,init:w,update:Z,digest:k,save:O,load:I,calculate:N,hashLength:t});case 36:case"end":return r.stop()}}),r)})))}function I(e,t,r){return o(this,void 0,void 0,s().mark((function n(){var i,a;return s().wrap((function(n){for(;;)switch(n.prev=n.next){case 0:return n.next=2,e.lock();case 2:return i=n.sent,n.next=5,O(t,r);case 5:return a=n.sent,i(),n.abrupt("return",a);case 8:case"end":return n.stop()}}),n)})))}new l;new l;new DataView(new ArrayBuffer(4));new l;new l;new l;new l;new l;var C={name:"md5",data:"AGFzbQEAAAABEgRgAAF/YAAAYAF/AGACf38BfwMIBwABAgMBAAIEBQFwAQEBBQQBAQICBg4CfwFBoIoFC38AQYAICwdwCAZtZW1vcnkCAA5IYXNoX0dldEJ1ZmZlcgAACUhhc2hfSW5pdAABC0hhc2hfVXBkYXRlAAIKSGFzaF9GaW5hbAAEDUhhc2hfR2V0U3RhdGUABQ5IYXNoX0NhbGN1bGF0ZQAGClNUQVRFX1NJWkUDAQqzFgcFAEGACQstAEEAQv6568XpjpWZEDcCkIkBQQBCgcaUupbx6uZvNwKIiQFBAEIANwKAiQEL6AIBA39BAEEAKAKAiQEiASAAakH/////AXEiAjYCgIkBQQAoAoSJASEDAkAgAiABTw0AQQAgA0EBaiIDNgKEiQELQQAgAyAAQR12ajYChIkBAkACQAJAAkACQAJAIAFBP3EiAw0AQYAJIQIMAQtBwAAgA2siAiAASw0BIANBGGohA0EAIQEDQCADIAFqQYCJAWogAUGACWotAAA6AAAgAyABQQFqIgFqQdgARw0AC0GYiQFBwAAQAxogACACayEAIAJBgAlqIQILIABBwABPDQEgACEDDAILIABFDQJBACEBIANBmIkBakEALQCACToAACAAQQFGDQIgA0GZiQFqIQMgAEF/aiECA0AgAyABaiABQYEJai0AADoAACACIAFBAWoiAUcNAAwDCwsgAEE/cSEDIAIgAEFAcRADIQILIANFDQBBACEBA0AgAUGYiQFqIAIgAWotAAA6AAAgAyABQQFqIgFHDQALCwu0EAEZf0EAKAKUiQEhAkEAKAKQiQEhA0EAKAKMiQEhBEEAKAKIiQEhBQNAIABBCGooAgAiBiAAQRhqKAIAIgcgAEEoaigCACIIIABBOGooAgAiCSAAQTxqKAIAIgogAEEMaigCACILIABBHGooAgAiDCAAQSxqKAIAIg0gDCALIAogDSAJIAggByADIAZqIAIgAEEEaigCACIOaiAFIAQgAiADc3EgAnNqIAAoAgAiD2pB+Miqu31qQQd3IARqIhAgBCADc3EgA3NqQdbunsZ+akEMdyAQaiIRIBAgBHNxIARzakHb4YGhAmpBEXcgEWoiEmogAEEUaigCACITIBFqIABBEGooAgAiFCAQaiAEIAtqIBIgESAQc3EgEHNqQe6d9418akEWdyASaiIQIBIgEXNxIBFzakGvn/Crf2pBB3cgEGoiESAQIBJzcSASc2pBqoyfvARqQQx3IBFqIhIgESAQc3EgEHNqQZOMwcF6akERdyASaiIVaiAAQSRqKAIAIhYgEmogAEEgaigCACIXIBFqIAwgEGogFSASIBFzcSARc2pBgaqaampBFncgFWoiECAVIBJzcSASc2pB2LGCzAZqQQd3IBBqIhEgECAVc3EgFXNqQa/vk9p4akEMdyARaiISIBEgEHNxIBBzakGxt31qQRF3IBJqIhVqIABBNGooAgAiGCASaiAAQTBqKAIAIhkgEWogDSAQaiAVIBIgEXNxIBFzakG+r/PKeGpBFncgFWoiECAVIBJzcSASc2pBoqLA3AZqQQd3IBBqIhEgECAVc3EgFXNqQZPj4WxqQQx3IBFqIhUgESAQc3EgEHNqQY6H5bN6akERdyAVaiISaiAHIBVqIA4gEWogCiAQaiASIBUgEXNxIBFzakGhkNDNBGpBFncgEmoiECAScyAVcSASc2pB4sr4sH9qQQV3IBBqIhEgEHMgEnEgEHNqQcDmgoJ8akEJdyARaiISIBFzIBBxIBFzakHRtPmyAmpBDncgEmoiFWogCCASaiATIBFqIA8gEGogFSAScyARcSASc2pBqo/bzX5qQRR3IBVqIhAgFXMgEnEgFXNqQd2gvLF9akEFdyAQaiIRIBBzIBVxIBBzakHTqJASakEJdyARaiISIBFzIBBxIBFzakGBzYfFfWpBDncgEmoiFWogCSASaiAWIBFqIBQgEGogFSAScyARcSASc2pByPfPvn5qQRR3IBVqIhAgFXMgEnEgFXNqQeabh48CakEFdyAQaiIRIBBzIBVxIBBzakHWj9yZfGpBCXcgEWoiEiARcyAQcSARc2pBh5vUpn9qQQ53IBJqIhVqIAYgEmogGCARaiAXIBBqIBUgEnMgEXEgEnNqQe2p6KoEakEUdyAVaiIQIBVzIBJxIBVzakGF0o/PempBBXcgEGoiESAQcyAVcSAQc2pB+Me+Z2pBCXcgEWoiEiARcyAQcSARc2pB2YW8uwZqQQ53IBJqIhVqIBcgEmogEyARaiAZIBBqIBUgEnMgEXEgEnNqQYqZqel4akEUdyAVaiIQIBVzIhUgEnNqQcLyaGpBBHcgEGoiESAVc2pBge3Hu3hqQQt3IBFqIhIgEXMiGiAQc2pBosL17AZqQRB3IBJqIhVqIBQgEmogDiARaiAJIBBqIBUgGnNqQYzwlG9qQRd3IBVqIhAgFXMiFSASc2pBxNT7pXpqQQR3IBBqIhEgFXNqQamf+94EakELdyARaiISIBFzIgkgEHNqQeCW7bV/akEQdyASaiIVaiAPIBJqIBggEWogCCAQaiAVIAlzakHw+P71e2pBF3cgFWoiECAVcyIVIBJzakHG/e3EAmpBBHcgEGoiESAVc2pB+s+E1X5qQQt3IBFqIhIgEXMiCCAQc2pBheG8p31qQRB3IBJqIhVqIBkgEmogFiARaiAHIBBqIBUgCHNqQYW6oCRqQRd3IBVqIhEgFXMiECASc2pBuaDTzn1qQQR3IBFqIhIgEHNqQeWz7rZ+akELdyASaiIVIBJzIgcgEXNqQfj5if0BakEQdyAVaiIQaiAMIBVqIA8gEmogBiARaiAQIAdzakHlrLGlfGpBF3cgEGoiESAVQX9zciAQc2pBxMSkoX9qQQZ3IBFqIhIgEEF/c3IgEXNqQZf/q5kEakEKdyASaiIQIBFBf3NyIBJzakGnx9DcempBD3cgEGoiFWogCyAQaiAZIBJqIBMgEWogFSASQX9zciAQc2pBucDOZGpBFXcgFWoiESAQQX9zciAVc2pBw7PtqgZqQQZ3IBFqIhAgFUF/c3IgEXNqQZKZs/h4akEKdyAQaiISIBFBf3NyIBBzakH96L9/akEPdyASaiIVaiAKIBJqIBcgEGogDiARaiAVIBBBf3NyIBJzakHRu5GseGpBFXcgFWoiECASQX9zciAVc2pBz/yh/QZqQQZ3IBBqIhEgFUF/c3IgEHNqQeDNs3FqQQp3IBFqIhIgEEF/c3IgEXNqQZSGhZh6akEPdyASaiIVaiANIBJqIBQgEWogGCAQaiAVIBFBf3NyIBJzakGho6DwBGpBFXcgFWoiECASQX9zciAVc2pBgv3Nun9qQQZ3IBBqIhEgFUF/c3IgEHNqQbXk6+l7akEKdyARaiISIBBBf3NyIBFzakG7pd/WAmpBD3cgEmoiFSAEaiAWIBBqIBUgEUF/c3IgEnNqQZGnm9x+akEVd2ohBCAVIANqIQMgEiACaiECIBEgBWohBSAAQcAAaiEAIAFBQGoiAQ0AC0EAIAI2ApSJAUEAIAM2ApCJAUEAIAQ2AoyJAUEAIAU2AoiJASAAC6ECAQN/QQAoAoCJASIAQT9xIgFBmIkBakGAAToAAAJAAkACQCABQT9zIgJBB0sNAAJAIAJFDQAgAUGZiQFqIQADQCAAQQA6AAAgAEEBaiEAIAJBf2oiAg0ACwtBwAAhAkGYiQFBwAAQAxpBACEADAELIAJBCEYNASABQQFqIQALIABBj4kBaiEBA0AgASACakEAOgAAIAJBd2ohACACQX9qIQIgAEEASg0AC0EAKAKAiQEhAAtBACAAQRV2OgDTiQFBACAAQQ12OgDSiQFBACAAQQV2OgDRiQFBACAAQQN0IgI6ANCJAUEAIAI2AoCJAUEAQQAoAoSJATYC1IkBQZiJAUHAABADGkEAQQApAoiJATcDgAlBAEEAKQKQiQE3A4gJCwYAQYCJAQszAEEAQv6568XpjpWZEDcCkIkBQQBCgcaUupbx6uZvNwKIiQFBAEIANwKAiQEgABACEAQLCwsBAEGACAsEmAAAAA==",hash:"9b0fac7d"},R=new l,N=null;function M(e){if(null===N)return I(R,C,16).then((function(t){return(N=t).calculate(e)}));try{var t=N.calculate(e);return Promise.resolve(t)}catch(r){return Promise.reject(r)}}new l;new l;new l;new l;new l;new l;new l;new l;new l,new ArrayBuffer(8);new l,new ArrayBuffer(8);new l,new ArrayBuffer(8);new l;new l;new l},1025:function(e,t){var r,n,i;n=[],r=function e(){"use strict";var t="undefined"!=typeof self?self:"undefined"!=typeof window?window:void 0!==t?t:{},r=!t.document&&!!t.postMessage,n=r&&/blob:/i.test((t.location||{}).protocol),i={},a=0,s={parse:function(r,n){var o=(n=n||{}).dynamicTyping||!1;if(Z(o)&&(n.dynamicTypingFunction=o,o={}),n.dynamicTyping=o,n.transform=!!Z(n.transform)&&n.transform,n.worker&&s.WORKERS_SUPPORTED){var u=function(){if(!s.WORKERS_SUPPORTED)return!1;var r,n,o=(r=t.URL||t.webkitURL||null,n=e.toString(),s.BLOB_URL||(s.BLOB_URL=r.createObjectURL(new Blob(["(",n,")();"],{type:"text/javascript"})))),u=new t.Worker(o);return u.onmessage=p,u.id=a++,i[u.id]=u}();return u.userStep=n.step,u.userChunk=n.chunk,u.userComplete=n.complete,u.userError=n.error,n.step=Z(n.step),n.chunk=Z(n.chunk),n.complete=Z(n.complete),n.error=Z(n.error),delete n.worker,void u.postMessage({input:r,config:n,workerId:u.id})}var d=null;return s.NODE_STREAM_INPUT,"string"==typeof r?d=n.download?new l(n):new h(n):!0===r.readable&&Z(r.read)&&Z(r.on)?d=new f(n):(t.File&&r instanceof File||r instanceof Object)&&(d=new c(n)),d.stream(r)},unparse:function(e,t){var r=!1,n=!0,i=",",a="\r\n",o='"',u=o+o,l=!1,c=null,h=!1;!function(){if("object"==typeof t){if("string"!=typeof t.delimiter||s.BAD_DELIMITERS.filter((function(e){return-1!==t.delimiter.indexOf(e)})).length||(i=t.delimiter),("boolean"==typeof t.quotes||"function"==typeof t.quotes||Array.isArray(t.quotes))&&(r=t.quotes),"boolean"!=typeof t.skipEmptyLines&&"string"!=typeof t.skipEmptyLines||(l=t.skipEmptyLines),"string"==typeof t.newline&&(a=t.newline),"string"==typeof t.quoteChar&&(o=t.quoteChar),"boolean"==typeof t.header&&(n=t.header),Array.isArray(t.columns)){if(0===t.columns.length)throw new Error("Option columns is empty");c=t.columns}void 0!==t.escapeChar&&(u=t.escapeChar+o),("boolean"==typeof t.escapeFormulae||t.escapeFormulae instanceof RegExp)&&(h=t.escapeFormulae instanceof RegExp?t.escapeFormulae:/^[=+\-@\t\r].*$/)}}();var f=new RegExp(v(o),"g");if("string"==typeof e&&(e=JSON.parse(e)),Array.isArray(e)){if(!e.length||Array.isArray(e[0]))return d(null,e,l);if("object"==typeof e[0])return d(c||Object.keys(e[0]),e,l)}else if("object"==typeof e)return"string"==typeof e.data&&(e.data=JSON.parse(e.data)),Array.isArray(e.data)&&(e.fields||(e.fields=e.meta&&e.meta.fields||c),e.fields||(e.fields=Array.isArray(e.data[0])?e.fields:"object"==typeof e.data[0]?Object.keys(e.data[0]):[]),Array.isArray(e.data[0])||"object"==typeof e.data[0]||(e.data=[e.data])),d(e.fields||[],e.data||[],l);throw new Error("Unable to serialize unrecognized input");function d(e,t,r){var s="";"string"==typeof e&&(e=JSON.parse(e)),"string"==typeof t&&(t=JSON.parse(t));var o=Array.isArray(e)&&0<e.length,u=!Array.isArray(t[0]);if(o&&n){for(var l=0;l<e.length;l++)0<l&&(s+=i),s+=m(e[l],l);0<t.length&&(s+=a)}for(var c=0;c<t.length;c++){var h=o?e.length:t[c].length,f=!1,d=o?0===Object.keys(t[c]).length:0===t[c].length;if(r&&!o&&(f="greedy"===r?""===t[c].join("").trim():1===t[c].length&&0===t[c][0].length),"greedy"===r&&o){for(var v=[],p=0;p<h;p++){var w=u?e[p]:p;v.push(t[c][w])}f=""===v.join("").trim()}if(!f){for(var g=0;g<h;g++){0<g&&!d&&(s+=i);var b=o&&u?e[g]:g;s+=m(t[c][b],g)}c<t.length-1&&(!r||0<h&&!d)&&(s+=a)}}return s}function m(e,t){if(null==e)return"";if(e.constructor===Date)return JSON.stringify(e).slice(1,25);var n=!1;h&&"string"==typeof e&&h.test(e)&&(e="'"+e,n=!0);var a=e.toString().replace(f,u);return(n=n||!0===r||"function"==typeof r&&r(e,t)||Array.isArray(r)&&r[t]||function(e,t){for(var r=0;r<t.length;r++)if(-1<e.indexOf(t[r]))return!0;return!1}(a,s.BAD_DELIMITERS)||-1<a.indexOf(i)||" "===a.charAt(0)||" "===a.charAt(a.length-1))?o+a+o:a}}};if(s.RECORD_SEP=String.fromCharCode(30),s.UNIT_SEP=String.fromCharCode(31),s.BYTE_ORDER_MARK="\ufeff",s.BAD_DELIMITERS=["\r","\n",'"',s.BYTE_ORDER_MARK],s.WORKERS_SUPPORTED=!r&&!!t.Worker,s.NODE_STREAM_INPUT=1,s.LocalChunkSize=10485760,s.RemoteChunkSize=5242880,s.DefaultDelimiter=",",s.Parser=m,s.ParserHandle=d,s.NetworkStreamer=l,s.FileStreamer=c,s.StringStreamer=h,s.ReadableStreamStreamer=f,t.jQuery){var o=t.jQuery;o.fn.parse=function(e){var r=e.config||{},n=[];return this.each((function(e){if("INPUT"!==o(this).prop("tagName").toUpperCase()||"file"!==o(this).attr("type").toLowerCase()||!t.FileReader||!this.files||0===this.files.length)return!0;for(var i=0;i<this.files.length;i++)n.push({file:this.files[i],inputElem:this,instanceConfig:o.extend({},r)})})),i(),this;function i(){if(0!==n.length){var t,r,i,u,l=n[0];if(Z(e.before)){var c=e.before(l.file,l.inputElem);if("object"==typeof c){if("abort"===c.action)return t="AbortError",r=l.file,i=l.inputElem,u=c.reason,void(Z(e.error)&&e.error({name:t},r,i,u));if("skip"===c.action)return void a();"object"==typeof c.config&&(l.instanceConfig=o.extend(l.instanceConfig,c.config))}else if("skip"===c)return void a()}var h=l.instanceConfig.complete;l.instanceConfig.complete=function(e){Z(h)&&h(e,l.file,l.inputElem),a()},s.parse(l.file,l.instanceConfig)}else Z(e.complete)&&e.complete()}function a(){n.splice(0,1),i()}}}function u(e){this._handle=null,this._finished=!1,this._completed=!1,this._halted=!1,this._input=null,this._baseIndex=0,this._partialLine="",this._rowCount=0,this._start=0,this._nextChunk=null,this.isFirstChunk=!0,this._completeResults={data:[],errors:[],meta:{}},function(e){var t=b(e);t.chunkSize=parseInt(t.chunkSize),e.step||e.chunk||(t.chunkSize=null),this._handle=new d(t),(this._handle.streamer=this)._config=t}.call(this,e),this.parseChunk=function(e,r){if(this.isFirstChunk&&Z(this._config.beforeFirstChunk)){var i=this._config.beforeFirstChunk(e);void 0!==i&&(e=i)}this.isFirstChunk=!1,this._halted=!1;var a=this._partialLine+e;this._partialLine="";var o=this._handle.parse(a,this._baseIndex,!this._finished);if(!this._handle.paused()&&!this._handle.aborted()){var u=o.meta.cursor;this._finished||(this._partialLine=a.substring(u-this._baseIndex),this._baseIndex=u),o&&o.data&&(this._rowCount+=o.data.length);var l=this._finished||this._config.preview&&this._rowCount>=this._config.preview;if(n)t.postMessage({results:o,workerId:s.WORKER_ID,finished:l});else if(Z(this._config.chunk)&&!r){if(this._config.chunk(o,this._handle),this._handle.paused()||this._handle.aborted())return void(this._halted=!0);o=void 0,this._completeResults=void 0}return this._config.step||this._config.chunk||(this._completeResults.data=this._completeResults.data.concat(o.data),this._completeResults.errors=this._completeResults.errors.concat(o.errors),this._completeResults.meta=o.meta),this._completed||!l||!Z(this._config.complete)||o&&o.meta.aborted||(this._config.complete(this._completeResults,this._input),this._completed=!0),l||o&&o.meta.paused||this._nextChunk(),o}this._halted=!0},this._sendError=function(e){Z(this._config.error)?this._config.error(e):n&&this._config.error&&t.postMessage({workerId:s.WORKER_ID,error:e,finished:!1})}}function l(e){var t;(e=e||{}).chunkSize||(e.chunkSize=s.RemoteChunkSize),u.call(this,e),this._nextChunk=r?function(){this._readChunk(),this._chunkLoaded()}:function(){this._readChunk()},this.stream=function(e){this._input=e,this._nextChunk()},this._readChunk=function(){if(this._finished)this._chunkLoaded();else{if(t=new XMLHttpRequest,this._config.withCredentials&&(t.withCredentials=this._config.withCredentials),r||(t.onload=y(this._chunkLoaded,this),t.onerror=y(this._chunkError,this)),t.open(this._config.downloadRequestBody?"POST":"GET",this._input,!r),this._config.downloadRequestHeaders){var e=this._config.downloadRequestHeaders;for(var n in e)t.setRequestHeader(n,e[n])}if(this._config.chunkSize){var i=this._start+this._config.chunkSize-1;t.setRequestHeader("Range","bytes="+this._start+"-"+i)}try{t.send(this._config.downloadRequestBody)}catch(e){this._chunkError(e.message)}r&&0===t.status&&this._chunkError()}},this._chunkLoaded=function(){4===t.readyState&&(t.status<200||400<=t.status?this._chunkError():(this._start+=this._config.chunkSize?this._config.chunkSize:t.responseText.length,this._finished=!this._config.chunkSize||this._start>=function(e){var t=e.getResponseHeader("Content-Range");return null===t?-1:parseInt(t.substring(t.lastIndexOf("/")+1))}(t),this.parseChunk(t.responseText)))},this._chunkError=function(e){var r=t.statusText||e;this._sendError(new Error(r))}}function c(e){var t,r;(e=e||{}).chunkSize||(e.chunkSize=s.LocalChunkSize),u.call(this,e);var n="undefined"!=typeof FileReader;this.stream=function(e){this._input=e,r=e.slice||e.webkitSlice||e.mozSlice,n?((t=new FileReader).onload=y(this._chunkLoaded,this),t.onerror=y(this._chunkError,this)):t=new FileReaderSync,this._nextChunk()},this._nextChunk=function(){this._finished||this._config.preview&&!(this._rowCount<this._config.preview)||this._readChunk()},this._readChunk=function(){var e=this._input;if(this._config.chunkSize){var i=Math.min(this._start+this._config.chunkSize,this._input.size);e=r.call(e,this._start,i)}var a=t.readAsText(e,this._config.encoding);n||this._chunkLoaded({target:{result:a}})},this._chunkLoaded=function(e){this._start+=this._config.chunkSize,this._finished=!this._config.chunkSize||this._start>=this._input.size,this.parseChunk(e.target.result)},this._chunkError=function(){this._sendError(t.error)}}function h(e){var t;u.call(this,e=e||{}),this.stream=function(e){return t=e,this._nextChunk()},this._nextChunk=function(){if(!this._finished){var e,r=this._config.chunkSize;return r?(e=t.substring(0,r),t=t.substring(r)):(e=t,t=""),this._finished=!t,this.parseChunk(e)}}}function f(e){u.call(this,e=e||{});var t=[],r=!0,n=!1;this.pause=function(){u.prototype.pause.apply(this,arguments),this._input.pause()},this.resume=function(){u.prototype.resume.apply(this,arguments),this._input.resume()},this.stream=function(e){this._input=e,this._input.on("data",this._streamData),this._input.on("end",this._streamEnd),this._input.on("error",this._streamError)},this._checkIsFinished=function(){n&&1===t.length&&(this._finished=!0)},this._nextChunk=function(){this._checkIsFinished(),t.length?this.parseChunk(t.shift()):r=!0},this._streamData=y((function(e){try{t.push("string"==typeof e?e:e.toString(this._config.encoding)),r&&(r=!1,this._checkIsFinished(),this.parseChunk(t.shift()))}catch(e){this._streamError(e)}}),this),this._streamError=y((function(e){this._streamCleanUp(),this._sendError(e)}),this),this._streamEnd=y((function(){this._streamCleanUp(),n=!0,this._streamData("")}),this),this._streamCleanUp=y((function(){this._input.removeListener("data",this._streamData),this._input.removeListener("end",this._streamEnd),this._input.removeListener("error",this._streamError)}),this)}function d(e){var t,r,n,i=Math.pow(2,53),a=-i,o=/^\s*-?(\d+\.?|\.\d+|\d+\.\d+)([eE][-+]?\d+)?\s*$/,u=/^(\d{4}-[01]\d-[0-3]\dT[0-2]\d:[0-5]\d:[0-5]\d\.\d+([+-][0-2]\d:[0-5]\d|Z))|(\d{4}-[01]\d-[0-3]\dT[0-2]\d:[0-5]\d:[0-5]\d([+-][0-2]\d:[0-5]\d|Z))|(\d{4}-[01]\d-[0-3]\dT[0-2]\d:[0-5]\d([+-][0-2]\d:[0-5]\d|Z))$/,l=this,c=0,h=0,f=!1,d=!1,p=[],w={data:[],errors:[],meta:{}};if(Z(e.step)){var g=e.step;e.step=function(t){if(w=t,k())_();else{if(_(),0===w.data.length)return;c+=t.data.length,e.preview&&c>e.preview?r.abort():(w.data=w.data[0],g(w,l))}}}function y(t){return"greedy"===e.skipEmptyLines?""===t.join("").trim():1===t.length&&0===t[0].length}function _(){return w&&n&&(x("Delimiter","UndetectableDelimiter","Unable to auto-detect delimiting character; defaulted to '"+s.DefaultDelimiter+"'"),n=!1),e.skipEmptyLines&&(w.data=w.data.filter((function(e){return!y(e)}))),k()&&function(){if(w)if(Array.isArray(w.data[0])){for(var t=0;k()&&t<w.data.length;t++)w.data[t].forEach(r);w.data.splice(0,1)}else w.data.forEach(r);function r(t,r){Z(e.transformHeader)&&(t=e.transformHeader(t,r)),p.push(t)}}(),function(){if(!w||!e.header&&!e.dynamicTyping&&!e.transform)return w;function t(t,r){var n,i=e.header?{}:[];for(n=0;n<t.length;n++){var a=n,s=t[n];e.header&&(a=n>=p.length?"__parsed_extra":p[n]),e.transform&&(s=e.transform(s,a)),s=A(a,s),"__parsed_extra"===a?(i[a]=i[a]||[],i[a].push(s)):i[a]=s}return e.header&&(n>p.length?x("FieldMismatch","TooManyFields","Too many fields: expected "+p.length+" fields but parsed "+n,h+r):n<p.length&&x("FieldMismatch","TooFewFields","Too few fields: expected "+p.length+" fields but parsed "+n,h+r)),i}var r=1;return!w.data.length||Array.isArray(w.data[0])?(w.data=w.data.map(t),r=w.data.length):w.data=t(w.data,0),e.header&&w.meta&&(w.meta.fields=p),h+=r,w}()}function k(){return e.header&&0===p.length}function A(t,r){return n=t,e.dynamicTypingFunction&&void 0===e.dynamicTyping[n]&&(e.dynamicTyping[n]=e.dynamicTypingFunction(n)),!0===(e.dynamicTyping[n]||e.dynamicTyping)?"true"===r||"TRUE"===r||"false"!==r&&"FALSE"!==r&&(function(e){if(o.test(e)){var t=parseFloat(e);if(a<t&&t<i)return!0}return!1}(r)?parseFloat(r):u.test(r)?new Date(r):""===r?null:r):r;var n}function x(e,t,r,n){var i={type:e,code:t,message:r};void 0!==n&&(i.row=n),w.errors.push(i)}this.parse=function(i,a,o){var u=e.quoteChar||'"';if(e.newline||(e.newline=function(e,t){e=e.substring(0,1048576);var r=new RegExp(v(t)+"([^]*?)"+v(t),"gm"),n=(e=e.replace(r,"")).split("\r"),i=e.split("\n"),a=1<i.length&&i[0].length<n[0].length;if(1===n.length||a)return"\n";for(var s=0,o=0;o<n.length;o++)"\n"===n[o][0]&&s++;return s>=n.length/2?"\r\n":"\r"}(i,u)),n=!1,e.delimiter)Z(e.delimiter)&&(e.delimiter=e.delimiter(i),w.meta.delimiter=e.delimiter);else{var l=function(t,r,n,i,a){var o,u,l,c;a=a||[",","\t","|",";",s.RECORD_SEP,s.UNIT_SEP];for(var h=0;h<a.length;h++){var f=a[h],d=0,v=0,p=0;l=void 0;for(var w=new m({comments:i,delimiter:f,newline:r,preview:10}).parse(t),g=0;g<w.data.length;g++)if(n&&y(w.data[g]))p++;else{var b=w.data[g].length;v+=b,void 0!==l?0<b&&(d+=Math.abs(b-l),l=b):l=b}0<w.data.length&&(v/=w.data.length-p),(void 0===u||d<=u)&&(void 0===c||c<v)&&1.99<v&&(u=d,o=f,c=v)}return{successful:!!(e.delimiter=o),bestDelimiter:o}}(i,e.newline,e.skipEmptyLines,e.comments,e.delimitersToGuess);l.successful?e.delimiter=l.bestDelimiter:(n=!0,e.delimiter=s.DefaultDelimiter),w.meta.delimiter=e.delimiter}var c=b(e);return e.preview&&e.header&&c.preview++,t=i,r=new m(c),w=r.parse(t,a,o),_(),f?{meta:{paused:!0}}:w||{meta:{paused:!1}}},this.paused=function(){return f},this.pause=function(){f=!0,r.abort(),t=Z(e.chunk)?"":t.substring(r.getCharIndex())},this.resume=function(){l.streamer._halted?(f=!1,l.streamer.parseChunk(t,!0)):setTimeout(l.resume,3)},this.aborted=function(){return d},this.abort=function(){d=!0,r.abort(),w.meta.aborted=!0,Z(e.complete)&&e.complete(w),t=""}}function v(e){return e.replace(/[.*+?^${}()|[\]\\]/g,"\\$&")}function m(e){var t,r=(e=e||{}).delimiter,n=e.newline,i=e.comments,a=e.step,o=e.preview,u=e.fastMode,l=t=void 0===e.quoteChar||null===e.quoteChar?'"':e.quoteChar;if(void 0!==e.escapeChar&&(l=e.escapeChar),("string"!=typeof r||-1<s.BAD_DELIMITERS.indexOf(r))&&(r=","),i===r)throw new Error("Comment character same as delimiter");!0===i?i="#":("string"!=typeof i||-1<s.BAD_DELIMITERS.indexOf(i))&&(i=!1),"\n"!==n&&"\r"!==n&&"\r\n"!==n&&(n="\n");var c=0,h=!1;this.parse=function(e,s,f){if("string"!=typeof e)throw new Error("Input must be a string");var d=e.length,m=r.length,p=n.length,w=i.length,g=Z(a),b=[],y=[],_=[],k=c=0;if(!e)return z();if(u||!1!==u&&-1===e.indexOf(t)){for(var A=e.split(n),x=0;x<A.length;x++){if(_=A[x],c+=_.length,x!==A.length-1)c+=n.length;else if(f)return z();if(!i||_.substring(0,w)!==i){if(g){if(b=[],N(_.split(r)),B(),h)return z()}else N(_.split(r));if(o&&o<=x)return b=b.slice(0,o),z(!0)}}return z()}for(var E=e.indexOf(r,c),S=e.indexOf(n,c),O=new RegExp(v(l)+v(t),"g"),I=e.indexOf(t,c);;)if(e[c]!==t)if(i&&0===_.length&&e.substring(c,c+w)===i){if(-1===S)return z();c=S+p,S=e.indexOf(n,c),E=e.indexOf(r,c)}else if(-1!==E&&(E<S||-1===S))_.push(e.substring(c,E)),c=E+m,E=e.indexOf(r,c);else{if(-1===S)break;if(_.push(e.substring(c,S)),D(S+p),g&&(B(),h))return z();if(o&&b.length>=o)return z(!0)}else for(I=c,c++;;){if(-1===(I=e.indexOf(t,I+1)))return f||y.push({type:"Quotes",code:"MissingQuotes",message:"Quoted field unterminated",row:b.length,index:c}),F();if(I===d-1)return F(e.substring(c,I).replace(O,t));if(t!==l||e[I+1]!==l){if(t===l||0===I||e[I-1]!==l){-1!==E&&E<I+1&&(E=e.indexOf(r,I+1)),-1!==S&&S<I+1&&(S=e.indexOf(n,I+1));var C=M(-1===S?E:Math.min(E,S));if(e.substr(I+1+C,m)===r){_.push(e.substring(c,I).replace(O,t)),e[c=I+1+C+m]!==t&&(I=e.indexOf(t,c)),E=e.indexOf(r,c),S=e.indexOf(n,c);break}var R=M(S);if(e.substring(I+1+R,I+1+R+p)===n){if(_.push(e.substring(c,I).replace(O,t)),D(I+1+R+p),E=e.indexOf(r,c),I=e.indexOf(t,c),g&&(B(),h))return z();if(o&&b.length>=o)return z(!0);break}y.push({type:"Quotes",code:"InvalidQuotes",message:"Trailing quote on quoted field is malformed",row:b.length,index:c}),I++}}else I++}return F();function N(e){b.push(e),k=c}function M(t){var r=0;if(-1!==t){var n=e.substring(I+1,t);n&&""===n.trim()&&(r=n.length)}return r}function F(t){return f||(void 0===t&&(t=e.substring(c)),_.push(t),c=d,N(_),g&&B()),z()}function D(t){c=t,N(_),_=[],S=e.indexOf(n,c)}function z(e){return{data:b,errors:y,meta:{delimiter:r,linebreak:n,aborted:h,truncated:!!e,cursor:k+(s||0)}}}function B(){a(z()),b=[],y=[]}},this.abort=function(){h=!0},this.getCharIndex=function(){return c}}function p(e){var t=e.data,r=i[t.workerId],n=!1;if(t.error)r.userError(t.error,t.file);else if(t.results&&t.results.data){var a={abort:function(){n=!0,w(t.workerId,{data:[],errors:[],meta:{aborted:!0}})},pause:g,resume:g};if(Z(r.userStep)){for(var s=0;s<t.results.data.length&&(r.userStep({data:t.results.data[s],errors:t.results.errors,meta:t.results.meta},a),!n);s++);delete t.results}else Z(r.userChunk)&&(r.userChunk(t.results,a,t.file),delete t.results)}t.finished&&!n&&w(t.workerId,t.results)}function w(e,t){var r=i[e];Z(r.userComplete)&&r.userComplete(t),r.terminate(),delete i[e]}function g(){throw new Error("Not implemented.")}function b(e){if("object"!=typeof e||null===e)return e;var t=Array.isArray(e)?[]:{};for(var r in e)t[r]=b(e[r]);return t}function y(e,t){return function(){e.apply(t,arguments)}}function Z(e){return"function"==typeof e}return n&&(t.onmessage=function(e){var r=e.data;if(void 0===s.WORKER_ID&&r&&(s.WORKER_ID=r.workerId),"string"==typeof r.input)t.postMessage({workerId:s.WORKER_ID,results:s.parse(r.input,r.config),finished:!0});else if(t.File&&r.input instanceof File||r.input instanceof Object){var n=s.parse(r.input,r.config);n&&t.postMessage({workerId:s.WORKER_ID,results:n,finished:!0})}}),(l.prototype=Object.create(u.prototype)).constructor=l,(c.prototype=Object.create(u.prototype)).constructor=c,(h.prototype=Object.create(h.prototype)).constructor=h,(f.prototype=Object.create(u.prototype)).constructor=f,s},void 0===(i="function"===typeof r?r.apply(t,n):r)||(e.exports=i)},907:function(e,t,r){"use strict";function n(e,t){(null==t||t>e.length)&&(t=e.length);for(var r=0,n=new Array(t);r<t;r++)n[r]=e[r];return n}r.d(t,{Z:function(){return n}})},3878:function(e,t,r){"use strict";function n(e){if(Array.isArray(e))return e}r.d(t,{Z:function(){return n}})},3889:function(e,t,r){"use strict";function n(e,t,r){if(!t.has(e))throw new TypeError("attempted to get private field on non-instance");return r}r.d(t,{Z:function(){return n}})},101:function(e,t,r){"use strict";r.d(t,{Z:function(){return i}});var n=r(864);function i(e,t){(0,n.Z)(e,t),t.add(e)}},3112:function(e,t,r){"use strict";function n(e,t,r){return function(e,t){if(e!==t)throw new TypeError("Private static access of wrong provenance")}(e,t),r}r.d(t,{Z:function(){return n}})},7762:function(e,t,r){"use strict";r.d(t,{Z:function(){return i}});var n=r(181);function i(e,t){var r="undefined"!==typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(!r){if(Array.isArray(e)||(r=(0,n.Z)(e))||t&&e&&"number"===typeof e.length){r&&(e=r);var i=0,a=function(){};return{s:a,n:function(){return i>=e.length?{done:!0}:{done:!1,value:e[i++]}},e:function(e){throw e},f:a}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var s,o=!0,u=!1;return{s:function(){r=r.call(e)},n:function(){var e=r.next();return o=e.done,e},e:function(e){u=!0,s=e},f:function(){try{o||null==r.return||r.return()}finally{if(u)throw s}}}}},1902:function(e,t,r){"use strict";function n(e,t){var r=null==e?null:"undefined"!==typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(null!=r){var n,i,a=[],s=!0,o=!1;try{for(r=r.call(e);!(s=(n=r.next()).done)&&(a.push(n.value),!t||a.length!==t);s=!0);}catch(u){o=!0,i=u}finally{try{s||null==r.return||r.return()}finally{if(o)throw i}}return a}}r.d(t,{Z:function(){return n}})},5267:function(e,t,r){"use strict";function n(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}r.d(t,{Z:function(){return n}})},1413:function(e,t,r){"use strict";r.d(t,{Z:function(){return a}});var n=r(4942);function i(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),r.push.apply(r,n)}return r}function a(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{};t%2?i(Object(r),!0).forEach((function(t){(0,n.Z)(e,t,r[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):i(Object(r)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(r,t))}))}return e}},3324:function(e,t,r){"use strict";r.d(t,{Z:function(){return o}});var n=r(3878),i=r(1902),a=r(181),s=r(5267);function o(e,t){return(0,n.Z)(e)||(0,i.Z)(e,t)||(0,a.Z)(e,t)||(0,s.Z)()}},181:function(e,t,r){"use strict";r.d(t,{Z:function(){return i}});var n=r(907);function i(e,t){if(e){if("string"===typeof e)return(0,n.Z)(e,t);var r=Object.prototype.toString.call(e).slice(8,-1);return"Object"===r&&e.constructor&&(r=e.constructor.name),"Map"===r||"Set"===r?Array.from(e):"Arguments"===r||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r)?(0,n.Z)(e,t):void 0}}},4214:function(e,t,r){"use strict";r.d(t,{M:function(){return z},n:function(){return b}});var n=r(7762),i=r(5861),a=r(5671),s=r(3144),o=r(101),u=r(2346),l=r(3889),c=r(6033),h=r(3092),f=r(3324),d=r(7757),v=r(4660),m=r(7806),p=r(815),w=r(395),g=function(){var e=(0,i.Z)(d.mark((function e(t){var r;return d.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,fetch(t);case 2:if((r=e.sent).ok){e.next=5;break}throw new Error("failed to fetch content at "+t+"("+r.status+")");case 5:return e.t0=Uint8Array,e.next=8,r.arrayBuffer();case 8:return e.t1=e.sent,e.abrupt("return",new e.t0(e.t1));case 10:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}();function b(e){var t=g;return g=e,t}function y(e){var t={};return t[""]=e,t}function Z(e,t){return t?m.bl(e):e}var _="https://experimenthub.bioconductor.org/fetch",k={"zeisel-brain":{counts:"2596",coldata:"2598",rowdata:"2597"},"segerstolpe-pancreas":{counts:"2591",coldata:"2593",rowdata:"2592"},"nestorowa-hsc":{counts:"2710",ncol:1920},"aztekin-tail":{counts:"3124",coldata:"3125"},"wu-kidney":{counts:"3594",coldata:"3595"},"zilionis-mouse-lung":{counts:"3478",coldata:"3479"}};function A(e,t,r){if(!(e instanceof v.RdsS4Object))throw new Error("expected an S4 object");for(var n=0,i=Object.entries(t);n<i.length;n++){var a=(0,f.Z)(i[n],2),s=a[0],o=a[1];if(e.className()==s&&e.packageName()==o)return}throw new Error("object is not a "+r+" or one of its recognized subclasses")}function x(e,t){var r=function(e){var t,r,n=e.findAttribute("names");if(n<0)return null;try{r=(t=e.attribute(n)).values()}catch(i){throw new Error("failed to load listData names; "+i.message)}finally{v.free(t)}if(r.length!=e.length())throw new Error("expected names to have same length as listData");return r}(e);if(null==r)throw new Error("expected the listData list to be named");for(var n={},i=0;i<e.length();i++){var a=void 0;try{if((a=e.load(i))instanceof v.RdsVector&&!(a instanceof v.RdsGenericVector)){var s=a.values();n[r[i]]=s,t.nrow=s.length}}finally{v.free(a)}}t.columns=n}function E(e){var t,r,n={};if("S4"==e.type()){var i;A(e,{DFrame:"S4Vectors",DataFrame:"S4Vectors"},"DFrame");try{if(!((i=e.attribute("listData"))instanceof v.RdsGenericVector))throw new Error("listData slot should be a generic list");x(i,n)}catch(o){throw new Error("failed to retrieve data from DataFrame's listData; "+o.message)}finally{v.free(i)}}else{if("vector"!=e.type())throw new Error("expected a data.frame or DataFrame instance");x(e,n)}try{var a=e.findAttribute("rownames");a>=0&&(t=e.attribute(a))instanceof v.RdsStringVector&&(n.row_names=t.values(),n.nrow=n.row_names.length)}catch(o){throw new Error("failed to retrieve row names from DataFrame; "+o.message)}finally{v.free(t)}if(!("nrow"in n))try{if(!((r=e.attribute("nrows"))instanceof v.RdsIntegerVector))throw new Error("expected an integer vector as the 'nrows' slot");var s=r.values();if(1!=s.length)throw new Error("expected an integer vector of length 1 as the 'nrows' slot");n.nrow=s[0]}catch(o){throw new Error("failed to retrieve nrows from DataFrame; "+o.message)}finally{v.free(r)}return n}function S(e){var t,r,n,i;if("S4"==e.type()?(A(e,{dgCMatrix:"Matrix",dgTMatrix:"Matrix"},"Matrix"),t=e.findAttribute("Dimnames")):t=e.findAttribute("dimnames"),t<0)throw new Error("count matrix does not have dimnames");try{if("vector"!=(r=e.attribute(t)).type()&&2!=r.size())throw new Error("dimnames of the count matrix should be a list of length 2");if("string"!=(n=r.load(0)).type())throw new Error("expected a character vector in the first dimnames");i=n.values()}finally{v.free(r),v.free(n)}return i}var O=new WeakMap,I=new WeakMap,C=new WeakMap,R=new WeakMap,N=new WeakMap,M=new WeakSet,F=new WeakSet,D=new WeakSet,z=function(){function e(t){if((0,a.Z)(this,e),(0,o.Z)(this,D),(0,o.Z)(this,F),(0,o.Z)(this,M),(0,u.Z)(this,O,{writable:!0,value:void 0}),(0,u.Z)(this,I,{writable:!0,value:void 0}),(0,u.Z)(this,C,{writable:!0,value:void 0}),(0,u.Z)(this,R,{writable:!0,value:void 0}),(0,u.Z)(this,N,{writable:!0,value:void 0}),(0,h.Z)(this,O,t),!((0,c.Z)(this,O)in k))throw new Error("unrecognized identifier '"+(0,c.Z)(this,O)+"' for ExperimentHub-based datasets");this.clear()}return(0,s.Z)(e,[{key:"clear",value:function(){v.free((0,c.Z)(this,R)),v.free((0,c.Z)(this,N)),(0,h.Z)(this,R,null),(0,h.Z)(this,N,null),(0,h.Z)(this,I,null),(0,h.Z)(this,C,null)}},{key:"abbreviate",value:function(){return{id:(0,c.Z)(this,O)}}},{key:"annotations",value:function(){var e=(0,i.Z)(d.mark((function e(){var t,r,i,a,s,o,u,h,f,v,m=arguments;return d.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return t=m.length>0&&void 0!==m[0]?m[0]:{},r=t.cache,i=void 0!==r&&r,e.next=3,(0,l.Z)(this,F,G).call(this);case 3:return e.next=5,(0,l.Z)(this,D,T).call(this);case 5:a={},s=(0,n.Z)((0,c.Z)(this,C).columnNames());try{for(s.s();!(o=s.n()).done;)u=o.value,h=(0,c.Z)(this,C).column(u),a[u]=w.Qr(h)}catch(d){s.e(d)}finally{s.f()}return f=Z((0,c.Z)(this,I),i),v={features:y(f),cells:{number:(0,c.Z)(this,C).numberOfRows(),summary:a}},i||this.clear(),e.abrupt("return",v);case 12:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}()},{key:"load",value:function(){var e=(0,i.Z)(d.mark((function e(){var t,r,n,i,a,s,o=arguments;return d.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return t=o.length>0&&void 0!==o[0]?o[0]:{},r=t.cache,n=void 0!==r&&r,e.next=3,(0,l.Z)(this,F,G).call(this);case 3:return e.next=5,(0,l.Z)(this,D,T).call(this);case 5:return e.next=7,(0,l.Z)(this,M,B).call(this);case 7:i={cells:Z((0,c.Z)(this,C),n)},k[(0,c.Z)(this,O)],e.prev=9,i.matrix=new v.MultiMatrix,a=v.initializeSparseMatrixFromRds((0,c.Z)(this,R),{consume:!n}),i.matrix.add("",a.matrix),i.row_ids=y(a.row_ids),s=m.Nd((0,c.Z)(this,I),a.row_ids),i.features=y(s),e.next=22;break;case 18:throw e.prev=18,e.t0=e.catch(9),v.free(i.matrix),e.t0;case 22:return n||this.clear(),e.abrupt("return",i);case 24:case"end":return e.stop()}}),e,this,[[9,18]])})));return function(){return e.apply(this,arguments)}}()},{key:"serialize",value:function(){var e=(new TextEncoder).encode((0,c.Z)(this,O));return[{type:"id",file:new w.zD(e,{name:"id"})}]}}],[{key:"availableDatasets",value:function(){return Object.keys(k)}},{key:"format",value:function(){return"ExperimentHub"}},{key:"unserialize",value:function(t){var r,i={},a=(0,n.Z)(t);try{for(a.s();!(r=a.n()).done;){var s=r.value,o=new TextDecoder;i[s.type]=o.decode(s.file.buffer())}}catch(u){a.e(u)}finally{a.f()}if(!("id"in i))throw new Error("expected a file of type 'id' when unserializing ExperimentHub dataset");return new e(i.id)}}]),e}();function B(){return W.apply(this,arguments)}function W(){return(W=(0,i.Z)(d.mark((function e(){var t,r;return d.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(null===(0,c.Z)(this,R)){e.next=2;break}return e.abrupt("return");case 2:return t=k[(0,c.Z)(this,O)],e.next=5,g(_+"/"+t.counts);case 5:r=e.sent,e.prev=6,(0,h.Z)(this,N,v.readRds(r)),(0,h.Z)(this,R,(0,c.Z)(this,N).value()),e.next=16;break;case 11:throw e.prev=11,e.t0=e.catch(6),v.free((0,c.Z)(this,R)),v.free((0,c.Z)(this,N)),e.t0;case 16:case"end":return e.stop()}}),e,this,[[6,11]])})))).apply(this,arguments)}function G(){return j.apply(this,arguments)}function j(){return(j=(0,i.Z)(d.mark((function e(){var t,r,n,i,a,s,o,u,m,w,b,y,Z;return d.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(null===(0,c.Z)(this,I)){e.next=2;break}return e.abrupt("return");case 2:if(!("rowdata"in(t=k[(0,c.Z)(this,O)]))){e.next=23;break}return e.next=6,g(_+"/"+t.rowdata);case 6:for(r=e.sent,e.prev=7,n=v.readRds(r),i=n.value(),a=E(i),s=a.row_names,o={},s&&(o.id=s),u=0,m=Object.entries(a.columns);u<m.length;u++)w=(0,f.Z)(m[u],2),b=w[0],y=w[1],b.match(/^sym/)&&(o[b]=y);if(0!=Object.keys(o).length){e.next=17;break}throw new Error("no acceptable feature identifiers found in the rowData DataFrame");case 17:(0,h.Z)(this,I,new p.N(o));case 18:return e.prev=18,v.free(i),v.free(n),e.finish(18);case 22:return e.abrupt("return");case 23:return e.next=25,(0,l.Z)(this,M,B).call(this);case 25:Z=S((0,c.Z)(this,R)),(0,h.Z)(this,I,new p.N({id:Z}));case 27:case"end":return e.stop()}}),e,this,[[7,,18,22]])})))).apply(this,arguments)}function T(){return Q.apply(this,arguments)}function Q(){return(Q=(0,i.Z)(d.mark((function e(){var t,r,n,i,a;return d.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(null===(0,c.Z)(this,C)){e.next=2;break}return e.abrupt("return");case 2:if(!("coldata"in(t=k[(0,c.Z)(this,O)]))){e.next=11;break}return e.next=6,g(_+"/"+t.coldata);case 6:r=e.sent;try{n=v.readRds(r),i=n.value(),a=E(i)}finally{v.free(i),v.free(n)}(0,h.Z)(this,C,new p.N(a.columns,{numberOfRows:a.nrow})),e.next=12;break;case 11:(0,h.Z)(this,C,new p.N({},{numberOfRows:t.ncol}));case 12:return e.abrupt("return");case 13:case"end":return e.stop()}}),e,this)})))).apply(this,arguments)}},395:function(e,t,r){"use strict";r.d(t,{Fl:function(){return _n},zD:function(){return M},H$:function(){return ai},By:function(){return nn},en:function(){return Bn},Q7:function(){return Ho},cO:function(){return li},ZD:function(){return Jl},bN:function(){return $o},TD:function(){return Jo},TN:function(){return Sl},pY:function(){return Pl},Sl:function(){return Cl},Ol:function(){return eu},us:function(){return Ko},j2:function(){return Yl},MM:function(){return Dl},ve:function(){return Ll},G8:function(){return Bl},x6:function(){return Rl},cN:function(){return Ml},v9:function(){return sl},rF:function(){return Ti},ED:function(){return Qi},$p:function(){return au},Qr:function(){return Fr},gj:function(){return Vl}});var n=r(7762),i=r(907);var a=r(181);function s(e){return function(e){if(Array.isArray(e))return(0,i.Z)(e)}(e)||function(e){if("undefined"!==typeof Symbol&&null!=e[Symbol.iterator]||null!=e["@@iterator"])return Array.from(e)}(e)||(0,a.Z)(e)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}var o=r(3324),u=r(5861),l=r(1413),c=r(5671),h=r(3144),f=r(101),d=r(2346),v=r(3889),m=r(3112),p=r(6033),w=r(3092),g=r(7757),b=r(4660),y=r(7806),Z=r(815);function _(e,t){if("className"in e.constructor&&e.constructor.className.endsWith("WasmArray"))return"view"==t||"hdf5"==t?e.view():t?e.slice():e.array();if(!0===t)return e.slice();if("view"==t)throw new Error("'copy: \"view\"' not supported for mimics");return e}function k(e){b.safeFree(e)}function A(e,t,r,n){if(!r&&(e instanceof ArrayBuffer||ArrayBuffer.isView(e)))throw new Error("parameters cannot contain ArrayBuffers or their views");if(!n&&(t instanceof ArrayBuffer||ArrayBuffer.isView(t)))throw new Error("parameters cannot contain ArrayBuffers or their views")}function x(e,t){if(typeof e!=typeof t)return A(e,t,!1,!1),!0;if("object"!=typeof e)return e!=t;var r=null===e,n=null===t;if(r!==n)return A(e,t,r,n),!0;if(r)return!1;var i=e instanceof Array,a=t instanceof Array;if(i!=a)return A(e,t,i,a),!0;if(i){if(e.length!=t.length)return!0;for(var s=0;s<e.length;s++)if(x(e[s],t[s]))return!0;return!1}A(e,t,!1,!1);var o=Object.keys(e),u=Object.keys(t);if(o.length!=u.length)return!0;o.sort(),u.sort();for(s=0;s<o.length;s++)if(o[s]!=u[s])return!0;for(var l=0,c=o;l<c.length;l++){var h=c[l];if(x(e[h],t[h]))return!0}return!1}function E(e,t,r){var n=arguments.length>3&&void 0!==arguments[3]?arguments[3]:"buffer",i=!0;if(n in r){var a=r[n];a.size!=e||a.constructor.className!=t||null!==a.owner?a.free():i=!1}if(i)switch(t){case"Uint8Array":r[n]=b.createUint8WasmArray(e);break;case"Int32Array":r[n]=b.createInt32WasmArray(e);break;case"Float64Array":r[n]=b.createFloat64WasmArray(e);break;default:throw"allocating '"+t+"' not yet supported"}return r[n]}function S(e,t){for(var r=[],n=0,i=Object.entries(e);n<i.length;n++){var a=(0,o.Z)(i[n],2),s=a[0];a[1].valid()&&r.push(s)}if(0==r.length)throw new Error("expected at least one valid upstream "+t+" state");return r}function O(e,t){if(null!==t){var r,i=(0,n.Z)(e);try{for(i.s();!(r=i.n()).done;){var a=r.value;if(a<0||a>=t)throw new Error("subset indices are out of range")}}catch(Ke){i.e(Ke)}finally{i.f()}}for(var s=1;s<e.length;s++)if(e[s]<=e[s-1])throw new Error("subset indices must be sorted and unique")}var I=new WeakMap,C=new WeakMap,R=new WeakMap,N=new WeakMap,M=function(){function e(t){var r=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},n=r.name,i=void 0===n?null:n;if((0,c.Z)(this,e),(0,d.Z)(this,I,{writable:!0,value:void 0}),(0,d.Z)(this,C,{writable:!0,value:void 0}),(0,d.Z)(this,R,{writable:!0,value:void 0}),(0,d.Z)(this,N,{writable:!0,value:void 0}),t instanceof File)(0,w.Z)(this,I,"file"),(0,w.Z)(this,R,t),null===i&&(i=t.name),(0,w.Z)(this,N,i);else{if(!(t instanceof Uint8Array))throw new Error("unknown type '"+typeof t+"' for SimpleFile constructor");if((0,w.Z)(this,I,"buffer"),(0,w.Z)(this,C,t),null===i)throw new Error("'name' must be provided for Uint8Array inputs in SimpleFile constructor");(0,w.Z)(this,N,i)}}return(0,h.Z)(e,[{key:"buffer",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t=e.copy,r=void 0!==t&&t;if("file"==(0,p.Z)(this,I)){var n=new FileReaderSync,i=n.readAsArrayBuffer((0,p.Z)(this,R));return new Uint8Array(i)}return r?(0,p.Z)(this,C).slice():(0,p.Z)(this,C)}},{key:"size",value:function(){return"file"==(0,p.Z)(this,I)?(0,p.Z)(this,R).size:(0,p.Z)(this,C).length}},{key:"name",value:function(){return(0,p.Z)(this,N)}},{key:"content",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t=e.copy,r=void 0!==t&&t;return this.buffer({copy:r})}}]),e}();function F(e){for(var t=e.length;--t>=0;)e[t]=0}var D=256,z=286,B=30,W=15,G=new Uint8Array([0,0,0,0,0,0,0,0,1,1,1,1,2,2,2,2,3,3,3,3,4,4,4,4,5,5,5,5,0]),j=new Uint8Array([0,0,0,0,1,1,2,2,3,3,4,4,5,5,6,6,7,7,8,8,9,9,10,10,11,11,12,12,13,13]),T=new Uint8Array([0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,2,3,7]),Q=new Uint8Array([16,17,18,0,8,7,9,6,10,5,11,4,12,3,13,2,14,1,15]),U=new Array(576);F(U);var q=new Array(60);F(q);var P=new Array(512);F(P);var L=new Array(256);F(L);var V=new Array(29);F(V);var H,Y,J,K=new Array(B);function X(e,t,r,n,i){this.static_tree=e,this.extra_bits=t,this.extra_base=r,this.elems=n,this.max_length=i,this.has_stree=e&&e.length}function $(e,t){this.dyn_tree=e,this.max_code=0,this.stat_desc=t}F(K);var ee=function(e){return e<256?P[e]:P[256+(e>>>7)]},te=function(e,t){e.pending_buf[e.pending++]=255&t,e.pending_buf[e.pending++]=t>>>8&255},re=function(e,t,r){e.bi_valid>16-r?(e.bi_buf|=t<<e.bi_valid&65535,te(e,e.bi_buf),e.bi_buf=t>>16-e.bi_valid,e.bi_valid+=r-16):(e.bi_buf|=t<<e.bi_valid&65535,e.bi_valid+=r)},ne=function(e,t,r){re(e,r[2*t],r[2*t+1])},ie=function(e,t){var r=0;do{r|=1&e,e>>>=1,r<<=1}while(--t>0);return r>>>1},ae=function(e,t,r){var n,i,a=new Array(16),s=0;for(n=1;n<=W;n++)a[n]=s=s+r[n-1]<<1;for(i=0;i<=t;i++){var o=e[2*i+1];0!==o&&(e[2*i]=ie(a[o]++,o))}},se=function(e){var t;for(t=0;t<z;t++)e.dyn_ltree[2*t]=0;for(t=0;t<B;t++)e.dyn_dtree[2*t]=0;for(t=0;t<19;t++)e.bl_tree[2*t]=0;e.dyn_ltree[512]=1,e.opt_len=e.static_len=0,e.last_lit=e.matches=0},oe=function(e){e.bi_valid>8?te(e,e.bi_buf):e.bi_valid>0&&(e.pending_buf[e.pending++]=e.bi_buf),e.bi_buf=0,e.bi_valid=0},ue=function(e,t,r,n){var i=2*t,a=2*r;return e[i]<e[a]||e[i]===e[a]&&n[t]<=n[r]},le=function(e,t,r){for(var n=e.heap[r],i=r<<1;i<=e.heap_len&&(i<e.heap_len&&ue(t,e.heap[i+1],e.heap[i],e.depth)&&i++,!ue(t,n,e.heap[i],e.depth));)e.heap[r]=e.heap[i],r=i,i<<=1;e.heap[r]=n},ce=function(e,t,r){var n,i,a,s,o=0;if(0!==e.last_lit)do{n=e.pending_buf[e.d_buf+2*o]<<8|e.pending_buf[e.d_buf+2*o+1],i=e.pending_buf[e.l_buf+o],o++,0===n?ne(e,i,t):(a=L[i],ne(e,a+D+1,t),0!==(s=G[a])&&(i-=V[a],re(e,i,s)),n--,a=ee(n),ne(e,a,r),0!==(s=j[a])&&(n-=K[a],re(e,n,s)))}while(o<e.last_lit);ne(e,256,t)},he=function(e,t){var r,n,i,a=t.dyn_tree,s=t.stat_desc.static_tree,o=t.stat_desc.has_stree,u=t.stat_desc.elems,l=-1;for(e.heap_len=0,e.heap_max=573,r=0;r<u;r++)0!==a[2*r]?(e.heap[++e.heap_len]=l=r,e.depth[r]=0):a[2*r+1]=0;for(;e.heap_len<2;)a[2*(i=e.heap[++e.heap_len]=l<2?++l:0)]=1,e.depth[i]=0,e.opt_len--,o&&(e.static_len-=s[2*i+1]);for(t.max_code=l,r=e.heap_len>>1;r>=1;r--)le(e,a,r);i=u;do{r=e.heap[1],e.heap[1]=e.heap[e.heap_len--],le(e,a,1),n=e.heap[1],e.heap[--e.heap_max]=r,e.heap[--e.heap_max]=n,a[2*i]=a[2*r]+a[2*n],e.depth[i]=(e.depth[r]>=e.depth[n]?e.depth[r]:e.depth[n])+1,a[2*r+1]=a[2*n+1]=i,e.heap[1]=i++,le(e,a,1)}while(e.heap_len>=2);e.heap[--e.heap_max]=e.heap[1],function(e,t){var r,n,i,a,s,o,u=t.dyn_tree,l=t.max_code,c=t.stat_desc.static_tree,h=t.stat_desc.has_stree,f=t.stat_desc.extra_bits,d=t.stat_desc.extra_base,v=t.stat_desc.max_length,m=0;for(a=0;a<=W;a++)e.bl_count[a]=0;for(u[2*e.heap[e.heap_max]+1]=0,r=e.heap_max+1;r<573;r++)(a=u[2*u[2*(n=e.heap[r])+1]+1]+1)>v&&(a=v,m++),u[2*n+1]=a,n>l||(e.bl_count[a]++,s=0,n>=d&&(s=f[n-d]),o=u[2*n],e.opt_len+=o*(a+s),h&&(e.static_len+=o*(c[2*n+1]+s)));if(0!==m){do{for(a=v-1;0===e.bl_count[a];)a--;e.bl_count[a]--,e.bl_count[a+1]+=2,e.bl_count[v]--,m-=2}while(m>0);for(a=v;0!==a;a--)for(n=e.bl_count[a];0!==n;)(i=e.heap[--r])>l||(u[2*i+1]!==a&&(e.opt_len+=(a-u[2*i+1])*u[2*i],u[2*i+1]=a),n--)}}(e,t),ae(a,l,e.bl_count)},fe=function(e,t,r){var n,i,a=-1,s=t[1],o=0,u=7,l=4;for(0===s&&(u=138,l=3),t[2*(r+1)+1]=65535,n=0;n<=r;n++)i=s,s=t[2*(n+1)+1],++o<u&&i===s||(o<l?e.bl_tree[2*i]+=o:0!==i?(i!==a&&e.bl_tree[2*i]++,e.bl_tree[32]++):o<=10?e.bl_tree[34]++:e.bl_tree[36]++,o=0,a=i,0===s?(u=138,l=3):i===s?(u=6,l=3):(u=7,l=4))},de=function(e,t,r){var n,i,a=-1,s=t[1],o=0,u=7,l=4;for(0===s&&(u=138,l=3),n=0;n<=r;n++)if(i=s,s=t[2*(n+1)+1],!(++o<u&&i===s)){if(o<l)do{ne(e,i,e.bl_tree)}while(0!==--o);else 0!==i?(i!==a&&(ne(e,i,e.bl_tree),o--),ne(e,16,e.bl_tree),re(e,o-3,2)):o<=10?(ne(e,17,e.bl_tree),re(e,o-3,3)):(ne(e,18,e.bl_tree),re(e,o-11,7));o=0,a=i,0===s?(u=138,l=3):i===s?(u=6,l=3):(u=7,l=4)}},ve=!1,me=function(e,t,r,n){re(e,0+(n?1:0),3),function(e,t,r,n){oe(e),n&&(te(e,r),te(e,~r)),e.pending_buf.set(e.window.subarray(t,t+r),e.pending),e.pending+=r}(e,t,r,!0)},pe=function(e,t,r,n){var i,a,s=0;e.level>0?(2===e.strm.data_type&&(e.strm.data_type=function(e){var t,r=4093624447;for(t=0;t<=31;t++,r>>>=1)if(1&r&&0!==e.dyn_ltree[2*t])return 0;if(0!==e.dyn_ltree[18]||0!==e.dyn_ltree[20]||0!==e.dyn_ltree[26])return 1;for(t=32;t<D;t++)if(0!==e.dyn_ltree[2*t])return 1;return 0}(e)),he(e,e.l_desc),he(e,e.d_desc),s=function(e){var t;for(fe(e,e.dyn_ltree,e.l_desc.max_code),fe(e,e.dyn_dtree,e.d_desc.max_code),he(e,e.bl_desc),t=18;t>=3&&0===e.bl_tree[2*Q[t]+1];t--);return e.opt_len+=3*(t+1)+5+5+4,t}(e),i=e.opt_len+3+7>>>3,(a=e.static_len+3+7>>>3)<=i&&(i=a)):i=a=r+5,r+4<=i&&-1!==t?me(e,t,r,n):4===e.strategy||a===i?(re(e,2+(n?1:0),3),ce(e,U,q)):(re(e,4+(n?1:0),3),function(e,t,r,n){var i;for(re(e,t-257,5),re(e,r-1,5),re(e,n-4,4),i=0;i<n;i++)re(e,e.bl_tree[2*Q[i]+1],3);de(e,e.dyn_ltree,t-1),de(e,e.dyn_dtree,r-1)}(e,e.l_desc.max_code+1,e.d_desc.max_code+1,s+1),ce(e,e.dyn_ltree,e.dyn_dtree)),se(e),n&&oe(e)},we={_tr_init:function(e){ve||(!function(){var e,t,r,n,i,a=new Array(16);for(r=0,n=0;n<28;n++)for(V[n]=r,e=0;e<1<<G[n];e++)L[r++]=n;for(L[r-1]=n,i=0,n=0;n<16;n++)for(K[n]=i,e=0;e<1<<j[n];e++)P[i++]=n;for(i>>=7;n<B;n++)for(K[n]=i<<7,e=0;e<1<<j[n]-7;e++)P[256+i++]=n;for(t=0;t<=W;t++)a[t]=0;for(e=0;e<=143;)U[2*e+1]=8,e++,a[8]++;for(;e<=255;)U[2*e+1]=9,e++,a[9]++;for(;e<=279;)U[2*e+1]=7,e++,a[7]++;for(;e<=287;)U[2*e+1]=8,e++,a[8]++;for(ae(U,287,a),e=0;e<B;e++)q[2*e+1]=5,q[2*e]=ie(e,5);H=new X(U,G,257,z,W),Y=new X(q,j,0,B,W),J=new X(new Array(0),T,0,19,7)}(),ve=!0),e.l_desc=new $(e.dyn_ltree,H),e.d_desc=new $(e.dyn_dtree,Y),e.bl_desc=new $(e.bl_tree,J),e.bi_buf=0,e.bi_valid=0,se(e)},_tr_stored_block:me,_tr_flush_block:pe,_tr_tally:function(e,t,r){return e.pending_buf[e.d_buf+2*e.last_lit]=t>>>8&255,e.pending_buf[e.d_buf+2*e.last_lit+1]=255&t,e.pending_buf[e.l_buf+e.last_lit]=255&r,e.last_lit++,0===t?e.dyn_ltree[2*r]++:(e.matches++,t--,e.dyn_ltree[2*(L[r]+D+1)]++,e.dyn_dtree[2*ee(t)]++),e.last_lit===e.lit_bufsize-1},_tr_align:function(e){re(e,2,3),ne(e,256,U),function(e){16===e.bi_valid?(te(e,e.bi_buf),e.bi_buf=0,e.bi_valid=0):e.bi_valid>=8&&(e.pending_buf[e.pending++]=255&e.bi_buf,e.bi_buf>>=8,e.bi_valid-=8)}(e)}},ge=function(e,t,r,n){for(var i=65535&e|0,a=e>>>16&65535|0,s=0;0!==r;){r-=s=r>2e3?2e3:r;do{a=a+(i=i+t[n++]|0)|0}while(--s);i%=65521,a%=65521}return i|a<<16|0},be=new Uint32Array(function(){for(var e,t=[],r=0;r<256;r++){e=r;for(var n=0;n<8;n++)e=1&e?3988292384^e>>>1:e>>>1;t[r]=e}return t}()),ye=function(e,t,r,n){var i=be,a=n+r;e^=-1;for(var s=n;s<a;s++)e=e>>>8^i[255&(e^t[s])];return-1^e},Ze={2:"need dictionary",1:"stream end",0:"","-1":"file error","-2":"stream error","-3":"data error","-4":"insufficient memory","-5":"buffer error","-6":"incompatible version"},_e={Z_NO_FLUSH:0,Z_PARTIAL_FLUSH:1,Z_SYNC_FLUSH:2,Z_FULL_FLUSH:3,Z_FINISH:4,Z_BLOCK:5,Z_TREES:6,Z_OK:0,Z_STREAM_END:1,Z_NEED_DICT:2,Z_ERRNO:-1,Z_STREAM_ERROR:-2,Z_DATA_ERROR:-3,Z_MEM_ERROR:-4,Z_BUF_ERROR:-5,Z_NO_COMPRESSION:0,Z_BEST_SPEED:1,Z_BEST_COMPRESSION:9,Z_DEFAULT_COMPRESSION:-1,Z_FILTERED:1,Z_HUFFMAN_ONLY:2,Z_RLE:3,Z_FIXED:4,Z_DEFAULT_STRATEGY:0,Z_BINARY:0,Z_TEXT:1,Z_UNKNOWN:2,Z_DEFLATED:8},ke=we._tr_init,Ae=we._tr_stored_block,xe=we._tr_flush_block,Ee=we._tr_tally,Se=we._tr_align,Oe=_e.Z_NO_FLUSH,Ie=_e.Z_PARTIAL_FLUSH,Ce=_e.Z_FULL_FLUSH,Re=_e.Z_FINISH,Ne=_e.Z_BLOCK,Me=_e.Z_OK,Fe=_e.Z_STREAM_END,De=_e.Z_STREAM_ERROR,ze=_e.Z_DATA_ERROR,Be=_e.Z_BUF_ERROR,We=_e.Z_DEFAULT_COMPRESSION,Ge=_e.Z_FILTERED,je=_e.Z_HUFFMAN_ONLY,Te=_e.Z_RLE,Qe=_e.Z_FIXED,Ue=_e.Z_DEFAULT_STRATEGY,qe=_e.Z_UNKNOWN,Pe=_e.Z_DEFLATED,Le=258,Ve=262,He=103,Ye=113,Je=666,Ke=function(e,t){return e.msg=Ze[t],t},Xe=function(e){return(e<<1)-(e>4?9:0)},$e=function(e){for(var t=e.length;--t>=0;)e[t]=0},et=function(e,t,r){return(t<<e.hash_shift^r)&e.hash_mask},tt=function(e){var t=e.state,r=t.pending;r>e.avail_out&&(r=e.avail_out),0!==r&&(e.output.set(t.pending_buf.subarray(t.pending_out,t.pending_out+r),e.next_out),e.next_out+=r,t.pending_out+=r,e.total_out+=r,e.avail_out-=r,t.pending-=r,0===t.pending&&(t.pending_out=0))},rt=function(e,t){xe(e,e.block_start>=0?e.block_start:-1,e.strstart-e.block_start,t),e.block_start=e.strstart,tt(e.strm)},nt=function(e,t){e.pending_buf[e.pending++]=t},it=function(e,t){e.pending_buf[e.pending++]=t>>>8&255,e.pending_buf[e.pending++]=255&t},at=function(e,t,r,n){var i=e.avail_in;return i>n&&(i=n),0===i?0:(e.avail_in-=i,t.set(e.input.subarray(e.next_in,e.next_in+i),r),1===e.state.wrap?e.adler=ge(e.adler,t,i,r):2===e.state.wrap&&(e.adler=ye(e.adler,t,i,r)),e.next_in+=i,e.total_in+=i,i)},st=function(e,t){var r,n,i=e.max_chain_length,a=e.strstart,s=e.prev_length,o=e.nice_match,u=e.strstart>e.w_size-Ve?e.strstart-(e.w_size-Ve):0,l=e.window,c=e.w_mask,h=e.prev,f=e.strstart+Le,d=l[a+s-1],v=l[a+s];e.prev_length>=e.good_match&&(i>>=2),o>e.lookahead&&(o=e.lookahead);do{if(l[(r=t)+s]===v&&l[r+s-1]===d&&l[r]===l[a]&&l[++r]===l[a+1]){a+=2,r++;do{}while(l[++a]===l[++r]&&l[++a]===l[++r]&&l[++a]===l[++r]&&l[++a]===l[++r]&&l[++a]===l[++r]&&l[++a]===l[++r]&&l[++a]===l[++r]&&l[++a]===l[++r]&&a<f);if(n=Le-(f-a),a=f-Le,n>s){if(e.match_start=t,s=n,n>=o)break;d=l[a+s-1],v=l[a+s]}}}while((t=h[t&c])>u&&0!==--i);return s<=e.lookahead?s:e.lookahead},ot=function(e){var t,r,n,i,a,s=e.w_size;do{if(i=e.window_size-e.lookahead-e.strstart,e.strstart>=s+(s-Ve)){e.window.set(e.window.subarray(s,s+s),0),e.match_start-=s,e.strstart-=s,e.block_start-=s,t=r=e.hash_size;do{n=e.head[--t],e.head[t]=n>=s?n-s:0}while(--r);t=r=s;do{n=e.prev[--t],e.prev[t]=n>=s?n-s:0}while(--r);i+=s}if(0===e.strm.avail_in)break;if(r=at(e.strm,e.window,e.strstart+e.lookahead,i),e.lookahead+=r,e.lookahead+e.insert>=3)for(a=e.strstart-e.insert,e.ins_h=e.window[a],e.ins_h=et(e,e.ins_h,e.window[a+1]);e.insert&&(e.ins_h=et(e,e.ins_h,e.window[a+3-1]),e.prev[a&e.w_mask]=e.head[e.ins_h],e.head[e.ins_h]=a,a++,e.insert--,!(e.lookahead+e.insert<3)););}while(e.lookahead<Ve&&0!==e.strm.avail_in)},ut=function(e,t){for(var r,n;;){if(e.lookahead<Ve){if(ot(e),e.lookahead<Ve&&t===Oe)return 1;if(0===e.lookahead)break}if(r=0,e.lookahead>=3&&(e.ins_h=et(e,e.ins_h,e.window[e.strstart+3-1]),r=e.prev[e.strstart&e.w_mask]=e.head[e.ins_h],e.head[e.ins_h]=e.strstart),0!==r&&e.strstart-r<=e.w_size-Ve&&(e.match_length=st(e,r)),e.match_length>=3)if(n=Ee(e,e.strstart-e.match_start,e.match_length-3),e.lookahead-=e.match_length,e.match_length<=e.max_lazy_match&&e.lookahead>=3){e.match_length--;do{e.strstart++,e.ins_h=et(e,e.ins_h,e.window[e.strstart+3-1]),r=e.prev[e.strstart&e.w_mask]=e.head[e.ins_h],e.head[e.ins_h]=e.strstart}while(0!==--e.match_length);e.strstart++}else e.strstart+=e.match_length,e.match_length=0,e.ins_h=e.window[e.strstart],e.ins_h=et(e,e.ins_h,e.window[e.strstart+1]);else n=Ee(e,0,e.window[e.strstart]),e.lookahead--,e.strstart++;if(n&&(rt(e,!1),0===e.strm.avail_out))return 1}return e.insert=e.strstart<2?e.strstart:2,t===Re?(rt(e,!0),0===e.strm.avail_out?3:4):e.last_lit&&(rt(e,!1),0===e.strm.avail_out)?1:2},lt=function(e,t){for(var r,n,i;;){if(e.lookahead<Ve){if(ot(e),e.lookahead<Ve&&t===Oe)return 1;if(0===e.lookahead)break}if(r=0,e.lookahead>=3&&(e.ins_h=et(e,e.ins_h,e.window[e.strstart+3-1]),r=e.prev[e.strstart&e.w_mask]=e.head[e.ins_h],e.head[e.ins_h]=e.strstart),e.prev_length=e.match_length,e.prev_match=e.match_start,e.match_length=2,0!==r&&e.prev_length<e.max_lazy_match&&e.strstart-r<=e.w_size-Ve&&(e.match_length=st(e,r),e.match_length<=5&&(e.strategy===Ge||3===e.match_length&&e.strstart-e.match_start>4096)&&(e.match_length=2)),e.prev_length>=3&&e.match_length<=e.prev_length){i=e.strstart+e.lookahead-3,n=Ee(e,e.strstart-1-e.prev_match,e.prev_length-3),e.lookahead-=e.prev_length-1,e.prev_length-=2;do{++e.strstart<=i&&(e.ins_h=et(e,e.ins_h,e.window[e.strstart+3-1]),r=e.prev[e.strstart&e.w_mask]=e.head[e.ins_h],e.head[e.ins_h]=e.strstart)}while(0!==--e.prev_length);if(e.match_available=0,e.match_length=2,e.strstart++,n&&(rt(e,!1),0===e.strm.avail_out))return 1}else if(e.match_available){if((n=Ee(e,0,e.window[e.strstart-1]))&&rt(e,!1),e.strstart++,e.lookahead--,0===e.strm.avail_out)return 1}else e.match_available=1,e.strstart++,e.lookahead--}return e.match_available&&(n=Ee(e,0,e.window[e.strstart-1]),e.match_available=0),e.insert=e.strstart<2?e.strstart:2,t===Re?(rt(e,!0),0===e.strm.avail_out?3:4):e.last_lit&&(rt(e,!1),0===e.strm.avail_out)?1:2};function ct(e,t,r,n,i){this.good_length=e,this.max_lazy=t,this.nice_length=r,this.max_chain=n,this.func=i}var ht=[new ct(0,0,0,0,(function(e,t){var r=65535;for(r>e.pending_buf_size-5&&(r=e.pending_buf_size-5);;){if(e.lookahead<=1){if(ot(e),0===e.lookahead&&t===Oe)return 1;if(0===e.lookahead)break}e.strstart+=e.lookahead,e.lookahead=0;var n=e.block_start+r;if((0===e.strstart||e.strstart>=n)&&(e.lookahead=e.strstart-n,e.strstart=n,rt(e,!1),0===e.strm.avail_out))return 1;if(e.strstart-e.block_start>=e.w_size-Ve&&(rt(e,!1),0===e.strm.avail_out))return 1}return e.insert=0,t===Re?(rt(e,!0),0===e.strm.avail_out?3:4):(e.strstart>e.block_start&&(rt(e,!1),e.strm.avail_out),1)})),new ct(4,4,8,4,ut),new ct(4,5,16,8,ut),new ct(4,6,32,32,ut),new ct(4,4,16,16,lt),new ct(8,16,32,32,lt),new ct(8,16,128,128,lt),new ct(8,32,128,256,lt),new ct(32,128,258,1024,lt),new ct(32,258,258,4096,lt)];function ft(){this.strm=null,this.status=0,this.pending_buf=null,this.pending_buf_size=0,this.pending_out=0,this.pending=0,this.wrap=0,this.gzhead=null,this.gzindex=0,this.method=Pe,this.last_flush=-1,this.w_size=0,this.w_bits=0,this.w_mask=0,this.window=null,this.window_size=0,this.prev=null,this.head=null,this.ins_h=0,this.hash_size=0,this.hash_bits=0,this.hash_mask=0,this.hash_shift=0,this.block_start=0,this.match_length=0,this.prev_match=0,this.match_available=0,this.strstart=0,this.match_start=0,this.lookahead=0,this.prev_length=0,this.max_chain_length=0,this.max_lazy_match=0,this.level=0,this.strategy=0,this.good_match=0,this.nice_match=0,this.dyn_ltree=new Uint16Array(1146),this.dyn_dtree=new Uint16Array(122),this.bl_tree=new Uint16Array(78),$e(this.dyn_ltree),$e(this.dyn_dtree),$e(this.bl_tree),this.l_desc=null,this.d_desc=null,this.bl_desc=null,this.bl_count=new Uint16Array(16),this.heap=new Uint16Array(573),$e(this.heap),this.heap_len=0,this.heap_max=0,this.depth=new Uint16Array(573),$e(this.depth),this.l_buf=0,this.lit_bufsize=0,this.last_lit=0,this.d_buf=0,this.opt_len=0,this.static_len=0,this.matches=0,this.insert=0,this.bi_buf=0,this.bi_valid=0}var dt=function(e){if(!e||!e.state)return Ke(e,De);e.total_in=e.total_out=0,e.data_type=qe;var t=e.state;return t.pending=0,t.pending_out=0,t.wrap<0&&(t.wrap=-t.wrap),t.status=t.wrap?42:Ye,e.adler=2===t.wrap?0:1,t.last_flush=Oe,ke(t),Me},vt=function(e){var t,r=dt(e);return r===Me&&((t=e.state).window_size=2*t.w_size,$e(t.head),t.max_lazy_match=ht[t.level].max_lazy,t.good_match=ht[t.level].good_length,t.nice_match=ht[t.level].nice_length,t.max_chain_length=ht[t.level].max_chain,t.strstart=0,t.block_start=0,t.lookahead=0,t.insert=0,t.match_length=t.prev_length=2,t.match_available=0,t.ins_h=0),r},mt=function(e,t,r,n,i,a){if(!e)return De;var s=1;if(t===We&&(t=6),n<0?(s=0,n=-n):n>15&&(s=2,n-=16),i<1||i>9||r!==Pe||n<8||n>15||t<0||t>9||a<0||a>Qe)return Ke(e,De);8===n&&(n=9);var o=new ft;return e.state=o,o.strm=e,o.wrap=s,o.gzhead=null,o.w_bits=n,o.w_size=1<<o.w_bits,o.w_mask=o.w_size-1,o.hash_bits=i+7,o.hash_size=1<<o.hash_bits,o.hash_mask=o.hash_size-1,o.hash_shift=~~((o.hash_bits+3-1)/3),o.window=new Uint8Array(2*o.w_size),o.head=new Uint16Array(o.hash_size),o.prev=new Uint16Array(o.w_size),o.lit_bufsize=1<<i+6,o.pending_buf_size=4*o.lit_bufsize,o.pending_buf=new Uint8Array(o.pending_buf_size),o.d_buf=1*o.lit_bufsize,o.l_buf=3*o.lit_bufsize,o.level=t,o.strategy=a,o.method=r,vt(e)},pt={deflateInit:function(e,t){return mt(e,t,Pe,15,8,Ue)},deflateInit2:mt,deflateReset:vt,deflateResetKeep:dt,deflateSetHeader:function(e,t){return e&&e.state?2!==e.state.wrap?De:(e.state.gzhead=t,Me):De},deflate:function(e,t){var r,n;if(!e||!e.state||t>Ne||t<0)return e?Ke(e,De):De;var i=e.state;if(!e.output||!e.input&&0!==e.avail_in||i.status===Je&&t!==Re)return Ke(e,0===e.avail_out?Be:De);i.strm=e;var a=i.last_flush;if(i.last_flush=t,42===i.status)if(2===i.wrap)e.adler=0,nt(i,31),nt(i,139),nt(i,8),i.gzhead?(nt(i,(i.gzhead.text?1:0)+(i.gzhead.hcrc?2:0)+(i.gzhead.extra?4:0)+(i.gzhead.name?8:0)+(i.gzhead.comment?16:0)),nt(i,255&i.gzhead.time),nt(i,i.gzhead.time>>8&255),nt(i,i.gzhead.time>>16&255),nt(i,i.gzhead.time>>24&255),nt(i,9===i.level?2:i.strategy>=je||i.level<2?4:0),nt(i,255&i.gzhead.os),i.gzhead.extra&&i.gzhead.extra.length&&(nt(i,255&i.gzhead.extra.length),nt(i,i.gzhead.extra.length>>8&255)),i.gzhead.hcrc&&(e.adler=ye(e.adler,i.pending_buf,i.pending,0)),i.gzindex=0,i.status=69):(nt(i,0),nt(i,0),nt(i,0),nt(i,0),nt(i,0),nt(i,9===i.level?2:i.strategy>=je||i.level<2?4:0),nt(i,3),i.status=Ye);else{var s=Pe+(i.w_bits-8<<4)<<8;s|=(i.strategy>=je||i.level<2?0:i.level<6?1:6===i.level?2:3)<<6,0!==i.strstart&&(s|=32),s+=31-s%31,i.status=Ye,it(i,s),0!==i.strstart&&(it(i,e.adler>>>16),it(i,65535&e.adler)),e.adler=1}if(69===i.status)if(i.gzhead.extra){for(r=i.pending;i.gzindex<(65535&i.gzhead.extra.length)&&(i.pending!==i.pending_buf_size||(i.gzhead.hcrc&&i.pending>r&&(e.adler=ye(e.adler,i.pending_buf,i.pending-r,r)),tt(e),r=i.pending,i.pending!==i.pending_buf_size));)nt(i,255&i.gzhead.extra[i.gzindex]),i.gzindex++;i.gzhead.hcrc&&i.pending>r&&(e.adler=ye(e.adler,i.pending_buf,i.pending-r,r)),i.gzindex===i.gzhead.extra.length&&(i.gzindex=0,i.status=73)}else i.status=73;if(73===i.status)if(i.gzhead.name){r=i.pending;do{if(i.pending===i.pending_buf_size&&(i.gzhead.hcrc&&i.pending>r&&(e.adler=ye(e.adler,i.pending_buf,i.pending-r,r)),tt(e),r=i.pending,i.pending===i.pending_buf_size)){n=1;break}n=i.gzindex<i.gzhead.name.length?255&i.gzhead.name.charCodeAt(i.gzindex++):0,nt(i,n)}while(0!==n);i.gzhead.hcrc&&i.pending>r&&(e.adler=ye(e.adler,i.pending_buf,i.pending-r,r)),0===n&&(i.gzindex=0,i.status=91)}else i.status=91;if(91===i.status)if(i.gzhead.comment){r=i.pending;do{if(i.pending===i.pending_buf_size&&(i.gzhead.hcrc&&i.pending>r&&(e.adler=ye(e.adler,i.pending_buf,i.pending-r,r)),tt(e),r=i.pending,i.pending===i.pending_buf_size)){n=1;break}n=i.gzindex<i.gzhead.comment.length?255&i.gzhead.comment.charCodeAt(i.gzindex++):0,nt(i,n)}while(0!==n);i.gzhead.hcrc&&i.pending>r&&(e.adler=ye(e.adler,i.pending_buf,i.pending-r,r)),0===n&&(i.status=He)}else i.status=He;if(i.status===He&&(i.gzhead.hcrc?(i.pending+2>i.pending_buf_size&&tt(e),i.pending+2<=i.pending_buf_size&&(nt(i,255&e.adler),nt(i,e.adler>>8&255),e.adler=0,i.status=Ye)):i.status=Ye),0!==i.pending){if(tt(e),0===e.avail_out)return i.last_flush=-1,Me}else if(0===e.avail_in&&Xe(t)<=Xe(a)&&t!==Re)return Ke(e,Be);if(i.status===Je&&0!==e.avail_in)return Ke(e,Be);if(0!==e.avail_in||0!==i.lookahead||t!==Oe&&i.status!==Je){var o=i.strategy===je?function(e,t){for(var r;;){if(0===e.lookahead&&(ot(e),0===e.lookahead)){if(t===Oe)return 1;break}if(e.match_length=0,r=Ee(e,0,e.window[e.strstart]),e.lookahead--,e.strstart++,r&&(rt(e,!1),0===e.strm.avail_out))return 1}return e.insert=0,t===Re?(rt(e,!0),0===e.strm.avail_out?3:4):e.last_lit&&(rt(e,!1),0===e.strm.avail_out)?1:2}(i,t):i.strategy===Te?function(e,t){for(var r,n,i,a,s=e.window;;){if(e.lookahead<=Le){if(ot(e),e.lookahead<=Le&&t===Oe)return 1;if(0===e.lookahead)break}if(e.match_length=0,e.lookahead>=3&&e.strstart>0&&(n=s[i=e.strstart-1])===s[++i]&&n===s[++i]&&n===s[++i]){a=e.strstart+Le;do{}while(n===s[++i]&&n===s[++i]&&n===s[++i]&&n===s[++i]&&n===s[++i]&&n===s[++i]&&n===s[++i]&&n===s[++i]&&i<a);e.match_length=Le-(a-i),e.match_length>e.lookahead&&(e.match_length=e.lookahead)}if(e.match_length>=3?(r=Ee(e,1,e.match_length-3),e.lookahead-=e.match_length,e.strstart+=e.match_length,e.match_length=0):(r=Ee(e,0,e.window[e.strstart]),e.lookahead--,e.strstart++),r&&(rt(e,!1),0===e.strm.avail_out))return 1}return e.insert=0,t===Re?(rt(e,!0),0===e.strm.avail_out?3:4):e.last_lit&&(rt(e,!1),0===e.strm.avail_out)?1:2}(i,t):ht[i.level].func(i,t);if(3!==o&&4!==o||(i.status=Je),1===o||3===o)return 0===e.avail_out&&(i.last_flush=-1),Me;if(2===o&&(t===Ie?Se(i):t!==Ne&&(Ae(i,0,0,!1),t===Ce&&($e(i.head),0===i.lookahead&&(i.strstart=0,i.block_start=0,i.insert=0))),tt(e),0===e.avail_out))return i.last_flush=-1,Me}return t!==Re?Me:i.wrap<=0?Fe:(2===i.wrap?(nt(i,255&e.adler),nt(i,e.adler>>8&255),nt(i,e.adler>>16&255),nt(i,e.adler>>24&255),nt(i,255&e.total_in),nt(i,e.total_in>>8&255),nt(i,e.total_in>>16&255),nt(i,e.total_in>>24&255)):(it(i,e.adler>>>16),it(i,65535&e.adler)),tt(e),i.wrap>0&&(i.wrap=-i.wrap),0!==i.pending?Me:Fe)},deflateEnd:function(e){if(!e||!e.state)return De;var t=e.state.status;return 42!==t&&69!==t&&73!==t&&91!==t&&t!==He&&t!==Ye&&t!==Je?Ke(e,De):(e.state=null,t===Ye?Ke(e,ze):Me)},deflateSetDictionary:function(e,t){var r=t.length;if(!e||!e.state)return De;var n=e.state,i=n.wrap;if(2===i||1===i&&42!==n.status||n.lookahead)return De;if(1===i&&(e.adler=ge(e.adler,t,r,0)),n.wrap=0,r>=n.w_size){0===i&&($e(n.head),n.strstart=0,n.block_start=0,n.insert=0);var a=new Uint8Array(n.w_size);a.set(t.subarray(r-n.w_size,r),0),t=a,r=n.w_size}var s=e.avail_in,o=e.next_in,u=e.input;for(e.avail_in=r,e.next_in=0,e.input=t,ot(n);n.lookahead>=3;){var l=n.strstart,c=n.lookahead-2;do{n.ins_h=et(n,n.ins_h,n.window[l+3-1]),n.prev[l&n.w_mask]=n.head[n.ins_h],n.head[n.ins_h]=l,l++}while(--c);n.strstart=l,n.lookahead=2,ot(n)}return n.strstart+=n.lookahead,n.block_start=n.strstart,n.insert=n.lookahead,n.lookahead=0,n.match_length=n.prev_length=2,n.match_available=0,e.next_in=o,e.input=u,e.avail_in=s,n.wrap=i,Me},deflateInfo:"pako deflate (from Nodeca project)"},wt=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},gt=function(e){for(var t=Array.prototype.slice.call(arguments,1);t.length;){var r=t.shift();if(r){if("object"!==typeof r)throw new TypeError(r+"must be non-object");for(var n in r)wt(r,n)&&(e[n]=r[n])}}return e},bt=function(e){for(var t=0,r=0,n=e.length;r<n;r++)t+=e[r].length;for(var i=new Uint8Array(t),a=0,s=0,o=e.length;a<o;a++){var u=e[a];i.set(u,s),s+=u.length}return i},yt=!0;try{String.fromCharCode.apply(null,new Uint8Array(1))}catch(Kl){yt=!1}for(var Zt=new Uint8Array(256),_t=0;_t<256;_t++)Zt[_t]=_t>=252?6:_t>=248?5:_t>=240?4:_t>=224?3:_t>=192?2:1;Zt[254]=Zt[254]=1;var kt=function(e){if("function"===typeof TextEncoder&&TextEncoder.prototype.encode)return(new TextEncoder).encode(e);var t,r,n,i,a,s=e.length,o=0;for(i=0;i<s;i++)55296===(64512&(r=e.charCodeAt(i)))&&i+1<s&&56320===(64512&(n=e.charCodeAt(i+1)))&&(r=65536+(r-55296<<10)+(n-56320),i++),o+=r<128?1:r<2048?2:r<65536?3:4;for(t=new Uint8Array(o),a=0,i=0;a<o;i++)55296===(64512&(r=e.charCodeAt(i)))&&i+1<s&&56320===(64512&(n=e.charCodeAt(i+1)))&&(r=65536+(r-55296<<10)+(n-56320),i++),r<128?t[a++]=r:r<2048?(t[a++]=192|r>>>6,t[a++]=128|63&r):r<65536?(t[a++]=224|r>>>12,t[a++]=128|r>>>6&63,t[a++]=128|63&r):(t[a++]=240|r>>>18,t[a++]=128|r>>>12&63,t[a++]=128|r>>>6&63,t[a++]=128|63&r);return t},At=function(e,t){var r,n,i=t||e.length;if("function"===typeof TextDecoder&&TextDecoder.prototype.decode)return(new TextDecoder).decode(e.subarray(0,t));var a=new Array(2*i);for(n=0,r=0;r<i;){var s=e[r++];if(s<128)a[n++]=s;else{var o=Zt[s];if(o>4)a[n++]=65533,r+=o-1;else{for(s&=2===o?31:3===o?15:7;o>1&&r<i;)s=s<<6|63&e[r++],o--;o>1?a[n++]=65533:s<65536?a[n++]=s:(s-=65536,a[n++]=55296|s>>10&1023,a[n++]=56320|1023&s)}}}return function(e,t){if(t<65534&&e.subarray&&yt)return String.fromCharCode.apply(null,e.length===t?e:e.subarray(0,t));for(var r="",n=0;n<t;n++)r+=String.fromCharCode(e[n]);return r}(a,n)},xt=function(e,t){(t=t||e.length)>e.length&&(t=e.length);for(var r=t-1;r>=0&&128===(192&e[r]);)r--;return r<0||0===r?t:r+Zt[e[r]]>t?r:t};var Et=function(){this.input=null,this.next_in=0,this.avail_in=0,this.total_in=0,this.output=null,this.next_out=0,this.avail_out=0,this.total_out=0,this.msg="",this.state=null,this.data_type=2,this.adler=0},St=Object.prototype.toString,Ot=_e.Z_NO_FLUSH,It=_e.Z_SYNC_FLUSH,Ct=_e.Z_FULL_FLUSH,Rt=_e.Z_FINISH,Nt=_e.Z_OK,Mt=_e.Z_STREAM_END,Ft=_e.Z_DEFAULT_COMPRESSION,Dt=_e.Z_DEFAULT_STRATEGY,zt=_e.Z_DEFLATED;function Bt(e){this.options=gt({level:Ft,method:zt,chunkSize:16384,windowBits:15,memLevel:8,strategy:Dt},e||{});var t=this.options;t.raw&&t.windowBits>0?t.windowBits=-t.windowBits:t.gzip&&t.windowBits>0&&t.windowBits<16&&(t.windowBits+=16),this.err=0,this.msg="",this.ended=!1,this.chunks=[],this.strm=new Et,this.strm.avail_out=0;var r=pt.deflateInit2(this.strm,t.level,t.method,t.windowBits,t.memLevel,t.strategy);if(r!==Nt)throw new Error(Ze[r]);if(t.header&&pt.deflateSetHeader(this.strm,t.header),t.dictionary){var n;if(n="string"===typeof t.dictionary?kt(t.dictionary):"[object ArrayBuffer]"===St.call(t.dictionary)?new Uint8Array(t.dictionary):t.dictionary,(r=pt.deflateSetDictionary(this.strm,n))!==Nt)throw new Error(Ze[r]);this._dict_set=!0}}Bt.prototype.push=function(e,t){var r,n,i=this.strm,a=this.options.chunkSize;if(this.ended)return!1;for(n=t===~~t?t:!0===t?Rt:Ot,"string"===typeof e?i.input=kt(e):"[object ArrayBuffer]"===St.call(e)?i.input=new Uint8Array(e):i.input=e,i.next_in=0,i.avail_in=i.input.length;;)if(0===i.avail_out&&(i.output=new Uint8Array(a),i.next_out=0,i.avail_out=a),(n===It||n===Ct)&&i.avail_out<=6)this.onData(i.output.subarray(0,i.next_out)),i.avail_out=0;else{if((r=pt.deflate(i,n))===Mt)return i.next_out>0&&this.onData(i.output.subarray(0,i.next_out)),r=pt.deflateEnd(this.strm),this.onEnd(r),this.ended=!0,r===Nt;if(0!==i.avail_out){if(n>0&&i.next_out>0)this.onData(i.output.subarray(0,i.next_out)),i.avail_out=0;else if(0===i.avail_in)break}else this.onData(i.output)}return!0},Bt.prototype.onData=function(e){this.chunks.push(e)},Bt.prototype.onEnd=function(e){e===Nt&&(this.result=bt(this.chunks)),this.chunks=[],this.err=e,this.msg=this.strm.msg};var Wt=function(e,t){var r,n,i,a,s,o,u,l,c,h,f,d,v,m,p,w,g,b,y,Z,_,k,A,x,E=e.state;r=e.next_in,A=e.input,n=r+(e.avail_in-5),i=e.next_out,x=e.output,a=i-(t-e.avail_out),s=i+(e.avail_out-257),o=E.dmax,u=E.wsize,l=E.whave,c=E.wnext,h=E.window,f=E.hold,d=E.bits,v=E.lencode,m=E.distcode,p=(1<<E.lenbits)-1,w=(1<<E.distbits)-1;e:do{d<15&&(f+=A[r++]<<d,d+=8,f+=A[r++]<<d,d+=8),g=v[f&p];t:for(;;){if(f>>>=b=g>>>24,d-=b,0===(b=g>>>16&255))x[i++]=65535&g;else{if(!(16&b)){if(0===(64&b)){g=v[(65535&g)+(f&(1<<b)-1)];continue t}if(32&b){E.mode=12;break e}e.msg="invalid literal/length code",E.mode=30;break e}y=65535&g,(b&=15)&&(d<b&&(f+=A[r++]<<d,d+=8),y+=f&(1<<b)-1,f>>>=b,d-=b),d<15&&(f+=A[r++]<<d,d+=8,f+=A[r++]<<d,d+=8),g=m[f&w];r:for(;;){if(f>>>=b=g>>>24,d-=b,!(16&(b=g>>>16&255))){if(0===(64&b)){g=m[(65535&g)+(f&(1<<b)-1)];continue r}e.msg="invalid distance code",E.mode=30;break e}if(Z=65535&g,d<(b&=15)&&(f+=A[r++]<<d,(d+=8)<b&&(f+=A[r++]<<d,d+=8)),(Z+=f&(1<<b)-1)>o){e.msg="invalid distance too far back",E.mode=30;break e}if(f>>>=b,d-=b,Z>(b=i-a)){if((b=Z-b)>l&&E.sane){e.msg="invalid distance too far back",E.mode=30;break e}if(_=0,k=h,0===c){if(_+=u-b,b<y){y-=b;do{x[i++]=h[_++]}while(--b);_=i-Z,k=x}}else if(c<b){if(_+=u+c-b,(b-=c)<y){y-=b;do{x[i++]=h[_++]}while(--b);if(_=0,c<y){y-=b=c;do{x[i++]=h[_++]}while(--b);_=i-Z,k=x}}}else if(_+=c-b,b<y){y-=b;do{x[i++]=h[_++]}while(--b);_=i-Z,k=x}for(;y>2;)x[i++]=k[_++],x[i++]=k[_++],x[i++]=k[_++],y-=3;y&&(x[i++]=k[_++],y>1&&(x[i++]=k[_++]))}else{_=i-Z;do{x[i++]=x[_++],x[i++]=x[_++],x[i++]=x[_++],y-=3}while(y>2);y&&(x[i++]=x[_++],y>1&&(x[i++]=x[_++]))}break}}break}}while(r<n&&i<s);r-=y=d>>3,f&=(1<<(d-=y<<3))-1,e.next_in=r,e.next_out=i,e.avail_in=r<n?n-r+5:5-(r-n),e.avail_out=i<s?s-i+257:257-(i-s),E.hold=f,E.bits=d},Gt=15,jt=new Uint16Array([3,4,5,6,7,8,9,10,11,13,15,17,19,23,27,31,35,43,51,59,67,83,99,115,131,163,195,227,258,0,0]),Tt=new Uint8Array([16,16,16,16,16,16,16,16,17,17,17,17,18,18,18,18,19,19,19,19,20,20,20,20,21,21,21,21,16,72,78]),Qt=new Uint16Array([1,2,3,4,5,7,9,13,17,25,33,49,65,97,129,193,257,385,513,769,1025,1537,2049,3073,4097,6145,8193,12289,16385,24577,0,0]),Ut=new Uint8Array([16,16,16,16,17,17,18,18,19,19,20,20,21,21,22,22,23,23,24,24,25,25,26,26,27,27,28,28,29,29,64,64]),qt=function(e,t,r,n,i,a,s,o){var u,l,c,h,f,d,v,m,p,w=o.bits,g=0,b=0,y=0,Z=0,_=0,k=0,A=0,x=0,E=0,S=0,O=null,I=0,C=new Uint16Array(16),R=new Uint16Array(16),N=null,M=0;for(g=0;g<=Gt;g++)C[g]=0;for(b=0;b<n;b++)C[t[r+b]]++;for(_=w,Z=Gt;Z>=1&&0===C[Z];Z--);if(_>Z&&(_=Z),0===Z)return i[a++]=20971520,i[a++]=20971520,o.bits=1,0;for(y=1;y<Z&&0===C[y];y++);for(_<y&&(_=y),x=1,g=1;g<=Gt;g++)if(x<<=1,(x-=C[g])<0)return-1;if(x>0&&(0===e||1!==Z))return-1;for(R[1]=0,g=1;g<Gt;g++)R[g+1]=R[g]+C[g];for(b=0;b<n;b++)0!==t[r+b]&&(s[R[t[r+b]]++]=b);if(0===e?(O=N=s,d=19):1===e?(O=jt,I-=257,N=Tt,M-=257,d=256):(O=Qt,N=Ut,d=-1),S=0,b=0,g=y,f=a,k=_,A=0,c=-1,h=(E=1<<_)-1,1===e&&E>852||2===e&&E>592)return 1;for(;;){v=g-A,s[b]<d?(m=0,p=s[b]):s[b]>d?(m=N[M+s[b]],p=O[I+s[b]]):(m=96,p=0),u=1<<g-A,y=l=1<<k;do{i[f+(S>>A)+(l-=u)]=v<<24|m<<16|p|0}while(0!==l);for(u=1<<g-1;S&u;)u>>=1;if(0!==u?(S&=u-1,S+=u):S=0,b++,0===--C[g]){if(g===Z)break;g=t[r+s[b]]}if(g>_&&(S&h)!==c){for(0===A&&(A=_),f+=y,x=1<<(k=g-A);k+A<Z&&!((x-=C[k+A])<=0);)k++,x<<=1;if(E+=1<<k,1===e&&E>852||2===e&&E>592)return 1;i[c=S&h]=_<<24|k<<16|f-a|0}}return 0!==S&&(i[f+S]=g-A<<24|64<<16|0),o.bits=_,0},Pt=_e.Z_FINISH,Lt=_e.Z_BLOCK,Vt=_e.Z_TREES,Ht=_e.Z_OK,Yt=_e.Z_STREAM_END,Jt=_e.Z_NEED_DICT,Kt=_e.Z_STREAM_ERROR,Xt=_e.Z_DATA_ERROR,$t=_e.Z_MEM_ERROR,er=_e.Z_BUF_ERROR,tr=_e.Z_DEFLATED,rr=12,nr=30,ir=function(e){return(e>>>24&255)+(e>>>8&65280)+((65280&e)<<8)+((255&e)<<24)};function ar(){this.mode=0,this.last=!1,this.wrap=0,this.havedict=!1,this.flags=0,this.dmax=0,this.check=0,this.total=0,this.head=null,this.wbits=0,this.wsize=0,this.whave=0,this.wnext=0,this.window=null,this.hold=0,this.bits=0,this.length=0,this.offset=0,this.extra=0,this.lencode=null,this.distcode=null,this.lenbits=0,this.distbits=0,this.ncode=0,this.nlen=0,this.ndist=0,this.have=0,this.next=null,this.lens=new Uint16Array(320),this.work=new Uint16Array(288),this.lendyn=null,this.distdyn=null,this.sane=0,this.back=0,this.was=0}var sr,or,ur=function(e){if(!e||!e.state)return Kt;var t=e.state;return e.total_in=e.total_out=t.total=0,e.msg="",t.wrap&&(e.adler=1&t.wrap),t.mode=1,t.last=0,t.havedict=0,t.dmax=32768,t.head=null,t.hold=0,t.bits=0,t.lencode=t.lendyn=new Int32Array(852),t.distcode=t.distdyn=new Int32Array(592),t.sane=1,t.back=-1,Ht},lr=function(e){if(!e||!e.state)return Kt;var t=e.state;return t.wsize=0,t.whave=0,t.wnext=0,ur(e)},cr=function(e,t){var r;if(!e||!e.state)return Kt;var n=e.state;return t<0?(r=0,t=-t):(r=1+(t>>4),t<48&&(t&=15)),t&&(t<8||t>15)?Kt:(null!==n.window&&n.wbits!==t&&(n.window=null),n.wrap=r,n.wbits=t,lr(e))},hr=function(e,t){if(!e)return Kt;var r=new ar;e.state=r,r.window=null;var n=cr(e,t);return n!==Ht&&(e.state=null),n},fr=!0,dr=function(e){if(fr){sr=new Int32Array(512),or=new Int32Array(32);for(var t=0;t<144;)e.lens[t++]=8;for(;t<256;)e.lens[t++]=9;for(;t<280;)e.lens[t++]=7;for(;t<288;)e.lens[t++]=8;for(qt(1,e.lens,0,288,sr,0,e.work,{bits:9}),t=0;t<32;)e.lens[t++]=5;qt(2,e.lens,0,32,or,0,e.work,{bits:5}),fr=!1}e.lencode=sr,e.lenbits=9,e.distcode=or,e.distbits=5},vr=function(e,t,r,n){var i,a=e.state;return null===a.window&&(a.wsize=1<<a.wbits,a.wnext=0,a.whave=0,a.window=new Uint8Array(a.wsize)),n>=a.wsize?(a.window.set(t.subarray(r-a.wsize,r),0),a.wnext=0,a.whave=a.wsize):((i=a.wsize-a.wnext)>n&&(i=n),a.window.set(t.subarray(r-n,r-n+i),a.wnext),(n-=i)?(a.window.set(t.subarray(r-n,r),0),a.wnext=n,a.whave=a.wsize):(a.wnext+=i,a.wnext===a.wsize&&(a.wnext=0),a.whave<a.wsize&&(a.whave+=i))),0},mr={inflateReset:lr,inflateReset2:cr,inflateResetKeep:ur,inflateInit:function(e){return hr(e,15)},inflateInit2:hr,inflate:function(e,t){var r,n,i,a,s,o,u,l,c,h,f,d,v,m,p,w,g,b,y,Z,_,k,A,x,E=0,S=new Uint8Array(4),O=new Uint8Array([16,17,18,0,8,7,9,6,10,5,11,4,12,3,13,2,14,1,15]);if(!e||!e.state||!e.output||!e.input&&0!==e.avail_in)return Kt;(r=e.state).mode===rr&&(r.mode=13),s=e.next_out,i=e.output,u=e.avail_out,a=e.next_in,n=e.input,o=e.avail_in,l=r.hold,c=r.bits,h=o,f=u,k=Ht;e:for(;;)switch(r.mode){case 1:if(0===r.wrap){r.mode=13;break}for(;c<16;){if(0===o)break e;o--,l+=n[a++]<<c,c+=8}if(2&r.wrap&&35615===l){r.check=0,S[0]=255&l,S[1]=l>>>8&255,r.check=ye(r.check,S,2,0),l=0,c=0,r.mode=2;break}if(r.flags=0,r.head&&(r.head.done=!1),!(1&r.wrap)||(((255&l)<<8)+(l>>8))%31){e.msg="incorrect header check",r.mode=nr;break}if((15&l)!==tr){e.msg="unknown compression method",r.mode=nr;break}if(c-=4,_=8+(15&(l>>>=4)),0===r.wbits)r.wbits=_;else if(_>r.wbits){e.msg="invalid window size",r.mode=nr;break}r.dmax=1<<r.wbits,e.adler=r.check=1,r.mode=512&l?10:rr,l=0,c=0;break;case 2:for(;c<16;){if(0===o)break e;o--,l+=n[a++]<<c,c+=8}if(r.flags=l,(255&r.flags)!==tr){e.msg="unknown compression method",r.mode=nr;break}if(57344&r.flags){e.msg="unknown header flags set",r.mode=nr;break}r.head&&(r.head.text=l>>8&1),512&r.flags&&(S[0]=255&l,S[1]=l>>>8&255,r.check=ye(r.check,S,2,0)),l=0,c=0,r.mode=3;case 3:for(;c<32;){if(0===o)break e;o--,l+=n[a++]<<c,c+=8}r.head&&(r.head.time=l),512&r.flags&&(S[0]=255&l,S[1]=l>>>8&255,S[2]=l>>>16&255,S[3]=l>>>24&255,r.check=ye(r.check,S,4,0)),l=0,c=0,r.mode=4;case 4:for(;c<16;){if(0===o)break e;o--,l+=n[a++]<<c,c+=8}r.head&&(r.head.xflags=255&l,r.head.os=l>>8),512&r.flags&&(S[0]=255&l,S[1]=l>>>8&255,r.check=ye(r.check,S,2,0)),l=0,c=0,r.mode=5;case 5:if(1024&r.flags){for(;c<16;){if(0===o)break e;o--,l+=n[a++]<<c,c+=8}r.length=l,r.head&&(r.head.extra_len=l),512&r.flags&&(S[0]=255&l,S[1]=l>>>8&255,r.check=ye(r.check,S,2,0)),l=0,c=0}else r.head&&(r.head.extra=null);r.mode=6;case 6:if(1024&r.flags&&((d=r.length)>o&&(d=o),d&&(r.head&&(_=r.head.extra_len-r.length,r.head.extra||(r.head.extra=new Uint8Array(r.head.extra_len)),r.head.extra.set(n.subarray(a,a+d),_)),512&r.flags&&(r.check=ye(r.check,n,d,a)),o-=d,a+=d,r.length-=d),r.length))break e;r.length=0,r.mode=7;case 7:if(2048&r.flags){if(0===o)break e;d=0;do{_=n[a+d++],r.head&&_&&r.length<65536&&(r.head.name+=String.fromCharCode(_))}while(_&&d<o);if(512&r.flags&&(r.check=ye(r.check,n,d,a)),o-=d,a+=d,_)break e}else r.head&&(r.head.name=null);r.length=0,r.mode=8;case 8:if(4096&r.flags){if(0===o)break e;d=0;do{_=n[a+d++],r.head&&_&&r.length<65536&&(r.head.comment+=String.fromCharCode(_))}while(_&&d<o);if(512&r.flags&&(r.check=ye(r.check,n,d,a)),o-=d,a+=d,_)break e}else r.head&&(r.head.comment=null);r.mode=9;case 9:if(512&r.flags){for(;c<16;){if(0===o)break e;o--,l+=n[a++]<<c,c+=8}if(l!==(65535&r.check)){e.msg="header crc mismatch",r.mode=nr;break}l=0,c=0}r.head&&(r.head.hcrc=r.flags>>9&1,r.head.done=!0),e.adler=r.check=0,r.mode=rr;break;case 10:for(;c<32;){if(0===o)break e;o--,l+=n[a++]<<c,c+=8}e.adler=r.check=ir(l),l=0,c=0,r.mode=11;case 11:if(0===r.havedict)return e.next_out=s,e.avail_out=u,e.next_in=a,e.avail_in=o,r.hold=l,r.bits=c,Jt;e.adler=r.check=1,r.mode=rr;case rr:if(t===Lt||t===Vt)break e;case 13:if(r.last){l>>>=7&c,c-=7&c,r.mode=27;break}for(;c<3;){if(0===o)break e;o--,l+=n[a++]<<c,c+=8}switch(r.last=1&l,c-=1,3&(l>>>=1)){case 0:r.mode=14;break;case 1:if(dr(r),r.mode=20,t===Vt){l>>>=2,c-=2;break e}break;case 2:r.mode=17;break;case 3:e.msg="invalid block type",r.mode=nr}l>>>=2,c-=2;break;case 14:for(l>>>=7&c,c-=7&c;c<32;){if(0===o)break e;o--,l+=n[a++]<<c,c+=8}if((65535&l)!==(l>>>16^65535)){e.msg="invalid stored block lengths",r.mode=nr;break}if(r.length=65535&l,l=0,c=0,r.mode=15,t===Vt)break e;case 15:r.mode=16;case 16:if(d=r.length){if(d>o&&(d=o),d>u&&(d=u),0===d)break e;i.set(n.subarray(a,a+d),s),o-=d,a+=d,u-=d,s+=d,r.length-=d;break}r.mode=rr;break;case 17:for(;c<14;){if(0===o)break e;o--,l+=n[a++]<<c,c+=8}if(r.nlen=257+(31&l),l>>>=5,c-=5,r.ndist=1+(31&l),l>>>=5,c-=5,r.ncode=4+(15&l),l>>>=4,c-=4,r.nlen>286||r.ndist>30){e.msg="too many length or distance symbols",r.mode=nr;break}r.have=0,r.mode=18;case 18:for(;r.have<r.ncode;){for(;c<3;){if(0===o)break e;o--,l+=n[a++]<<c,c+=8}r.lens[O[r.have++]]=7&l,l>>>=3,c-=3}for(;r.have<19;)r.lens[O[r.have++]]=0;if(r.lencode=r.lendyn,r.lenbits=7,A={bits:r.lenbits},k=qt(0,r.lens,0,19,r.lencode,0,r.work,A),r.lenbits=A.bits,k){e.msg="invalid code lengths set",r.mode=nr;break}r.have=0,r.mode=19;case 19:for(;r.have<r.nlen+r.ndist;){for(;w=(E=r.lencode[l&(1<<r.lenbits)-1])>>>16&255,g=65535&E,!((p=E>>>24)<=c);){if(0===o)break e;o--,l+=n[a++]<<c,c+=8}if(g<16)l>>>=p,c-=p,r.lens[r.have++]=g;else{if(16===g){for(x=p+2;c<x;){if(0===o)break e;o--,l+=n[a++]<<c,c+=8}if(l>>>=p,c-=p,0===r.have){e.msg="invalid bit length repeat",r.mode=nr;break}_=r.lens[r.have-1],d=3+(3&l),l>>>=2,c-=2}else if(17===g){for(x=p+3;c<x;){if(0===o)break e;o--,l+=n[a++]<<c,c+=8}c-=p,_=0,d=3+(7&(l>>>=p)),l>>>=3,c-=3}else{for(x=p+7;c<x;){if(0===o)break e;o--,l+=n[a++]<<c,c+=8}c-=p,_=0,d=11+(127&(l>>>=p)),l>>>=7,c-=7}if(r.have+d>r.nlen+r.ndist){e.msg="invalid bit length repeat",r.mode=nr;break}for(;d--;)r.lens[r.have++]=_}}if(r.mode===nr)break;if(0===r.lens[256]){e.msg="invalid code -- missing end-of-block",r.mode=nr;break}if(r.lenbits=9,A={bits:r.lenbits},k=qt(1,r.lens,0,r.nlen,r.lencode,0,r.work,A),r.lenbits=A.bits,k){e.msg="invalid literal/lengths set",r.mode=nr;break}if(r.distbits=6,r.distcode=r.distdyn,A={bits:r.distbits},k=qt(2,r.lens,r.nlen,r.ndist,r.distcode,0,r.work,A),r.distbits=A.bits,k){e.msg="invalid distances set",r.mode=nr;break}if(r.mode=20,t===Vt)break e;case 20:r.mode=21;case 21:if(o>=6&&u>=258){e.next_out=s,e.avail_out=u,e.next_in=a,e.avail_in=o,r.hold=l,r.bits=c,Wt(e,f),s=e.next_out,i=e.output,u=e.avail_out,a=e.next_in,n=e.input,o=e.avail_in,l=r.hold,c=r.bits,r.mode===rr&&(r.back=-1);break}for(r.back=0;w=(E=r.lencode[l&(1<<r.lenbits)-1])>>>16&255,g=65535&E,!((p=E>>>24)<=c);){if(0===o)break e;o--,l+=n[a++]<<c,c+=8}if(w&&0===(240&w)){for(b=p,y=w,Z=g;w=(E=r.lencode[Z+((l&(1<<b+y)-1)>>b)])>>>16&255,g=65535&E,!(b+(p=E>>>24)<=c);){if(0===o)break e;o--,l+=n[a++]<<c,c+=8}l>>>=b,c-=b,r.back+=b}if(l>>>=p,c-=p,r.back+=p,r.length=g,0===w){r.mode=26;break}if(32&w){r.back=-1,r.mode=rr;break}if(64&w){e.msg="invalid literal/length code",r.mode=nr;break}r.extra=15&w,r.mode=22;case 22:if(r.extra){for(x=r.extra;c<x;){if(0===o)break e;o--,l+=n[a++]<<c,c+=8}r.length+=l&(1<<r.extra)-1,l>>>=r.extra,c-=r.extra,r.back+=r.extra}r.was=r.length,r.mode=23;case 23:for(;w=(E=r.distcode[l&(1<<r.distbits)-1])>>>16&255,g=65535&E,!((p=E>>>24)<=c);){if(0===o)break e;o--,l+=n[a++]<<c,c+=8}if(0===(240&w)){for(b=p,y=w,Z=g;w=(E=r.distcode[Z+((l&(1<<b+y)-1)>>b)])>>>16&255,g=65535&E,!(b+(p=E>>>24)<=c);){if(0===o)break e;o--,l+=n[a++]<<c,c+=8}l>>>=b,c-=b,r.back+=b}if(l>>>=p,c-=p,r.back+=p,64&w){e.msg="invalid distance code",r.mode=nr;break}r.offset=g,r.extra=15&w,r.mode=24;case 24:if(r.extra){for(x=r.extra;c<x;){if(0===o)break e;o--,l+=n[a++]<<c,c+=8}r.offset+=l&(1<<r.extra)-1,l>>>=r.extra,c-=r.extra,r.back+=r.extra}if(r.offset>r.dmax){e.msg="invalid distance too far back",r.mode=nr;break}r.mode=25;case 25:if(0===u)break e;if(d=f-u,r.offset>d){if((d=r.offset-d)>r.whave&&r.sane){e.msg="invalid distance too far back",r.mode=nr;break}d>r.wnext?(d-=r.wnext,v=r.wsize-d):v=r.wnext-d,d>r.length&&(d=r.length),m=r.window}else m=i,v=s-r.offset,d=r.length;d>u&&(d=u),u-=d,r.length-=d;do{i[s++]=m[v++]}while(--d);0===r.length&&(r.mode=21);break;case 26:if(0===u)break e;i[s++]=r.length,u--,r.mode=21;break;case 27:if(r.wrap){for(;c<32;){if(0===o)break e;o--,l|=n[a++]<<c,c+=8}if(f-=u,e.total_out+=f,r.total+=f,f&&(e.adler=r.check=r.flags?ye(r.check,i,f,s-f):ge(r.check,i,f,s-f)),f=u,(r.flags?l:ir(l))!==r.check){e.msg="incorrect data check",r.mode=nr;break}l=0,c=0}r.mode=28;case 28:if(r.wrap&&r.flags){for(;c<32;){if(0===o)break e;o--,l+=n[a++]<<c,c+=8}if(l!==(4294967295&r.total)){e.msg="incorrect length check",r.mode=nr;break}l=0,c=0}r.mode=29;case 29:k=Yt;break e;case nr:k=Xt;break e;case 31:return $t;default:return Kt}return e.next_out=s,e.avail_out=u,e.next_in=a,e.avail_in=o,r.hold=l,r.bits=c,(r.wsize||f!==e.avail_out&&r.mode<nr&&(r.mode<27||t!==Pt))&&vr(e,e.output,e.next_out,f-e.avail_out),h-=e.avail_in,f-=e.avail_out,e.total_in+=h,e.total_out+=f,r.total+=f,r.wrap&&f&&(e.adler=r.check=r.flags?ye(r.check,i,f,e.next_out-f):ge(r.check,i,f,e.next_out-f)),e.data_type=r.bits+(r.last?64:0)+(r.mode===rr?128:0)+(20===r.mode||15===r.mode?256:0),(0===h&&0===f||t===Pt)&&k===Ht&&(k=er),k},inflateEnd:function(e){if(!e||!e.state)return Kt;var t=e.state;return t.window&&(t.window=null),e.state=null,Ht},inflateGetHeader:function(e,t){if(!e||!e.state)return Kt;var r=e.state;return 0===(2&r.wrap)?Kt:(r.head=t,t.done=!1,Ht)},inflateSetDictionary:function(e,t){var r,n=t.length;return e&&e.state?0!==(r=e.state).wrap&&11!==r.mode?Kt:11===r.mode&&ge(1,t,n,0)!==r.check?Xt:vr(e,t,n,n)?(r.mode=31,$t):(r.havedict=1,Ht):Kt},inflateInfo:"pako inflate (from Nodeca project)"};var pr=function(){this.text=0,this.time=0,this.xflags=0,this.os=0,this.extra=null,this.extra_len=0,this.name="",this.comment="",this.hcrc=0,this.done=!1},wr=Object.prototype.toString,gr=_e.Z_NO_FLUSH,br=_e.Z_FINISH,yr=_e.Z_OK,Zr=_e.Z_STREAM_END,_r=_e.Z_NEED_DICT,kr=_e.Z_STREAM_ERROR,Ar=_e.Z_DATA_ERROR,xr=_e.Z_MEM_ERROR;function Er(e){this.options=gt({chunkSize:65536,windowBits:15,to:""},e||{});var t=this.options;t.raw&&t.windowBits>=0&&t.windowBits<16&&(t.windowBits=-t.windowBits,0===t.windowBits&&(t.windowBits=-15)),!(t.windowBits>=0&&t.windowBits<16)||e&&e.windowBits||(t.windowBits+=32),t.windowBits>15&&t.windowBits<48&&0===(15&t.windowBits)&&(t.windowBits|=15),this.err=0,this.msg="",this.ended=!1,this.chunks=[],this.strm=new Et,this.strm.avail_out=0;var r=mr.inflateInit2(this.strm,t.windowBits);if(r!==yr)throw new Error(Ze[r]);if(this.header=new pr,mr.inflateGetHeader(this.strm,this.header),t.dictionary&&("string"===typeof t.dictionary?t.dictionary=kt(t.dictionary):"[object ArrayBuffer]"===wr.call(t.dictionary)&&(t.dictionary=new Uint8Array(t.dictionary)),t.raw&&(r=mr.inflateSetDictionary(this.strm,t.dictionary))!==yr))throw new Error(Ze[r])}function Sr(e,t){var r=new Er(t);if(r.push(e),r.err)throw r.msg||Ze[r.err];return r.result}Er.prototype.push=function(e,t){var r,n,i,a=this.strm,s=this.options.chunkSize,o=this.options.dictionary;if(this.ended)return!1;for(n=t===~~t?t:!0===t?br:gr,"[object ArrayBuffer]"===wr.call(e)?a.input=new Uint8Array(e):a.input=e,a.next_in=0,a.avail_in=a.input.length;;){for(0===a.avail_out&&(a.output=new Uint8Array(s),a.next_out=0,a.avail_out=s),(r=mr.inflate(a,n))===_r&&o&&((r=mr.inflateSetDictionary(a,o))===yr?r=mr.inflate(a,n):r===Ar&&(r=_r));a.avail_in>0&&r===Zr&&a.state.wrap>0&&0!==e[a.next_in];)mr.inflateReset(a),r=mr.inflate(a,n);switch(r){case kr:case Ar:case _r:case xr:return this.onEnd(r),this.ended=!0,!1}if(i=a.avail_out,a.next_out&&(0===a.avail_out||r===Zr))if("string"===this.options.to){var u=xt(a.output,a.next_out),l=a.next_out-u,c=At(a.output,u);a.next_out=l,a.avail_out=s-l,l&&a.output.set(a.output.subarray(u,u+l),0),this.onData(c)}else this.onData(a.output.length===a.next_out?a.output:a.output.subarray(0,a.next_out));if(r!==yr||0!==i){if(r===Zr)return r=mr.inflateEnd(this.strm),this.onEnd(r),this.ended=!0,!0;if(0===a.avail_in)break}}return!0},Er.prototype.onData=function(e){this.chunks.push(e)},Er.prototype.onEnd=function(e){e===yr&&("string"===this.options.to?this.result=this.chunks.join(""):this.result=bt(this.chunks)),this.chunks=[],this.err=e,this.msg=this.strm.msg};var Or={Inflate:Er,inflate:Sr,inflateRaw:function(e,t){return(t=t||{}).raw=!0,Sr(e,t)},ungzip:Sr,constants:_e},Ir=Or.Inflate,Cr=Or.ungzip,Rr=r(1025);function Nr(e,t,r,n,i){i("no support for file paths in the browser context")}function Mr(e,t){if(!(t in e.children))return null;if("DataSet"!==e.children[t])return null;var r=e.open(t);return"String"!==r.type?null:r.load()}function Fr(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},r=t.limit,n=void 0===r?50:r;if(e instanceof Array){var i=Array.from(new Set(e));i.sort();var a=!1;return i.length>n&&(i=i.slice(0,n),a=!0),{type:"categorical",values:i,truncated:a}}var s=Number.POSITIVE_INFINITY,o=Number.NEGATIVE_INFINITY;return e.forEach((function(e){e<s&&(s=e),e>o&&(o=e)})),{type:"continuous",min:s,max:o}}function Dr(e,t){return null!==t?t:(r=e instanceof Uint8Array?e:function(e,t){throw new Error("no support for file paths in the browser context")}()).length>=3&&31==r[0]&&139==r[1]&&8==r[2]?"gz":"none";var r}function zr(e,t){var r,i=0,a=(0,n.Z)(e);try{for(a.s();!(r=a.n()).done;){i+=r.value.length}}catch(Ke){a.e(Ke)}finally{a.f()}var s=new Uint8Array(i);i=0;var o,u=(0,n.Z)(e);try{for(u.s();!(o=u.n()).done;){var l=o.value;s.set(l,i),i+=l.length}}catch(Ke){u.e(Ke)}finally{u.f()}return t.decode(s)}function Br(e,t,r,n){return Wr.apply(this,arguments)}function Wr(){return(Wr=(0,u.Z)(g.mark((function e(t,r,n,i){return g.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if("string"==typeof t||t instanceof Uint8Array||(t=t instanceof M?t.content():new M(t,{name:"dummy"}).content()),"gz"!=Dr(t,r)){e.next=5;break}return e.next=4,new Promise((function(e,r){var a=new Ir({chunkSize:n});a.onData=i,a.onEnd=function(t){t?r("gzip decompression failed; "+a.msg):e(null)},"string"==typeof t?Nr(0,0,0,0,r):a.push(t)}));case 4:case 8:return e.abrupt("return");case 5:if("string"!=typeof t){e.next=9;break}return e.next=8,new Promise((function(e,t){return Nr(0,0,0,0,t)}));case 9:return i(t),e.abrupt("return");case 11:case"end":return e.stop()}}),e)})))).apply(this,arguments)}function Gr(e){return jr.apply(this,arguments)}function jr(){return jr=(0,u.Z)(g.mark((function e(t){var r,n,i,a,s,o,u,l,c,h=arguments;return g.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return r=h.length>1&&void 0!==h[1]?h[1]:{},n=r.compression,i=void 0===n?null:n,a=r.chunkSize,s=void 0===a?65536:a,o=new TextDecoder,u=[],l=[],c=function(e){for(var t=0,r=0;r<e.length;r++)if(10==e[r]){var n=e.subarray(t,r);u.length?(u.push(n),l.push(zr(u,o)),u=[]):l.push(o.decode(n)),t=r+1}t!=e.length&&u.push(e.slice(t))},e.next=7,Br(t,i,s,c);case 7:return u.length&&l.push(zr(u,o)),e.abrupt("return",l);case 9:case"end":return e.stop()}}),e)}))),jr.apply(this,arguments)}function Tr(e){return Qr.apply(this,arguments)}function Qr(){return Qr=(0,u.Z)(g.mark((function e(t){var r,i,a,s,o,u,l,c,h,f,d,v,m,p,w=arguments;return g.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return r=w.length>1&&void 0!==w[1]?w[1]:{},i=r.compression,a=void 0===i?null:i,s=r.delim,o=void 0===s?"\t":s,u=r.chunkSize,l=void 0===u?1048576:u,c=new TextDecoder,h=[],f=function(e){var t=Rr.parse(e,{delimiter:o});if(t.meta.aborted){var r,i="failed to parse delimited file",a=(0,n.Z)(t.errors);try{for(a.s();!(r=a.n()).done;){i+="; "+r.value.message}}catch(Ke){a.e(Ke)}finally{a.f()}throw new Error(i)}var s,u=(0,n.Z)(t.data);try{for(u.s();!(s=u.n()).done;){var l=s.value;h.push(l)}}catch(Ke){u.e(Ke)}finally{u.f()}},d=[],v=0,m=function(e){for(var t=0,r=0;r<e.length;r++)if(10==e[r]&&r-t+v>=l){var n=e.subarray(t,r);d.length?(d.push(n),f(zr(d,c)),d=[]):f(c.decode(n)),t=r+1,v=0}t!=e.length&&(d.push(e.slice(t)),v+=e.length-t)},e.next=9,Br(t,a,l,m);case 9:return d.length&&(p=zr(d,c),f(p),"\n"==p[p.length-1]&&h.pop()),e.abrupt("return",h);case 11:case"end":return e.stop()}}),e)}))),Qr.apply(this,arguments)}function Ur(e){for(var t=new Float64Array(e.length),r=0,n=Object.entries(e);r<n.length;r++){var i=(0,o.Z)(n[r],2),a=i[0],s=i[1],u=Number(s),l=parseFloat(s);if(isNaN(u)||isNaN(l))if(""===s||"NA"===s||"na"==s||"NaN"==s||"nan"==s)t[a]=NaN;else if("Inf"==s||"inf"==s)t[a]=Number.POSITIVE_INFINITY;else{if("-Inf"!=s&&"-inf"!=s)return null;t[a]=Number.NEGATIVE_INFINITY}else t[a]=u}return t}var qr=r(8497);function Pr(e){var t={};return t[""]=e,t}function Lr(e,t){return t?y.bl(e):e}function Vr(e,t,r){if(e.hasColumn(t)){var n=qr.L(e.column(t)),i=y.bl(e,{deepCopy:!1});return i.$removeColumn(t),y.Tm(i,n)}return Pr(Lr(e,r))}function Hr(e,t,r,n){var i={matrix:new b.MultiMatrix};try{var a,s=e.matrix,o=e.row_ids;if(i.matrix.add("",s),null!==o?a=y.Nd(t,o):(a=Lr(t,n),(o=new Int32Array(s.numberOfRows())).forEach((function(e,t){o[t]=t}))),null!==r&&a.hasColumn(r)){var u=qr.L(a.column(r)),l=Object.keys(u);if(l.length>1){var c=new b.MultiMatrix({store:b.splitRows(s,u)});b.free(i.matrix),i.matrix=c}else i.matrix.rename("",l[0]);delete a[r],i.features=y.Tm(a,u),i.row_ids=y.Tm(o,u)}else i.row_ids=Pr(o),i.features=Pr(a)}catch(h){throw b.free(i.matrix),h}return i}var Yr=new WeakMap,Jr=new WeakMap,Kr=new WeakMap,Xr=new WeakMap,$r=new WeakMap,en=new WeakSet,tn=new WeakSet,rn=new WeakSet,nn=function(){function e(t){(0,c.Z)(this,e),(0,f.Z)(this,rn),(0,f.Z)(this,tn),(0,f.Z)(this,en),(0,d.Z)(this,Yr,{writable:!0,value:void 0}),(0,d.Z)(this,Jr,{writable:!0,value:void 0}),(0,d.Z)(this,Kr,{writable:!0,value:void 0}),(0,d.Z)(this,Xr,{writable:!0,value:void 0}),(0,d.Z)(this,$r,{writable:!0,value:void 0}),t instanceof M?(0,w.Z)(this,Yr,t):(0,w.Z)(this,Yr,new M(t)),this.clear()}return(0,h.Z)(e,[{key:"clear",value:function(){"function"==typeof(0,p.Z)(this,Kr)&&(0,p.Z)(this,Kr).call(this),(0,w.Z)(this,Kr,null),(0,w.Z)(this,Jr,null),(0,w.Z)(this,Xr,null),(0,w.Z)(this,$r,null)}},{key:"abbreviate",value:function(){return{h5:{name:(0,p.Z)(this,Yr).name(),size:(0,p.Z)(this,Yr).size()}}}},{key:"annotations",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t=e.cache,r=void 0!==t&&t;(0,v.Z)(this,tn,sn).call(this),(0,v.Z)(this,rn,on).call(this);var n={features:Vr((0,p.Z)(this,Xr),"type",r),cells:{number:(0,p.Z)(this,$r).numberOfColumns(),summary:{}}};return r||this.clear(),n}},{key:"load",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t=e.cache,r=void 0!==t&&t;(0,v.Z)(this,tn,sn).call(this),(0,v.Z)(this,rn,on).call(this);var n=b.initializeSparseMatrixFromHDF5((0,p.Z)(this,Jr),"matrix"),i=Hr(n,(0,p.Z)(this,Xr),"type",r);return i.cells=Lr((0,p.Z)(this,$r),r),r||this.clear(),i}},{key:"serialize",value:function(){return[{type:"h5",file:(0,p.Z)(this,Yr)}]}}],[{key:"format",value:function(){return"10X"}},{key:"unserialize",value:function(){var t=(0,u.Z)(g.mark((function t(r){return g.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(1==r.length&&"h5"==r[0].type){t.next=2;break}throw new Error("expected exactly one file of type 'h5' for 10X HDF5 unserialization");case 2:return t.abrupt("return",new e(r[0].file));case 3:case"end":return t.stop()}}),t)})));return function(e){return t.apply(this,arguments)}}()}]),e}();function an(){if(null===(0,p.Z)(this,Jr)){var e=b.realizeFile((0,p.Z)(this,Yr).content());(0,w.Z)(this,Jr,e.path),(0,w.Z)(this,Kr,e.flush)}}function sn(){if(null===(0,p.Z)(this,Xr)){(0,v.Z)(this,en,an).call(this);var e=new b.H5File((0,p.Z)(this,Jr));if(!("matrix"in e.children)||"Group"!=e.children.matrix)throw new Error("expected a 'matrix' group at the top level of the file");var t=e.open("matrix");if(!("features"in t.children)||"Group"!=t.children.features)throw new Error("expected a 'matrix/features' group containing the feature annotation");var r=t.open("features"),n=Mr(r,"id");if(null==n)throw new Error("expected a 'matrix/features/id' string dataset containing the feature IDs");var i={id:n},a=Mr(r,"name");null!==a&&(i.name=a);var s=Mr(r,"feature_type");null!==s&&(i.type=s),(0,w.Z)(this,Xr,new Z.N(i))}}function on(){if(null===(0,p.Z)(this,$r)){(0,v.Z)(this,en,an).call(this);var e=b.extractHDF5MatrixDetails((0,p.Z)(this,Jr),"matrix");(0,w.Z)(this,$r,new Z.N({},{numberOfRows:e.columns}))}}var un=new WeakMap,ln=new WeakMap,cn=new WeakMap,hn=new WeakMap,fn=new WeakMap,dn=new WeakMap,vn=new WeakMap,mn=new WeakMap,pn=new WeakMap,wn=new WeakSet,gn=new WeakSet,bn=new WeakSet,yn=new WeakSet,Zn=new WeakSet,_n=function(){function e(t){(0,c.Z)(this,e),(0,f.Z)(this,Zn),(0,f.Z)(this,yn),(0,f.Z)(this,bn),(0,f.Z)(this,gn),(0,f.Z)(this,wn),(0,d.Z)(this,un,{writable:!0,value:void 0}),(0,d.Z)(this,ln,{writable:!0,value:void 0}),(0,d.Z)(this,cn,{writable:!0,value:void 0}),(0,d.Z)(this,hn,{writable:!0,value:void 0}),(0,d.Z)(this,fn,{writable:!0,value:void 0}),(0,d.Z)(this,dn,{writable:!0,value:void 0}),(0,d.Z)(this,vn,{writable:!0,value:void 0}),(0,d.Z)(this,mn,{writable:!0,value:void 0}),(0,d.Z)(this,pn,{writable:!0,value:void 0}),t instanceof M?(0,w.Z)(this,un,t):(0,w.Z)(this,un,new M(t)),this.clear()}return(0,h.Z)(e,[{key:"clear",value:function(){"function"==typeof(0,p.Z)(this,cn)&&(0,p.Z)(this,cn).call(this),(0,w.Z)(this,cn,null),(0,w.Z)(this,ln,null),(0,w.Z)(this,hn,null),(0,w.Z)(this,fn,null),(0,w.Z)(this,dn,null),(0,w.Z)(this,vn,null),(0,w.Z)(this,mn,null),(0,w.Z)(this,pn,null)}},{key:"abbreviate",value:function(){return{h5:{name:(0,p.Z)(this,un).name(),size:(0,p.Z)(this,un).size()}}}},{key:"annotations",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t=e.cache,r=void 0!==t&&t;(0,v.Z)(this,yn,En).call(this),(0,v.Z)(this,Zn,Sn).call(this);var i,a={},s=(0,n.Z)((0,p.Z)(this,dn).columnNames());try{for(s.s();!(i=s.n()).done;){var o=i.value,u=void 0;u=o in(0,p.Z)(this,vn)?(0,p.Z)(this,vn)[o]:(0,p.Z)(this,dn).column(o),a[o]=Fr(u)}}catch(Ke){s.e(Ke)}finally{s.f()}var l={features:{"":Lr((0,p.Z)(this,fn),r)},cells:{number:(0,p.Z)(this,dn).numberOfColumns(),summary:a}};return r||this.clear(),l}},{key:"load",value:function(){var e=this,t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},r=t.cache,i=void 0!==r&&r;(0,v.Z)(this,yn,En).call(this),(0,v.Z)(this,Zn,Sn).call(this),(0,v.Z)(this,gn,An).call(this);var a,s=function(t,r,n){var i=(0,p.Z)(e,vn)[r],a=new Array(n.length);n.forEach((function(e,t){a[t]=i[e]})),t.$setColumn(r,a)},o=(0,p.Z)(this,dn);if(i){a=new Z.N({},{numberOfRows:o.numberOfRows(),metadata:y.bl(o.metadata())});var u,l=(0,n.Z)(o.columnNames());try{for(l.s();!(u=l.n()).done;){var c=u.value,h=o.column(c);c in(0,p.Z)(this,vn)?s(a,c,h):a.$setColumn(c,y.bl(h))}}catch(Ke){l.e(Ke)}finally{l.f()}}else{a=o;var f,d=(0,n.Z)(a.columnNames());try{for(d.s();!(f=d.n()).done;){var m=f.value;m in(0,p.Z)(this,vn)&&s(a,m,a.column(m))}}catch(Ke){d.e(Ke)}finally{d.f()}}var w=b.initializeSparseMatrixFromHDF5((0,p.Z)(this,ln),(0,p.Z)(this,mn)),g=Hr(w,(0,p.Z)(this,fn),null,i);return g.cells=a,i||this.clear(),g}},{key:"serialize",value:function(){return[{type:"h5",file:(0,p.Z)(this,un)}]}}],[{key:"format",value:function(){return"H5AD"}},{key:"unserialize",value:function(){var t=(0,u.Z)(g.mark((function t(r){return g.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(1==r.length&&"h5"==r[0].type){t.next=2;break}throw new Error("expected exactly one file of type 'h5' for H5AD unserialization");case 2:return t.abrupt("return",new e(r[0].file));case 3:case"end":return t.stop()}}),t)})));return function(e){return t.apply(this,arguments)}}()}]),e}();function kn(){if(null==(0,p.Z)(this,ln)){var e=b.realizeFile((0,p.Z)(this,un).content());(0,w.Z)(this,ln,e.path),(0,w.Z)(this,cn,e.flush),(0,w.Z)(this,hn,new b.H5File((0,p.Z)(this,ln)))}}function An(){if(null===(0,p.Z)(this,mn)){if(!("X"in(0,p.Z)(this,hn).children)){if(!("layers"in(0,p.Z)(this,hn).children))throw new Error("expected 'X' or 'layers' in a H5AD file");var e=(0,p.Z)(this,hn).open("layers");if(!(e instanceof b.H5Group))throw new Error("expected a 'layers' group in a H5AD file");for(var t=0,r=Object.keys(e.children);t<r.length;t++){var n=r[t];if(n.match(/^count/i))return void(0,w.Z)(this,mn,"layers/"+n)}throw new Error("failed to find any count-like layer in a H5AD file")}(0,w.Z)(this,mn,"X")}}function xn(){null===(0,p.Z)(this,pn)&&((0,v.Z)(this,gn,An).call(this),(0,w.Z)(this,pn,b.extractHDF5MatrixDetails((0,p.Z)(this,ln),(0,p.Z)(this,mn))))}function En(){if(null===(0,p.Z)(this,fn)){(0,v.Z)(this,wn,kn).call(this);var e=(0,p.Z)(this,hn);if("var"in e.children&&"Group"==e.children.var){var t=e.open("var"),r=Mr(t,"_index");if(null!==r){for(var n={_index:r},i=0,a=Object.entries(t.children);i<a.length;i++){var s=(0,o.Z)(a[i],2),u=s[0];if("DataSet"===s[1]&&(u.match(/name/i)||u.match(/symb/i))){var l=t.open(u);"String"==l.type&&(n[u]=l.load())}}return void(0,w.Z)(this,fn,new Z.N(n))}}(0,v.Z)(this,bn,xn).call(this),(0,w.Z)(this,fn,new Z.N({},{numberOfRows:(0,p.Z)(this,pn).rows}))}}function Sn(){if(null===(0,p.Z)(this,dn)){(0,v.Z)(this,wn,kn).call(this);var e=(0,p.Z)(this,hn),t={},r={};if("obs"in e.children&&"Group"==e.children.obs){var n=e.open("obs"),i=Mr(n,"_index");null!==i&&(t._index=i);for(var a=0,s=Object.entries(n.children);a<s.length;a++){var u=(0,o.Z)(s[a],2),l=u[0];if("DataSet"==u[1]){var c=n.open(l,{load:!0});t[l]=c.values}}if("__categories"in n.children&&"Group"==n.children.__categories)for(var h=n.open("__categories"),f=0,d=Object.entries(h.children);f<d.length;f++){var m=(0,o.Z)(d[f],2),g=m[0];m[1];g in t&&(r[g]=Mr(h,g))}}0==Object.keys(t).length?((0,v.Z)(this,bn,xn).call(this),(0,w.Z)(this,dn,new Z.N({},{numberOfRows:(0,p.Z)(this,pn).columns}))):(0,w.Z)(this,dn,new Z.N(t)),(0,w.Z)(this,vn,r)}}var On=new WeakMap,In=new WeakMap,Cn=new WeakMap,Rn=new WeakMap,Nn=new WeakMap,Mn=new WeakMap,Fn=new WeakSet,Dn=new WeakSet,zn=new WeakSet,Bn=function(){function e(t,r,n){(0,c.Z)(this,e),(0,f.Z)(this,zn),(0,f.Z)(this,Dn),(0,f.Z)(this,Fn),(0,d.Z)(this,On,{writable:!0,value:void 0}),(0,d.Z)(this,In,{writable:!0,value:void 0}),(0,d.Z)(this,Cn,{writable:!0,value:void 0}),(0,d.Z)(this,Rn,{writable:!0,value:void 0}),(0,d.Z)(this,Nn,{writable:!0,value:void 0}),(0,d.Z)(this,Mn,{writable:!0,value:void 0}),t instanceof M?(0,w.Z)(this,On,t):(0,w.Z)(this,On,new M(t)),r instanceof M||null==r?(0,w.Z)(this,In,r):(0,w.Z)(this,In,new M(r)),n instanceof M||null==n?(0,w.Z)(this,Cn,n):(0,w.Z)(this,Cn,new M(n)),this.clear()}return(0,h.Z)(e,[{key:"clear",value:function(){(0,w.Z)(this,Rn,null),(0,w.Z)(this,Nn,null),(0,w.Z)(this,Mn,null)}},{key:"abbreviate",value:function(e){var t={matrix:{name:(0,p.Z)(this,On).name(),size:(0,p.Z)(this,On).size()}};return null!==(0,p.Z)(this,In)&&(t.features={name:(0,p.Z)(this,In).name(),size:(0,p.Z)(this,In).size()}),null!==(0,p.Z)(this,Cn)&&(t.barcodes={name:(0,p.Z)(this,Cn).name(),size:(0,p.Z)(this,Cn).size()}),t}},{key:"annotations",value:function(){var e=(0,u.Z)(g.mark((function e(){var t,r,i,a,s,o,u,l,c=arguments;return g.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return t=c.length>0&&void 0!==c[0]?c[0]:{},r=t.cache,i=void 0!==r&&r,e.next=3,(0,v.Z)(this,Dn,Gn).call(this);case 3:return e.next=5,(0,v.Z)(this,zn,Tn).call(this);case 5:a={},s=(0,n.Z)((0,p.Z)(this,Mn).columnNames());try{for(s.s();!(o=s.n()).done;)u=o.value,a[u]=Fr((0,p.Z)(this,Mn).column(u))}catch(Ke){s.e(Ke)}finally{s.f()}return l={features:Vr((0,p.Z)(this,Nn),"type",i),cells:{number:(0,p.Z)(this,Mn).numberOfRows(),summary:a}},i||this.clear(),e.abrupt("return",l);case 11:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}()},{key:"load",value:function(){var e=(0,u.Z)(g.mark((function e(){var t,r,n,i,a,s,o=arguments;return g.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return t=o.length>0&&void 0!==o[0]?o[0]:{},r=t.cache,n=void 0!==r&&r,e.next=3,(0,v.Z)(this,Dn,Gn).call(this);case 3:return e.next=5,(0,v.Z)(this,zn,Tn).call(this);case 5:return i=(0,p.Z)(this,On).name().endsWith(".gz"),a=b.initializeSparseMatrixFromMatrixMarket((0,p.Z)(this,On).content(),{compressed:i}),(s=Hr(a,(0,p.Z)(this,Nn),"type",n)).cells=Lr((0,p.Z)(this,Mn),n),n||this.clear(),e.abrupt("return",s);case 11:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}()},{key:"serialize",value:function(){var e=(0,u.Z)(g.mark((function e(){var t;return g.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return t=[{type:"mtx",file:(0,p.Z)(this,On)}],null!==(0,p.Z)(this,In)&&t.push({type:"genes",file:(0,p.Z)(this,In)}),null!==(0,p.Z)(this,Cn)&&t.push({type:"annotations",file:(0,p.Z)(this,Cn)}),e.abrupt("return",t);case 4:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}()}],[{key:"format",value:function(){return"MatrixMarket"}},{key:"unserialize",value:function(){var t=(0,u.Z)(g.mark((function t(r){var i,a,s,o,u,l;return g.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:i={},a=(0,n.Z)(r),t.prev=2,a.s();case 4:if((s=a.n()).done){t.next=11;break}if(!((o=s.value).type in i)){t.next=8;break}throw new Error("duplicate file of type '"+o.type+"' detected during MatrixMarket unserialization");case 8:i[o.type]=o.file;case 9:t.next=4;break;case 11:t.next=16;break;case 13:t.prev=13,t.t0=t.catch(2),a.e(t.t0);case 16:return t.prev=16,a.f(),t.finish(16);case 19:if("mtx"in i){t.next=21;break}throw new Error("expected file of type 'mtx' for during MatrixMarket unserialization");case 21:return u=null,"genes"in i&&(u=i.genes),l=null,"annotations"in i&&(l=i.annotations),t.abrupt("return",new e(i.mtx,u,l));case 26:case"end":return t.stop()}}),t,null,[[2,13,16,19]])})));return function(e){return t.apply(this,arguments)}}()}]),e}();function Wn(){if(null===(0,p.Z)(this,Rn)){var e=(0,p.Z)(this,On).name().endsWith(".gz"),t=b.extractMatrixMarketDimensions((0,p.Z)(this,On).content(),{compressed:e});(0,w.Z)(this,Rn,[t.rows,t.columns])}}function Gn(){return jn.apply(this,arguments)}function jn(){return(jn=(0,u.Z)(g.mark((function e(){var t,r,n,i,a,s,o,u,l;return g.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(null===(0,p.Z)(this,Nn)){e.next=2;break}return e.abrupt("return");case 2:if((0,v.Z)(this,Fn,Wn).call(this),t=(0,p.Z)(this,Rn)[0],null!=(0,p.Z)(this,In)){e.next=7;break}return(0,w.Z)(this,Nn,new Z.N({},{numberOfRows:t})),e.abrupt("return");case 7:return r=(0,p.Z)(this,In).name(),n=r.endsWith(".gz"),e.next=11,Tr((0,p.Z)(this,In).content(),{compression:n?"gz":"none"});case 11:if((i=e.sent).length!=t+1){e.next=18;break}return a={},i.shift().forEach((function(e,t){a[e]=i.map((function(e){return e[t]}))})),(0,w.Z)(this,Nn,a),e.abrupt("return");case 18:if(i.length===t){e.next=20;break}throw new Error("number of matrix rows is not equal to the number of rows in '"+r+"'");case 20:return s=[],o=[],i.forEach((function(e){s.push(e[0]),o.push(e[1])})),u={id:s,symbol:o},i[0].length>=3&&(l=[],i.forEach((function(e){l.push(e[2])})),u.type=l),(0,w.Z)(this,Nn,new Z.N(u)),e.abrupt("return");case 26:case"end":return e.stop()}}),e,this)})))).apply(this,arguments)}function Tn(){return Qn.apply(this,arguments)}function Qn(){return(Qn=(0,u.Z)(g.mark((function e(){var t,r,n,i,a,s,u,l,c,h,f,d;return g.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(null===(0,p.Z)(this,Mn)){e.next=2;break}return e.abrupt("return");case 2:if((0,v.Z)(this,Fn,Wn).call(this),null!=(0,p.Z)(this,Cn)){e.next=6;break}return(0,w.Z)(this,Mn,new Z.N({},{numberOfRows:(0,p.Z)(this,Rn)[1]})),e.abrupt("return");case 6:return t=(0,p.Z)(this,Cn).name(),r=t.endsWith(".gz"),e.next=10,Tr((0,p.Z)(this,Cn).content(),{compression:r?"gz":"none"});case 10:if(n=e.sent,0!=(i=(0,p.Z)(this,Rn)[1]-n.length)){e.next=16;break}a=n[0],e.next=21;break;case 16:if(-1!=i){e.next=20;break}a=n.shift(),e.next=21;break;case 20:throw new Error("number of matrix columns is not equal to the number of rows in '"+t+"'");case 21:for(s={},a.forEach((function(e,t){s[e]=n.map((function(e){return e[t]}))})),u=0,l=Object.entries(s);u<l.length;u++)c=(0,o.Z)(l[u],2),h=c[0],f=c[1],null!==(d=Ur(f))&&(s[h]=d);return(0,w.Z)(this,Mn,new Z.N(s)),e.abrupt("return");case 26:case"end":return e.stop()}}),e,this)})))).apply(this,arguments)}function Un(e){var t,r,n=e.findAttribute("names");if(n<0)return null;try{r=(t=e.attribute(n)).values()}catch(i){throw new Error("failed to load listData names; "+i.message)}finally{b.free(t)}if(r.length!=e.length())throw new Error("expected names to have same length as listData");return r}function qn(e){Pn(e,{DFrame:"S4Vectors"},"DFrame");var t,r,n,i={},a={};try{if(!((t=e.attribute("listData"))instanceof b.RdsGenericVector))throw new Error("listData slot should be a generic list");var s=Un(t);if(null==s)throw new Error("expected the listData list to be named");for(var o=0;o<t.length();o++){var u=void 0;try{if((u=t.load(o))instanceof b.RdsVector&&!(u instanceof b.RdsGenericVector)){var l=u.values();a[s[o]]=l,i.nrow=l.length}}finally{b.free(u)}}}catch(h){throw new Error("failed to retrieve data from DataFrame's listData; "+h.message)}finally{b.free(t)}i.columns=a;try{(r=e.attribute("rownames"))instanceof b.RdsStringVector&&(i.row_names=r.values(),i.nrow=i.row_names.length)}catch(h){throw new Error("failed to retrieve row names from DataFrame; "+h.message)}finally{b.free(r)}if(!("nrow"in i))try{if(!((n=e.attribute("nrows"))instanceof b.RdsIntegerVector))throw new Error("expected an integer vector as the 'nrows' slot");var c=n.values();if(1!=c.length)throw new Error("expected an integer vector of length 1 as the 'nrows' slot");i.nrow=c[0]}catch(h){throw new Error("failed to retrieve nrows from DataFrame; "+h.message)}finally{b.free(n)}return i}function Pn(e,t,r){if(!(e instanceof b.RdsS4Object))throw new Error("expected an S4 object as the data frame");for(var n=0,i=Object.entries(t);n<i.length;n++){var a=(0,o.Z)(i[n],2),s=a[0],u=a[1];if(e.className()==s&&e.packageName()==u)return}throw new Error("object is not a "+r+" or one of its recognized subclasses")}function Ln(e){var t,r=e.findAttribute("NAMES");if(r<0)return null;var n=null;try{(t=e.attribute(r))instanceof b.RdsStringVector&&(n=t.values())}catch(i){throw new Error("failed to extract NAMES; "+i.message)}finally{b.free(t)}return n}function Vn(e){var t={},r=null,n=e.findAttribute("rowRanges");if(n<0){var i;try{t=qn(i=e.attribute("elementMetadata"))}catch(w){throw new Error("failed to extract features from the rowData; "+w.message)}finally{b.free(i)}r=Ln(e)}else{var a;try{var s=(a=e.attribute(n)).attribute("elementMetadata");try{t=qn(s)}catch(w){throw new Error("failed to extract mcols from the rowRanges; "+w.message)}finally{b.free(s)}var u,l,c=a.findAttribute("partitioning");if(c<0)try{r=Ln(u=a.attribute("ranges"))}catch(w){throw new Error("failed to extract names from the rowRanges; "+w.message)}finally{b.free(u)}else try{r=Ln(l=a.attribute(c))}catch(w){throw new Error("failed to extract names from the rowRanges; "+w.message)}finally{b.free(l)}}catch(w){throw new Error("failed to extract features from the rowRanges; "+w.message)}finally{b.free(a)}}if(null==r)return new Z.N({},{numberOfRows:t.nrow});for(var h={id:r},f=0,d=Object.entries(t.columns);f<d.length;f++){var v=(0,o.Z)(d[f],2),m=v[0],p=v[1];m.match(/^sym/)&&(h[m]=p)}return new Z.N(h)}function Hn(e){var t,r,n,i;try{var a,s=Un(i=(n=(r=e.attribute("assays")).attribute("data")).attribute("listData")),o=1;if(null!=s)for(var u=0;u<s.length;u++)if(s[u].match(/^count/i)){o=u;break}try{a=i.load(o),t=b.initializeSparseMatrixFromRds(a)}catch(l){throw new Error("failed to initialize sparse matrix from assay; "+l.message)}finally{b.free(a)}}catch(l){throw new Error("failed to extract assay data; "+l.message)}finally{b.free(r),b.free(i),b.free(n)}return t}function Yn(e){Pn(e,{SummarizedExperiment:"SummarizedExperiment",RangedSummarizedExperiment:"SummarizedExperiment",SingleCellExperiment:"SingleCellExperiment",SpatialExperiment:"SpatialExperiment"},"SummarizedExperiment")}var Jn=new WeakMap,Kn=new WeakMap,Xn=new WeakMap,$n=new WeakMap,ei=new WeakMap,ti=new WeakMap,ri=new WeakSet,ni=new WeakSet,ii=new WeakSet,ai=function(){function e(t){(0,c.Z)(this,e),(0,f.Z)(this,ii),(0,f.Z)(this,ni),(0,f.Z)(this,ri),(0,d.Z)(this,Jn,{writable:!0,value:void 0}),(0,d.Z)(this,Kn,{writable:!0,value:void 0}),(0,d.Z)(this,Xn,{writable:!0,value:void 0}),(0,d.Z)(this,$n,{writable:!0,value:void 0}),(0,d.Z)(this,ei,{writable:!0,value:void 0}),(0,d.Z)(this,ti,{writable:!0,value:void 0}),t instanceof M?(0,w.Z)(this,Jn,t):(0,w.Z)(this,Jn,new M(t)),this.clear()}return(0,h.Z)(e,[{key:"clear",value:function(){if(b.free((0,p.Z)(this,Xn)),"undefined"!=typeof(0,p.Z)(this,$n)&&null!==(0,p.Z)(this,$n))for(var e=0,t=Object.values((0,p.Z)(this,$n));e<t.length;e++){var r=t[e];b.free(r)}b.free((0,p.Z)(this,Kn)),(0,w.Z)(this,Xn,null),(0,w.Z)(this,$n,null),(0,w.Z)(this,Kn,null),(0,w.Z)(this,ei,null),(0,w.Z)(this,ti,null)}},{key:"abbreviate",value:function(){return{rds:{name:(0,p.Z)(this,Jn).name(),size:(0,p.Z)(this,Jn).size()}}}},{key:"annotations",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t=e.cache,r=void 0!==t&&t;(0,v.Z)(this,ri,si).call(this),(0,v.Z)(this,ni,oi).call(this),(0,v.Z)(this,ii,ui).call(this);var i,a={},s=(0,n.Z)((0,p.Z)(this,ti).columnNames());try{for(s.s();!(i=s.n()).done;){var o=i.value;a[o]=Fr((0,p.Z)(this,ti).column(o))}}catch(Ke){s.e(Ke)}finally{s.f()}var u={features:Lr((0,p.Z)(this,ei),r),cells:{number:(0,p.Z)(this,ti).numberOfColumns(),summary:a}};return r||this.clear(),u}},{key:"load",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t=e.cache,r=void 0!==t&&t;(0,v.Z)(this,ri,si).call(this),(0,v.Z)(this,ni,oi).call(this),(0,v.Z)(this,ii,ui).call(this);var n={matrix:new b.MultiMatrix,row_ids:{},features:{},cells:Lr((0,p.Z)(this,ti),r)};try{var i=Hn((0,p.Z)(this,Xn)),a=i.matrix,s=i.row_ids;n.matrix.add("",a),n.row_ids[""]=s,n.features[""]=y.Nd((0,p.Z)(this,ei)[""],s);for(var u=0,l=Object.entries((0,p.Z)(this,$n));u<l.length;u++){var c=(0,o.Z)(l[u],2),h=c[0],f=c[1],d=Hn(f);n.matrix.add(h,d.matrix),n.row_ids[h]=d.row_ids,n.features[h]=y.Nd((0,p.Z)(this,ei)[h],d.row_ids)}}catch(m){throw b.free(n.matrix),m}return r||this.clear(),n}},{key:"serialize",value:function(){return[{type:"rds",file:(0,p.Z)(this,Jn)}]}}],[{key:"format",value:function(){return"SummarizedExperiment"}},{key:"unserialize",value:function(){var t=(0,u.Z)(g.mark((function t(r){return g.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(1==r.length&&"rds"==r[0].type){t.next=2;break}throw new Error("expected exactly one file of type 'rds' for SummarizedExperiment unserialization");case 2:return t.abrupt("return",new e(r[0].file));case 3:case"end":return t.stop()}}),t)})));return function(e){return t.apply(this,arguments)}}()}]),e}();function si(){if(null===(0,p.Z)(this,Kn)){(0,w.Z)(this,Kn,b.readRds((0,p.Z)(this,Jn).content())),(0,w.Z)(this,Xn,(0,p.Z)(this,Kn).value());try{Yn((0,p.Z)(this,Xn)),(0,w.Z)(this,$n,function(e){var t=e.findAttribute("int_colData");if(t<0)return{};var r,n,i,a,s,o,u={};try{var l=(r=e.attribute(t)).findAttribute("listData");if(l<0)return{};var c=(n=r.attribute(l)).findAttribute("names");if(c<0)return{};var h=(i=n.attribute(c)).values().indexOf("altExps");if(h<0)return{};var f=(a=n.load(h)).findAttribute("listData");if(f<0)return{};var d=(s=a.attribute(f)).findAttribute("names");if(d<0)return{};for(var v=(o=s.attribute(d)).values(),m=0;m<v.length;m++){var p=void 0;try{var w=(p=s.load(m)).attribute("se");u[v[m]]=w,Yn(w)}catch(_){throw new Error("failed to load alternative Experiment '"+v[m]+"'; "+_.message)}finally{b.free(p)}}}catch(_){for(var g=0,y=Object.values(u);g<y.length;g++){var Z=y[g];b.free(Z)}throw _}finally{b.free(o),b.free(s),b.free(i),b.free(n),b.free(r)}return u}((0,p.Z)(this,Xn)))}catch(e){throw(0,p.Z)(this,Xn).free(),(0,p.Z)(this,Kn).free(),e}}}function oi(){if(null===(0,p.Z)(this,ei)){(0,v.Z)(this,ri,si).call(this),(0,w.Z)(this,ei,{"":Vn((0,p.Z)(this,Xn))});for(var e=0,t=Object.entries((0,p.Z)(this,$n));e<t.length;e++){var r=(0,o.Z)(t[e],2),n=r[0],i=r[1];try{(0,p.Z)(this,ei)[n]=Vn(i)}catch(a){console.warn("failed to extract features for alternative Experiment '"+n+"'; "+a.message)}}}}function ui(){if(null===(0,p.Z)(this,ti)){var e;(0,v.Z)(this,ri,si).call(this);var t=(0,p.Z)(this,Xn).attribute("colData");try{e=qn(t)}catch(r){throw new Error("failed to extract colData from a SummarizedExperiment; "+r.message)}finally{b.free(t)}(0,w.Z)(this,ti,new Z.N(e.columns,{numberOfRows:e.nrow}))}}var li={"10X":nn,MatrixMarket:Bn,H5AD:_n,SummarizedExperiment:ai},ci="inputs",hi="raw_subset_indices",fi=new WeakMap,di=new WeakMap,vi=new WeakMap,mi=new WeakMap,pi=new WeakSet,wi=function(){function e(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:null,r=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null,n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:null;(0,c.Z)(this,e),(0,f.Z)(this,pi),(0,d.Z)(this,fi,{writable:!0,value:void 0}),(0,d.Z)(this,di,{writable:!0,value:void 0}),(0,d.Z)(this,vi,{writable:!0,value:void 0}),(0,d.Z)(this,mi,{writable:!0,value:void 0}),(0,w.Z)(this,fi,null===t?{}:t),(0,w.Z)(this,di,null===r?{}:r),(0,w.Z)(this,vi,null===n?{}:n),(0,w.Z)(this,mi,!1),this.changed=!1}return(0,h.Z)(e,[{key:"free",value:function(){k((0,p.Z)(this,di).matrix),k((0,p.Z)(this,di).raw_matrix),k((0,p.Z)(this,di).block_ids),k((0,p.Z)(this,di).raw_block_ids),k((0,p.Z)(this,di).multi_block_ids)}},{key:"listAvailableTypes",value:function(){return(0,p.Z)(this,di).matrix.available()}},{key:"hasAvailable",value:function(e){return(0,p.Z)(this,di).matrix.has(e)}},{key:"fetchCountMatrix",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t=e.type,r=void 0===t?"RNA":t;return(0,p.Z)(this,di).matrix.get(r)}},{key:"fetchGenes",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t=e.type,r=void 0===t?"RNA":t;return(0,p.Z)(this,di).genes[r]}},{key:"fetchRowIds",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t=e.type,r=void 0===t?"RNA":t;return(0,p.Z)(this,di).row_ids[r]}},{key:"fetchAnnotations",value:function(e){var t=(0,p.Z)(this,di).annotations;if(!t.hasColumn(e))throw new Error("".concat(e," does not exist in the column annotations"));return y.bl(t.column(e))}},{key:"fetchBlock",value:function(){return(0,p.Z)(this,di).block_ids}},{key:"fetchBlockLevels",value:function(){return(0,p.Z)(this,di).block_levels}},{key:"fetchParameters",value:function(){var t,r=(0,l.Z)({},(0,p.Z)(this,fi));return r.subset=(0,m.Z)(t=this.constructor,e,gi).call(t,r.subset),r}},{key:"fetchDirectSubset",value:function(){return hi in(0,p.Z)(this,di)?(0,p.Z)(this,di).raw_subset_indices.slice():null}},{key:"enableDatasetCache",value:function(e){(0,w.Z)(this,mi,e)}},{key:"compute",value:function(){var t=(0,u.Z)(g.mark((function t(r,n,i){var a,s,u,l,c,h,f;return g.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(this.changed=!1,null===r){t.next=10;break}for(a={},s=0,u=Object.entries(r);s<u.length;s++)l=(0,o.Z)(u[s],2),c=l[0],h=l[1],a[c]={format:h.constructor.format(),details:h.abbreviate()};if(!x(a,(0,p.Z)(this,vi))){t.next=10;break}return t.next=7,Ci(r,(0,p.Z)(this,di),(0,p.Z)(this,mi));case 7:(0,w.Z)(this,vi,a),(0,p.Z)(this,di).datasets=r,this.changed=!0;case 10:return(this.changed||(0,p.Z)(this,fi).sample_factor!==n)&&(Ni(n,(0,p.Z)(this,di)),(0,p.Z)(this,fi).sample_factor=n,this.changed=!0),(this.changed||!(hi in(0,p.Z)(this,di))&&x(i,(0,p.Z)(this,fi).subset))&&(Mi(i,(0,p.Z)(this,di)),(0,p.Z)(this,fi).subset=(0,m.Z)(f=this.constructor,e,gi).call(f,i),this.changed=!0),t.abrupt("return",null);case 13:case"end":return t.stop()}}),t,this)})));return function(e,r,n){return t.apply(this,arguments)}}()},{key:"undoSubset",value:function(e){var t=null;"subset"in(0,p.Z)(this,fi)&&(t=(0,p.Z)(this,fi).subset);var r=Oi(t,(0,p.Z)(this,di));null!==r&&e.forEach((function(t,n){e[n]=r[t]}))}},{key:"setDirectSubset",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},r=t.copy,n=void 0===r||r,i=t.onOriginal,a=void 0!==i&&i;null!==e?(0,p.Z)(this,di).raw_subset_indices=(0,v.Z)(this,pi,bi).call(this,e,n,a):delete(0,p.Z)(this,di).raw_subset_indices,"matrix"in(0,p.Z)(this,di)&&(Mi((0,p.Z)(this,fi).subset,(0,p.Z)(this,di)),this.changed=!0)}},{key:"createDirectSubset",value:function(t){var r=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},n=r.copy,i=void 0===n||n,a=r.onOriginal,s=void 0!==a&&a,o={};o.raw_subset_indices=(0,v.Z)(this,pi,bi).call(this,t,i,s),o.raw_matrix=(0,p.Z)(this,di).raw_matrix.clone();for(var u=0,l=["multi_block_ids","raw_block_ids"];u<l.length;u++){var c=l[u];c in(0,p.Z)(this,di)&&(null===(0,p.Z)(this,di)[c]?o[c]=null:o[c]=(0,p.Z)(this,di)[c].clone())}for(var h=0,f=["raw_annotations","genes","multi_block_levels","raw_block_levels"];h<f.length;h++){var d=f[h];d in(0,p.Z)(this,di)&&(o[d]=(0,p.Z)(this,di)[d])}Mi(null,o);var m=this.fetchParameters();return m.subset=null,new e(m,o,(0,p.Z)(this,vi))}},{key:"summary",value:function(){var e,t={},r=(0,n.Z)((0,p.Z)(this,di).matrix.available());try{for(r.s();!(e=r.n()).done;){var i=e.value;t[i]=(0,p.Z)(this,di).matrix.get(i).numberOfRows()}}catch(Ke){r.e(Ke)}finally{r.f()}for(var a={},s=0,u=Object.entries((0,p.Z)(this,di).genes);s<u.length;s++){var l,c=(0,o.Z)(u[s],2),h=c[0],f=c[1],d={},v=(0,n.Z)(f.columnNames());try{for(v.s();!(l=v.n()).done;){var m=l.value;d[m]=y.bl(f.column(m))}}catch(Ke){v.e(Ke)}finally{v.f()}a[h]=d}return{num_cells:(0,p.Z)(this,di).matrix.numberOfColumns(),num_genes:t,genes:a,annotations:(0,p.Z)(this,di).annotations.columnNames()}}},{key:"serialize",value:function(){var e=(0,u.Z)(g.mark((function e(t,r){var i,a,o,u,l,c,h,f,d,v,m,w,b,y,Z,_,k,A,x,E,S,O,I,C,R,N,M,F,D,z,B,W,G;return g.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:i=t.createGroup("inputs"),!1,a=i.createGroup("parameters"),(o=Object.keys((0,p.Z)(this,di).datasets)).sort(),u=[],l=[],c=a.createGroup("files"),h=0,f=0,d=o;case 10:if(!(f<d.length)){e.next=57;break}return v=d[f],m=(0,p.Z)(this,di).datasets[v],w=m.constructor.format(),u.push(w),e.next=17,m.serialize();case 17:b=e.sent,l.push(b.length),y=(0,n.Z)(b),e.prev=20,y.s();case 22:if((Z=y.n()).done){e.next=46;break}if(_=Z.value,(k=c.createGroup(String(h))).writeDataSet("type","String",[],_.type),k.writeDataSet("name","String",[],_.file.name()),null!==r){e.next=36;break}if(null!=Gi){e.next=30;break}throw new Error("no valid linking function from 'setCreateLink'");case 30:return e.next=32,Gi(w,_.file);case 32:A=e.sent,k.writeDataSet("id","String",[],A),e.next=43;break;case 36:return e.next=38,r(_.file.content(),_.file.size());case 38:if("number"==typeof(x=e.sent).offset&&"number"==typeof x.size){e.next=41;break}throw new Error("output of 'embeddedSaver' should contain 'offset' and 'size' numbers");case 41:k.writeDataSet("offset","Uint32",[],x.offset),k.writeDataSet("size","Uint32",[],x.size);case 43:h++;case 44:e.next=22;break;case 46:e.next=51;break;case 48:e.prev=48,e.t0=e.catch(20),y.e(e.t0);case 51:return e.prev=51,y.f(),e.finish(51);case 54:f++,e.next=10;break;case 57:if(u.length>1?(!0,a.writeDataSet("format","String",null,u),a.writeDataSet("sample_groups","Int32",null,l),a.writeDataSet("sample_names","String",null,o)):(a.writeDataSet("format","String",[],u[0]),null!==(0,p.Z)(this,fi).sample_factor&&a.writeDataSet("sample_factor","String",[],(0,p.Z)(this,fi).sample_factor)),null===(0,p.Z)(this,fi).subset&&!(hi in(0,p.Z)(this,di))){e.next=71;break}if(E=a.createGroup("subset"),S=E.createGroup("cells"),!(hi in(0,p.Z)(this,di))){e.next=65;break}S.writeDataSet("indices","Int32",null,(0,p.Z)(this,di).raw_subset_indices),e.next=71;break;case 65:if(!("field"in(0,p.Z)(this,fi).subset)){e.next=70;break}S.writeDataSet("field","String",[],(0,p.Z)(this,fi).subset.field),"values"in(0,p.Z)(this,fi).subset?S.writeDataSet("values","String",null,(0,p.Z)(this,fi).subset.values):(I=(0,p.Z)(this,fi).subset.ranges,Ii(C=(O=[]).concat.apply(O,s(I))),S.writeDataSet("ranges","Float64",[C.length/2,2],C)),e.next=71;break;case 70:throw new Error("unrecognized specification for 'subset'");case 71:(R=i.createGroup("results")).writeDataSet("num_cells","Int32",[],(0,p.Z)(this,di).matrix.numberOfColumns()),N=R.createGroup("num_features"),M=(0,n.Z)((0,p.Z)(this,di).matrix.available());try{for(M.s();!(F=M.n()).done;)D=F.value,N.writeDataSet(D,"Int32",[],(0,p.Z)(this,di).matrix.get(D).numberOfRows())}catch(Ke){M.e(Ke)}finally{M.f()}null!==(0,p.Z)(this,di).block_levels&&R.writeDataSet("num_samples","Int32",[],(0,p.Z)(this,di).block_levels.length),z=R.createGroup("identities"),B=(0,n.Z)((0,p.Z)(this,di).matrix.available());try{for(B.s();!(W=B.n()).done;)G=W.value,z.writeDataSet(G,"Int32",null,(0,p.Z)(this,di).row_ids[G])}catch(Ke){B.e(Ke)}finally{B.f()}return e.abrupt("return");case 81:case"end":return e.stop()}}),e,this,[[20,48,51,54]])})));return function(t,r){return e.apply(this,arguments)}}()}],[{key:"defaults",value:function(){return{sample_factor:null,subset:null}}}]),e}();function gi(e){if(null==e)return e;var t=(0,l.Z)({},e);return"values"in t&&(t.values=t.values.slice()),"ranges"in t&&(t.ranges=t.ranges.map((function(e){return e.slice()}))),t}function bi(e,t,r){return O(e,null),t&&(e=e.slice()),r||this.undoSubset(e),e}function yi(e){for(var t={"symbol-mouse":[],"symbol-human":[],"ensembl-mouse":[],"ensembl-human":[]},r=y.bl(t),i=0;i<e.length;i++){var a,s=e[i],u={},l={},c=(0,n.Z)(s.columnNames());try{for(c.s();!(a=c.n()).done;){var h=a.value,f=s.column(h),d=b.guessFeatures(f),v=d.type+"-"+d.species;(!(v in u)||d.confidence>u[v])&&(u[v]=d.confidence,l[v]=h)}}catch(Ke){c.e(Ke)}finally{c.f()}for(var m=0,p=Object.entries(l);m<p.length;m++){var w=(0,o.Z)(p[m],2),g=w[0],Z=w[1];r[g].push(Z),t[g].push(u[g])}}for(var _=-1e3,k=null,A=0,x=Object.entries(t);A<x.length;A++){var E=(0,o.Z)(x[A],2),S=E[0],O=E[1];if(O.length==e.length){var I=O.reduce((function(e,t){return e*t}));I>_&&(_=I,k=S)}}var C=[],R=null;if(null!==k){var N=r[k],M=k.split("-");R={type:M[0],species:M[1]};for(i=0;i<e.length;i++)C.push(N[i])}return{best_type:R,best_fields:C}}var Zi={RNA:[function(e){return e.match(/gene expression/i)},function(e){return e.match(/^rna/i)},function(e){return e.match(/^gex/i)},function(e){return""==e}],ADT:[function(e){return e.match(/^adt/i)},function(e){return e.match(/antibody capture/i)},function(e){return e.match(/^hto/i)}]};function _i(e){for(var t={},r=0,i=Object.keys(Zi);r<i.length;r++){var a=i[r];t[a]=new Array(e.length),t[a].fill(null)}for(var s=function(){for(var r=Object.keys(e[u].features),i=function(){var e=(0,o.Z)(s[a],2),i=e[0],l=e[1],c=t[i];!function(){var e,t=(0,n.Z)(l);try{for(t.s();!(e=t.n()).done;){var i,a=e.value,s=(0,n.Z)(r);try{for(s.s();!(i=s.n()).done;){var o=i.value;if(a(o))return void(c[u]=o)}}catch(Ke){s.e(Ke)}finally{s.f()}}}catch(Ke){t.e(Ke)}finally{t.f()}}()},a=0,s=Object.entries(Zi);a<s.length;a++)i()},u=0;u<e.length;u++)s();for(var l={},c=0,h=Object.entries(t);c<h.length;c++){var f,d=(0,o.Z)(h[c],2),v=d[0],m=d[1],p=!1,w=(0,n.Z)(m);try{for(w.s();!(f=w.n()).done;){if(null==f.value){p=!0;break}}}catch(Ke){w.e(Ke)}finally{w.f()}p||(l[v]=m)}return l}function ki(e,t,r){var n={};try{for(var i=[],a=0;a<t.length;a++){var s=t[a];i.push(r[a].features[s])}var o=yi(i);if(null===o.best_type)throw new Error("no common feature types available across all datasets for '"+e+"'");var u=[],l=[];for(a=0;a<t.length;a++)u.push(i[a].column(o.best_fields[a])),l.push(r[a].matrix.get(t[a]));var c=b.cbindWithNames(l,u);n.matrix=c.matrix,n.features=y.Nd(i[0],c.indices),n.row_ids=y.Nd(r[0].row_ids[t[0]],c.indices)}catch(h){throw k(n.matrix),h}return n}function Ai(e,t){var r,n=_i(t);if(0==Object.keys(n).length)throw new Error("failed to guess common modalities across all datasets");var i={matrix:new b.MultiMatrix,features:{},row_ids:{}};try{for(var a=0,s=Object.entries(n);a<s.length;a++){var u=(0,o.Z)(s[a],2),l=u[0],c=ki(l,u[1],t);i.matrix.add(l,c.matrix),i.features[l]=c.features,i.row_ids[l]=c.row_ids}var h=t.map((function(e){return e.cells}));i.cells=Z.s(h);var f=new Array(t.length);t.forEach((function(e,t){f[t]=e.matrix.numberOfColumns()})),r=b.createBlock(f),i.block_ids=r,i.block_levels=e;var d=new Array(r.length);r.forEach((function(t,r){d[r]=e[t]})),i.cells.$setColumn("__batch__",d)}catch(v){throw k(r),k(i.matrix),v}return i}function xi(e){var t=_i([e]);if(0==Object.keys(t).length)throw new Error("failed to guess common modalities across all datasets");var r={matrix:new b.MultiMatrix,features:{},row_ids:{}};try{for(var n=0,i=Object.entries(t);n<i.length;n++){var a=(0,o.Z)(i[n],2),s=a[0],u=a[1][0];r.matrix.add(s,e.matrix.get(u)),r.features[s]=e.features[u],r.row_ids[s]=e.row_ids[u]}}catch(l){throw b.free(r.matrix),l}return r.cells=e.cells,r.block_ids=null,r.block_levels=null,r}function Ei(e,t){return Si.apply(this,arguments)}function Si(){return Si=(0,u.Z)(g.mark((function e(t,r){var i,a,s,o,u,l,c,h,f,d,v,m;return g.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:(i=Object.keys(t)).sort(),a=[],e.prev=3,s=0,o=i;case 5:if(!(s<o.length)){e.next=15;break}return u=o[s],e.t0=a,e.next=10,t[u].load({cache:r});case 10:e.t1=e.sent,e.t0.push.call(e.t0,e.t1);case 12:s++,e.next=5;break;case 15:e.next=22;break;case 17:e.prev=17,e.t2=e.catch(3),l=(0,n.Z)(a);try{for(l.s();!(c=l.n()).done;)h=c.value,b.free(h.matrix)}catch(Ke){l.e(Ke)}finally{l.f()}throw e.t2;case 22:if(1!=i.length){e.next=33;break}e.prev=23,f=xi(a[0]),e.next=31;break;case 27:throw e.prev=27,e.t3=e.catch(23),b.free(a[0].matrix),e.t3;case 31:e.next=34;break;case 33:try{f=Ai(i,a)}finally{d=(0,n.Z)(a);try{for(d.s();!(v=d.n()).done;)m=v.value,b.free(m.matrix)}catch(Ke){d.e(Ke)}finally{d.f()}}case 34:return e.abrupt("return",f);case 35:case"end":return e.stop()}}),e,null,[[3,17],[23,27]])}))),Si.apply(this,arguments)}function Oi(e,t){if(hi in t)return t.raw_subset_indices;if(null==e)return null;if(!t.raw_annotations.hasColumn(e.field))throw new Error("failed to find '"+e.field+"' in the column annotations");var r=t.raw_annotations.column(e.field),i=[];if("values"in e){var a=new Set(e.values);r.forEach((function(e,t){a.has(e)&&i.push(t)}))}else r.forEach((function(t,r){var a,s=(0,n.Z)(e.ranges);try{for(s.s();!(a=s.n()).done;){var o=a.value;if(t>=o[0]&&t<=o[1])return void i.push(r)}}catch(Ke){s.e(Ke)}finally{s.f()}}));return i}function Ii(e){if(e.length%2!==0)throw new Error("'ranges' should have two columns in 'subset'");for(var t=1;t<e.length;t++)if(e[t]<e[t-1])throw new Error("'ranges' should be sorted in increasing order")}function Ci(e,t,r){return Ri.apply(this,arguments)}function Ri(){return(Ri=(0,u.Z)(g.mark((function e(t,r,n){var i;return g.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return k(r.raw_matrix),k(r.matrix),k(r.multi_block_ids),e.next=5,Ei(t,n);case 5:i=e.sent,r.raw_matrix=i.matrix,r.row_ids=i.row_ids,r.raw_annotations=i.cells,r.multi_block_ids=i.block_ids,r.multi_block_levels=i.block_levels,r.genes=i.features;case 12:case"end":return e.stop()}}),e)})))).apply(this,arguments)}function Ni(e,t){k(t.raw_block_ids);var r=null,n=null;if(null!==e)try{var i=t.raw_annotations.column(e);if(i.length!=t.raw_matrix.numberOfColumns())throw new Error("length of sample factor '"+e+"' should be equal to the number of cells");var a=b.convertBlock(i);r=a.ids,n=a.levels}catch(s){throw k(r),s}else r=null!==t.multi_block_ids?t.multi_block_ids.view():null,n=t.multi_block_levels;t.raw_block_ids=r,t.raw_block_levels=n}function Mi(e,t){k(t.matrix),k(t.block_ids);var r,i,a,s,o=Oi(e,t);try{if(null===o)r=t.raw_annotations,i=t.raw_matrix.clone(),null!==t.raw_block_ids?(a=t.raw_block_ids.view(),s=t.raw_block_levels):(a=null,s=null);else{if(r=y.Nd(t.raw_annotations,o),null!==t.raw_block_ids)a=b.subsetBlock(t.raw_block_ids,o),s=b.dropUnusedBlock(a).map((function(e){return t.raw_block_levels[e]}));else a=null,s=null;i=new b.MultiMatrix;var u,l=(0,n.Z)(t.raw_matrix.available());try{for(l.s();!(u=l.n()).done;){var c=u.value,h=t.raw_matrix.get(c);i.add(c,b.subsetColumns(h,o))}}catch(Ke){l.e(Ke)}finally{l.f()}}}catch(f){throw k(i),k(a),f}t.annotations=r,t.block_levels=s,t.block_ids=a,t.matrix=i}function Fi(e){return function(t){var r=t.slice();t.forEach((function(n,i){t[i]=r[e[i]]}))}}function Di(e,t,r){return zi.apply(this,arguments)}function zi(){return(zi=(0,u.Z)(g.mark((function e(t,r,i){var a,s,o,u,l,c,h;return g.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(t in li){e.next=2;break}throw new Error("unknown format '"+t+"' during unserialization");case 2:a=li[t],s=[],o=(0,n.Z)(r),e.prev=5,o.s();case 7:if((u=o.n()).done){e.next=25;break}if(l=u.value,c=void 0,null!=i){e.next=18;break}if(null!=ji){e.next=13;break}throw new Error("no valid linking function from 'setResolveLink'");case 13:return e.next=15,ji(l.id);case 15:c=e.sent,e.next=21;break;case 18:return e.next=20,i(l.offset,l.size);case 20:c=e.sent;case 21:h=new M(c,{name:l.name}),s.push({type:l.type,file:h});case 23:e.next=7;break;case 25:e.next=30;break;case 27:e.prev=27,e.t0=e.catch(5),o.e(e.t0);case 30:return e.prev=30,o.f(),e.finish(30);case 33:return e.next=35,a.unserialize(s);case 35:return e.abrupt("return",e.sent);case 36:case"end":return e.stop()}}),e,null,[[5,27,30,33]])})))).apply(this,arguments)}function Bi(e,t){return Wi.apply(this,arguments)}function Wi(){return Wi=(0,u.Z)(g.mark((function e(t,r){var i,a,s,o,u,l,c,h,f,d,v,m,p,w,y,Z,_,k,A,x,E,S,O,I,C,R,N,M,F,D,z,B,W,G,j,T,Q,U,q,P,L,V,H,Y,J,K,X,$,ee,te,re,ne,ie,ae,se,oe,ue,le,ce,he;return g.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:for(i=t.open("inputs"),a=i.open("parameters"),s=a.open("files"),o=s.children,u=new Array(o.length),l=0,c=Object.keys(o);l<c.length;l++){for(h=c[l],f=s.open(h),d={},v=0,m=["type","name"];v<m.length;v++)p=m[v],w=f.open(p,{load:!0}),d[p]=w.values[0];if("id"in f.children)d.id=f.open("id",{load:!0}).values[0];else for(y=0,Z=["offset","size"];y<Z.length;y++)d[_=Z[y]]=f.open(_,{load:!0}).values[0];k=Number(h),u[k]=d}if(A={},x={sample_factor:null},E=a.open("format",{load:!0}),!(S=0==E.shape.length)){e.next=18;break}return O=E.values[0],e.next=14,Di(O,u,r);case 14:A.default=e.sent,"sample_factor"in a.children?x.sample_factor=a.open("sample_factor",{load:!0}).values[0]:x.sample_factor=null,e.next=34;break;case 18:I=E.values,C=a.open("sample_names",{load:!0}).values,R=a.open("sample_groups",{load:!0}).values,N=0,M=0;case 23:if(!(M<I.length)){e.next=34;break}return F=N,N+=R[M],D=u.slice(F,N),z=I[M],e.next=30,Di(z,D,r);case 30:A[C[M]]=e.sent;case 31:M++,e.next=23;break;case 34:if(B=null,W=null,!("subset"in a.children)){e.next=50;break}if(!("cells"in(G=a.open("subset")).children)){e.next=50;break}if(!("indices"in(j=G.open("cells")).children)){e.next=44;break}W=j.open("indices",{load:!0}).values,e.next=50;break;case 44:if(!("field"in j.children)){e.next=49;break}if(B={field:j.open("field",{load:!0}).values[0]},"values"in j.children)B.values=j.open("values",{load:!0}).values;else{for(Ii(T=j.open("ranges",{load:!0}).values),Q=[],M=0;M<T.length/2;M++)Q.push([T[2*M],T[2*M+1]]);B.ranges=Q}e.next=50;break;case 49:throw new Error("unrecognized specification for 'subset'");case 50:return x.subset=B,U={readers:A},e.next=54,Ci(A,U);case 54:if(Ni(x.sample_factor,U),null!==W&&(U.raw_subset_indices=W),Mi(x.subset,U),q=i.open("results"),P={},!S){e.next=63;break}if("permutation"in q.children)L=q.open("permutation",{load:!0}),V=new Int32Array(L.values.length),L.values.forEach((function(e,t){V[e]=t})),P.RNA=b.updateRowIdentities(U.row_ids.RNA,V);else if("identities"in q.children)if("DataSet"==q.children.identities)H=q.open("identities",{load:!0}),P.RNA=b.updateRowIdentities(U.row_ids.RNA,H.values);else for(Y=q.open("identities"),J=0,K=Object.keys(Y.children);J<K.length;J++)X=K[J],U.matrix.has(X)&&($=Y.open(X,{load:!0}),P[X]=b.updateRowIdentities(U.row_ids[X],$.values));e.next=79;break;case 63:if(!("indices"in q.children)){e.next=78;break}ee=q.open("indices",{load:!0}).values,te=U.row_ids.RNA.slice().sort(),re=ee.slice().sort(),M=0;case 68:if(!(M<re.length)){e.next=75;break}if(te[M]==re[M]){e.next=72;break}return console.log([M,te[M],re[M]]),e.abrupt("break",75);case 72:M++,e.next=68;break;case 75:P.RNA=b.updateRowIdentities(U.row_ids.RNA,ee),e.next=79;break;case 78:if("DataSet"==q.children.identities)ee=q.open("identities",{load:!0}).values,P.RNA=b.updateRowIdentities(U.row_ids.RNA,ee);else for(ne=q.open("identities"),ie=0,ae=Object.keys(ne.children);ie<ae.length;ie++)se=ae[ie],U.matrix.has(se)&&(oe=ne.open(se,{load:!0}),P[se]=b.updateRowIdentities(U.row_ids[se],oe.values));case 79:ue={},le=(0,n.Z)(U.matrix.available());try{for(le.s();!(ce=le.n()).done;)(he=ce.value)in P&&null!==P[he]?ue[he]=Fi(P[he]):ue[he]=function(e){}}catch(Ke){le.e(Ke)}finally{le.f()}return e.abrupt("return",{state:new wi(x,U),permuters:ue});case 83:case"end":return e.stop()}}),e)}))),Wi.apply(this,arguments)}var Gi=null,ji=null;function Ti(e){var t=Gi;return Gi=e,t}function Qi(e){var t=ji;return ji=e,t}var Ui=r(7326),qi=r(136),Pi=r(9388);function Li(e,t,r){for(var n={},i=r.array(),a=0;a<t.length;a++){for(var s={},u=0,l=Object.entries(e);u<l.length;u++){var c=(0,o.Z)(l[u],2),h=c[0],f=c[1];s[h]=f.array().filter((function(e,t){return i[t]==a}))}n[t[a]]=s}return n}function Vi(e,t){var r,i={},a=(0,n.Z)(t);try{for(a.s();!(r=a.n()).done;){i[r.value]={}}}catch(Ke){a.e(Ke)}finally{a.f()}for(var s=0,u=Object.entries(e);s<u.length;s++)for(var l=(0,o.Z)(u[s],2),c=l[0],h=l[1],f=0;f<t.length;f++)i[t[f]][c]=h[f];return i}var Hi=(0,h.Z)((function e(){(0,c.Z)(this,e)})),Yi={};Yi.ensembl=new Set(["ENSMUSG00000064336","ENSMUSG00000064337","ENSMUSG00000064338","ENSMUSG00000064339","ENSMUSG00000064340","ENSMUSG00000064341","ENSMUSG00000064342","ENSMUSG00000064343","ENSMUSG00000064344","ENSMUSG00000064345","ENSMUSG00000064346","ENSMUSG00000064347","ENSMUSG00000064348","ENSMUSG00000064349","ENSMUSG00000064350","ENSMUSG00000064351","ENSMUSG00000064352","ENSMUSG00000064353","ENSMUSG00000064354","ENSMUSG00000064355","ENSMUSG00000064356","ENSMUSG00000064357","ENSMUSG00000064358","ENSMUSG00000064359","ENSMUSG00000064360","ENSMUSG00000064361","ENSMUSG00000064363","ENSMUSG00000064364","ENSMUSG00000064365","ENSMUSG00000064366","ENSMUSG00000064367","ENSMUSG00000064368","ENSMUSG00000064369","ENSMUSG00000064370","ENSMUSG00000064371","ENSMUSG00000064372","ENSMUSG00000065947","ENSG00000198695","ENSG00000198712","ENSG00000198727","ENSG00000198763","ENSG00000198786","ENSG00000198804","ENSG00000198840","ENSG00000198886","ENSG00000198888","ENSG00000198899","ENSG00000198938","ENSG00000209082","ENSG00000210049","ENSG00000210077","ENSG00000210082","ENSG00000210100","ENSG00000210107","ENSG00000210112","ENSG00000210117","ENSG00000210127","ENSG00000210135","ENSG00000210140","ENSG00000210144","ENSG00000210151","ENSG00000210154","ENSG00000210156","ENSG00000210164","ENSG00000210174","ENSG00000210176","ENSG00000210184","ENSG00000210191","ENSG00000210194","ENSG00000210195","ENSG00000210196","ENSG00000211459","ENSG00000212907","ENSG00000228253"]),Yi.symbol=new Set(["mt-Tf","mt-Rnr1","mt-Tv","mt-Rnr2","mt-Tl1","mt-Nd1","mt-Ti","mt-Tq","mt-Tm","mt-Nd2","mt-Tw","mt-Ta","mt-Tn","mt-Tc","mt-Ty","mt-Co1","mt-Ts1","mt-Td","mt-Co2","mt-Tk","mt-Atp8","mt-Atp6","mt-Co3","mt-Tg","mt-Nd3","mt-Tr","mt-Nd4","mt-Th","mt-Ts2","mt-Tl2","mt-Nd5","mt-Nd6","mt-Te","mt-Cytb","mt-Tt","mt-Tp","mt-Nd4l","MT-ND6","MT-CO2","MT-CYB","MT-ND2","MT-ND5","MT-CO1","MT-ND3","MT-ND4","MT-ND1","MT-ATP6","MT-CO3","MT-TL1","MT-TF","MT-TV","MT-RNR2","MT-TI","MT-TQ","MT-TM","MT-TW","MT-TA","MT-TN","MT-TC","MT-TY","MT-TS1","MT-TD","MT-TK","MT-TG","MT-TR","MT-TH","MT-TS2","MT-TL2","MT-TE","MT-TT","MT-TP","MT-RNR1","MT-ND4L","MT-ATP8"]);var Ji="quality_control",Ki=new WeakMap,Xi=new WeakMap,$i=new WeakMap,ea=new WeakSet,ta=new WeakSet,ra=function(e){(0,qi.Z)(r,e);var t=(0,Pi.Z)(r);function r(e){var n,i=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null,a=arguments.length>2&&void 0!==arguments[2]?arguments[2]:null;if((0,c.Z)(this,r),n=t.call(this),(0,f.Z)((0,Ui.Z)(n),ta),(0,f.Z)((0,Ui.Z)(n),ea),(0,d.Z)((0,Ui.Z)(n),Ki,{writable:!0,value:void 0}),(0,d.Z)((0,Ui.Z)(n),Xi,{writable:!0,value:void 0}),(0,d.Z)((0,Ui.Z)(n),$i,{writable:!0,value:void 0}),!(e instanceof wi))throw new Error("'inputs' should be a State object from './inputs.js'");return(0,w.Z)((0,Ui.Z)(n),Ki,e),(0,w.Z)((0,Ui.Z)(n),$i,null===i?{}:i),(0,w.Z)((0,Ui.Z)(n),Xi,null===a?{}:a),n.changed=!1,n}return(0,h.Z)(r,[{key:"free",value:function(){k((0,p.Z)(this,Xi).metrics),k((0,p.Z)(this,Xi).filters),k((0,p.Z)(this,Xi).metrics_buffer)}},{key:"valid",value:function(){return!0}},{key:"skipped",value:function(){return(0,p.Z)(this,$i).skip}},{key:"fetchSums",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t=e.unsafe,r=void 0!==t&&t;return(0,p.Z)(this,Xi).metrics.sums({copy:!r})}},{key:"fetchDiscards",value:function(){return(0,p.Z)(this,Xi).filters.discardOverall({copy:"view"})}},{key:"fetchParameters",value:function(){return(0,l.Z)({},(0,p.Z)(this,$i))}},{key:"compute",value:function(e,t,r,i){this.changed=!1;var a=!e&&!("metrics"in(0,p.Z)(this,Xi)),s=!e&&!("filters"in(0,p.Z)(this,Xi));if((0,p.Z)(this,Ki).changed||t!==(0,p.Z)(this,$i).use_mito_default||r!==(0,p.Z)(this,$i).mito_prefix||a){if(k((0,p.Z)(this,Xi).metrics),e)delete(0,p.Z)(this,Xi).metrics;else{var o=(0,p.Z)(this,Ki).fetchCountMatrix(),u=E(1*o.numberOfRows(),"Uint8Array",(0,p.Z)(this,Xi),"metrics_buffer");u.fill(0);var l,c=(0,p.Z)(this,Ki).fetchGenes(),h=u.array(),f=(0,n.Z)(c.columnNames());try{for(f.s();!(l=f.n()).done;){var d=l.value,v=c.column(d);if(t)v.forEach((function(e,t){(Yi.symbol.has(e)||Yi.ensembl.has(e))&&(h[t]=1)}));else{var m=r.toLowerCase();v.forEach((function(e,t){e.toLowerCase().startsWith(m)&&(h[t]=1)}))}}}catch(Ke){f.e(Ke)}finally{f.f()}(0,p.Z)(this,Xi).metrics=b.computePerCellQCMetrics(o,[u])}(0,p.Z)(this,$i).use_mito_default=t,(0,p.Z)(this,$i).mito_prefix=r,this.changed=!0}if(this.changed||i!==(0,p.Z)(this,$i).nmads||s){if(k((0,p.Z)(this,Xi).filters),e)delete(0,p.Z)(this,Xi).filters;else{var w=(0,p.Z)(this,Ki).fetchBlock();(0,p.Z)(this,Xi).filters=b.computePerCellQCFilters((0,p.Z)(this,Xi).metrics,{numberOfMADs:i,block:w})}(0,p.Z)(this,$i).nmads=i,this.changed=!0}(0,p.Z)(this,$i).skip!==e?(this.changed=!0,(0,p.Z)(this,$i).skip=e):(0,p.Z)(this,$i).skip&&e&&(this.changed=!1)}},{key:"summary",value:function(){if(!this.valid()||this.skipped())return null;var e={},t=(0,p.Z)(this,Ki).fetchBlockLevels();if(null===t)t=["default"],e.data={default:(0,v.Z)(this,ea,na).call(this)};else{var r=(0,v.Z)(this,ea,na).call(this,{copy:"view"}),n=(0,p.Z)(this,Ki).fetchBlock();e.data=Li(r,t,n)}var i=(0,v.Z)(this,ta,ia).call(this);return e.thresholds=Vi(i,t),e}},{key:"serialize",value:function(e){var t=e.createGroup(Ji),r=t.createGroup("parameters");r.writeDataSet("skip","Uint8",[],Number((0,p.Z)(this,$i).skip)),r.writeDataSet("use_mito_default","Uint8",[],Number((0,p.Z)(this,$i).use_mito_default)),r.writeDataSet("mito_prefix","String",[],(0,p.Z)(this,$i).mito_prefix),r.writeDataSet("nmads","Float64",[],(0,p.Z)(this,$i).nmads);var n=t.createGroup("results");if("metrics"in(0,p.Z)(this,Xi)){var i=n.createGroup("metrics"),a=(0,v.Z)(this,ea,na).call(this,{copy:"view"});i.writeDataSet("sums","Float64",null,a.sums),i.writeDataSet("detected","Int32",null,a.detected),i.writeDataSet("proportion","Float64",null,a.proportion)}if("filters"in(0,p.Z)(this,Xi)){for(var s=n.createGroup("thresholds"),o=(0,v.Z)(this,ta,ia).call(this,{copy:"hdf5"}),u=0,l=["sums","detected","proportion"];u<l.length;u++){var c=l[u],h=o[c];s.writeDataSet(c,"Float64",null,h)}var f=this.fetchDiscards();n.writeDataSet("discards","Uint8",null,f)}}}],[{key:"defaults",value:function(){return{skip:!1,use_mito_default:!0,mito_prefix:"mt-",nmads:3}}}]),r}(Hi);function na(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t=e.copy,r=void 0===t||t;return{sums:(0,p.Z)(this,Xi).metrics.sums({copy:r}),detected:(0,p.Z)(this,Xi).metrics.detected({copy:r}),proportion:(0,p.Z)(this,Xi).metrics.subsetProportions(0,{copy:r})}}function ia(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t=e.copy,r=void 0===t||t;return{sums:(0,p.Z)(this,Xi).filters.thresholdsSums({copy:r}),detected:(0,p.Z)(this,Xi).filters.thresholdsDetected({copy:r}),proportion:(0,p.Z)(this,Xi).filters.thresholdsSubsetProportions(0,{copy:r})}}var aa=function(){function e(t,r,n,i){(0,c.Z)(this,e),this.sums_=t,this.detected_=r,this.proportion_=n;try{this.discards=b.createUint8WasmArray(i.length),this.discards.set(i)}catch(a){throw k(this.discards),a}}return(0,h.Z)(e,[{key:"thresholdsSums",value:function(e){var t=e.copy;return _(this.sums_,t)}},{key:"thresholdsDetected",value:function(e){var t=e.copy;return _(this.detected_,t)}},{key:"thresholdsSubsetProportions",value:function(e,t){var r=t.copy;if(0!=e)throw"only 'index = 0' is supported for mimics";return _(this.proportion_,r)}},{key:"discardOverall",value:function(e){var t=e.copy;return _(this.discards,t)}},{key:"free",value:function(){this.discards.free()}}]),e}();function sa(e,t){var r,n=e.open("quality_control"),i=ra.defaults(),a=n.open("parameters");i.use_mito_default=a.open("use_mito_default",{load:!0}).values[0]>0,i.mito_prefix=a.open("mito_prefix",{load:!0}).values[0],i.nmads=a.open("nmads",{load:!0}).values[0],"skip"in a.children&&(i.skip=a.open("skip",{load:!0}).values[0]>0);var s={};try{var o=n.open("results");if("metrics"in o.children){var u=o.open("metrics"),l=u.open("sums",{load:!0}).values;s.metrics=b.emptyPerCellQCMetricsResults(l.length,1),s.metrics.sums({copy:!1}).set(l);var c=u.open("detected",{load:!0}).values;s.metrics.detected({copy:!1}).set(c);var h=u.open("proportion",{load:!0}).values;s.metrics.subsetProportions(0,{copy:!1}).set(h)}if("thresholds"in o.children){var f=o.open("thresholds"),d=f.open("sums",{load:!0}).values,v=f.open("detected",{load:!0}).values,m=f.open("proportion",{load:!0}).values,p=o.open("discards",{load:!0}).values;s.filters=new aa(d,v,m,p)}r=new ra(t,i,s)}catch(w){throw k(s.metrics),k(s.filters),k(r),w}return r}var oa="adt_quality_control",ua=new WeakMap,la=new WeakMap,ca=new WeakMap,ha=new WeakSet,fa=new WeakSet,da=function(e){(0,qi.Z)(r,e);var t=(0,Pi.Z)(r);function r(e){var n,i=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null,a=arguments.length>2&&void 0!==arguments[2]?arguments[2]:null;if((0,c.Z)(this,r),n=t.call(this),(0,f.Z)((0,Ui.Z)(n),fa),(0,f.Z)((0,Ui.Z)(n),ha),(0,d.Z)((0,Ui.Z)(n),ua,{writable:!0,value:void 0}),(0,d.Z)((0,Ui.Z)(n),la,{writable:!0,value:void 0}),(0,d.Z)((0,Ui.Z)(n),ca,{writable:!0,value:void 0}),!(e instanceof wi))throw new Error("'inputs' should be a State object from './inputs.js'");return(0,w.Z)((0,Ui.Z)(n),ua,e),(0,w.Z)((0,Ui.Z)(n),ca,null===i?{}:i),(0,w.Z)((0,Ui.Z)(n),la,null===a?{}:a),n.changed=!1,(0,p.Z)((0,Ui.Z)(n),ca).target_matrix="ADT",n}return(0,h.Z)(r,[{key:"free",value:function(){k((0,p.Z)(this,la).metrics),k((0,p.Z)(this,la).filters),k((0,p.Z)(this,la).metrics_buffer)}},{key:"valid",value:function(){return(0,p.Z)(this,ua).hasAvailable((0,p.Z)(this,ca).target_matrix)}},{key:"skipped",value:function(){return(0,p.Z)(this,ca).skip}},{key:"fetchSums",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t=e.unsafe,r=void 0!==t&&t;return(0,p.Z)(this,la).metrics.sums({copy:!r})}},{key:"fetchDiscards",value:function(){return(0,p.Z)(this,la).filters.discardOverall({copy:"view"})}},{key:"fetchParameters",value:function(){var e=(0,l.Z)({},(0,p.Z)(this,ca));return delete e.target_matrix,e}},{key:"useRNAMatrix",value:function(){(0,p.Z)(this,ca).target_matrix="RNA"}},{key:"compute",value:function(e,t,r,i){this.changed=!1;var a=e||!this.valid(),s=!a&&!("metrics"in(0,p.Z)(this,la)),o=!a&&!("filters"in(0,p.Z)(this,la));if((0,p.Z)(this,ua).changed||t!==(0,p.Z)(this,ca).igg_prefix||s){if(k((0,p.Z)(this,la).metrics),a)delete(0,p.Z)(this,la).metrics;else{var u=(0,p.Z)(this,ua).fetchCountMatrix({type:(0,p.Z)(this,ca).target_matrix}),l=(0,p.Z)(this,ua).fetchGenes({type:(0,p.Z)(this,ca).target_matrix}),c=E(u.numberOfRows(),"Uint8Array",(0,p.Z)(this,la),"metrics_buffer");c.fill(0);var h,f=c.array(),d=t.toLowerCase(),v=(0,n.Z)(l.columnNames());try{for(v.s();!(h=v.n()).done;){var m=h.value;l.column(m).forEach((function(e,t){e.toLowerCase().startsWith(d)&&(f[t]=1)}))}}catch(Ke){v.e(Ke)}finally{v.f()}(0,p.Z)(this,la).metrics=b.computePerCellAdtQcMetrics(u,[c])}(0,p.Z)(this,ca).igg_prefix=t,this.changed=!0}if(this.changed||r!==(0,p.Z)(this,ca).nmads||i!==(0,p.Z)(this,ca).min_detected_drop||o){if(k((0,p.Z)(this,la).filters),a)delete(0,p.Z)(this,la).filters;else{var w=(0,p.Z)(this,ua).fetchBlock();(0,p.Z)(this,la).filters=b.computePerCellAdtQcFilters((0,p.Z)(this,la).metrics,{numberOfMADs:r,minDetectedDrop:i,block:w})}(0,p.Z)(this,ca).nmads=r,(0,p.Z)(this,ca).min_detected_drop=i,this.changed=!0}(0,p.Z)(this,ca).skip!==e?(this.changed=!0,(0,p.Z)(this,ca).skip=e):(0,p.Z)(this,ca).skip&&e&&(this.changed=!1)}},{key:"summary",value:function(){if(!this.valid()||this.skipped())return null;var e={},t=(0,p.Z)(this,ua).fetchBlockLevels();if(null===t)t=["default"],e.data={default:(0,v.Z)(this,ha,va).call(this)};else{var r=(0,v.Z)(this,ha,va).call(this,{copy:"view"}),n=(0,p.Z)(this,ua).fetchBlock();e.data=Li(r,t,n)}var i=(0,v.Z)(this,fa,ma).call(this);e.thresholds=Vi(i,t);for(var a=0,s=Object.entries(e.thresholds);a<s.length;a++){var u=(0,o.Z)(s[a],2);u[0];u[1].sums=NaN}return e}},{key:"serialize",value:function(e){var t=e.createGroup(oa),r=t.createGroup("parameters");r.writeDataSet("skip","Uint8",[],Number((0,p.Z)(this,ca).skip)),r.writeDataSet("igg_prefix","String",[],(0,p.Z)(this,ca).igg_prefix),r.writeDataSet("nmads","Float64",[],(0,p.Z)(this,ca).nmads),r.writeDataSet("min_detected_drop","Float64",[],(0,p.Z)(this,ca).min_detected_drop);var n=t.createGroup("results");if("metrics"in(0,p.Z)(this,la)){var i=n.createGroup("metrics"),a=(0,v.Z)(this,ha,va).call(this,{copy:"view"});i.writeDataSet("sums","Float64",null,a.sums),i.writeDataSet("detected","Int32",null,a.detected),i.writeDataSet("igg_total","Float64",null,a.igg_total)}if("filters"in(0,p.Z)(this,la)){for(var s=n.createGroup("thresholds"),o=(0,v.Z)(this,fa,ma).call(this,{copy:"hdf5"}),u=0,l=["detected","igg_total"];u<l.length;u++){var c=l[u],h=o[c];s.writeDataSet(c,"Float64",null,h)}var f=this.fetchDiscards();n.writeDataSet("discards","Uint8",null,f)}}}],[{key:"defaults",value:function(){return{skip:!1,igg_prefix:"IgG",nmads:3,min_detected_drop:.1}}}]),r}(Hi);function va(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t=e.copy,r=void 0===t||t;return{sums:(0,p.Z)(this,la).metrics.sums({copy:r}),detected:(0,p.Z)(this,la).metrics.detected({copy:r}),igg_total:(0,p.Z)(this,la).metrics.subsetTotals(0,{copy:r})}}function ma(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t=e.copy,r=void 0===t||t;return{detected:(0,p.Z)(this,la).filters.thresholdsDetected({copy:r}),igg_total:(0,p.Z)(this,la).filters.thresholdsSubsetTotals(0,{copy:r})}}var pa=function(){function e(t,r,n){(0,c.Z)(this,e),this.detected_=t,this.igg_total_=r;try{this.discards=b.createUint8WasmArray(n.length),this.discards.set(n)}catch(i){throw k(this.discards),i}}return(0,h.Z)(e,[{key:"thresholdsDetected",value:function(e){var t=e.copy;return _(this.detected_,t)}},{key:"thresholdsSubsetTotals",value:function(e,t){var r=t.copy;if(0!=e)throw"only 'index = 0' is supported for mimics";return _(this.igg_total_,r)}},{key:"discardOverall",value:function(e){var t=e.copy;return _(this.discards,t)}},{key:"free",value:function(){this.discards.free()}}]),e}();function wa(e,t){var r,n={},i=da.defaults();if(oa in e.children){var a=e.open(oa),s=a.open("parameters");i.igg_prefix=s.open("igg_prefix",{load:!0}).values[0],i.nmads=s.open("nmads",{load:!0}).values[0],i.min_detected_drop=s.open("min_detected_drop",{load:!0}).values[0],"skip"in s.children&&(i.skip=s.open("skip",{load:!0}).values[0]>0);try{var o=a.open("results");if("metrics"in o.children){var u=o.open("metrics"),l=u.open("detected",{load:!0}).values;n.metrics=b.emptyPerCellAdtQcMetricsResults(l.length,1),n.metrics.detected({copy:!1}).set(l);var c=u.open("sums",{load:!0}).values;n.metrics.sums({copy:!1}).set(c);var h=u.open("igg_total",{load:!0}).values;n.metrics.subsetTotals(0,{copy:!1}).set(h)}if("thresholds"in o.children){var f=o.open("thresholds"),d=f.open("detected",{load:!0}).values,v=f.open("igg_total",{load:!0}).values,m=o.open("discards",{load:!0}).values;n.filters=new pa(d,v,m)}r=new da(t,i,n)}catch(p){throw k(n.metrics),k(n.filters),k(r),p}}else r=new da(t,i,n);return r}var ga="cell_filtering";function ba(e,t){var r,i=S(e,t),a=[],s=(0,n.Z)(i);try{for(s.s();!(r=s.n()).done;){var o=r.value;e[o].skipped()||a.push(o)}}catch(Ke){s.e(Ke)}finally{s.f()}return a}var ya=new WeakMap,Za=new WeakMap,_a=new WeakMap,ka=new WeakMap,Aa=new WeakSet,xa=new WeakSet,Ea=function(){function e(t,r){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:null,i=arguments.length>3&&void 0!==arguments[3]?arguments[3]:null;if((0,c.Z)(this,e),(0,f.Z)(this,xa),(0,f.Z)(this,Aa),(0,d.Z)(this,ya,{writable:!0,value:void 0}),(0,d.Z)(this,Za,{writable:!0,value:void 0}),(0,d.Z)(this,_a,{writable:!0,value:void 0}),(0,d.Z)(this,ka,{writable:!0,value:void 0}),!(t instanceof wi))throw new Error("'inputs' should be an InputsState");(0,w.Z)(this,ya,t);for(var a=0,s=Object.values(r);a<s.length;a++){var o=s[a];if(!(o instanceof Hi))throw new Error("'qc_states' should contain QualityControlStateBase objects")}(0,w.Z)(this,Za,r),(0,w.Z)(this,ka,null===n?{}:n),(0,w.Z)(this,_a,null===i?{}:i),this.changed=!1}return(0,h.Z)(e,[{key:"free",value:function(){k((0,p.Z)(this,_a).block_buffer),k((0,p.Z)(this,_a).discard_buffer),k((0,p.Z)(this,_a).matrix)}},{key:"hasAvailable",value:function(e){return"matrix"in(0,p.Z)(this,_a)?(0,p.Z)(this,_a).matrix.has(e):(0,p.Z)(this,ya).hasAvailable(e)}},{key:"fetchFilteredMatrix",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t=e.type,r=void 0===t?"RNA":t;return"matrix"in(0,p.Z)(this,_a)||(0,v.Z)(this,Aa,Sa).call(this),(0,p.Z)(this,_a).matrix.get(r)}},{key:"fetchFilteredBlock",value:function(){return"block_buffer"in(0,p.Z)(this,_a)||(0,v.Z)(this,xa,Oa).call(this),(0,p.Z)(this,_a).block_buffer}},{key:"fetchDiscards",value:function(){return"discard_buffer"in(0,p.Z)(this,_a)?(0,p.Z)(this,_a).discard_buffer:null}},{key:"fetchFilteredAnnotations",value:function(e){var t=(0,p.Z)(this,ya).fetchAnnotations(e);if("discard_buffer"in(0,p.Z)(this,_a)){var r=(0,p.Z)(this,_a).discard_buffer.array();return t.filter((function(e,t){return!r[t]}))}return t}},{key:"fetchParameters",value:function(){return(0,l.Z)({},(0,p.Z)(this,ka))}},{key:"compute",value:function(){var e=this;this.changed=!1,(0,p.Z)(this,ya).changed&&(this.changed=!0);for(var t=0,r=Object.values((0,p.Z)(this,Za));t<r.length;t++){r[t].changed&&(this.changed=!0)}if(this.changed){var i=ba((0,p.Z)(this,Za),"QC");if(i.length>0){var a,s=(0,p.Z)(this,Za)[i[0]].fetchDiscards();i.length>1?function(){var t=(a=E(s.length,"Uint8Array",(0,p.Z)(e,_a),"discard_buffer")).array();t.fill(0);var r,o=(0,n.Z)(i);try{for(o.s();!(r=o.n()).done;){var u=r.value;(0,p.Z)(e,Za)[u].fetchDiscards().forEach((function(e,r){t[r]|=e}))}}catch(Ke){o.e(Ke)}finally{o.f()}}():(a=s.view(),k((0,p.Z)(this,_a).discard_buffer),(0,p.Z)(this,_a).discard_buffer=a)}else k((0,p.Z)(this,_a).discard_buffer),delete(0,p.Z)(this,_a).discard_buffer;(0,v.Z)(this,Aa,Sa).call(this),(0,v.Z)(this,xa,Oa).call(this)}}},{key:"undoFiltering",value:function(e){var t=this.fetchDiscards();if(null!==t){var r=[];t.forEach((function(e,t){0==e&&r.push(t)})),e.forEach((function(t,n){e[n]=r[t]}))}}},{key:"summary",value:function(){var e=0;if("discard_buffer"in(0,p.Z)(this,_a))(0,p.Z)(this,_a).discard_buffer.forEach((function(t){e+=0==t}));else{var t=(0,p.Z)(this,ya).hasAvailable();e=(0,p.Z)(this,ya).fetchCountMatrix(t[0]).numberOfColumns()}return{retained:e}}},{key:"serialize",value:function(e){var t=e.createGroup(ga);t.createGroup("parameters");var r=t.createGroup("results");if("discard_buffer"in(0,p.Z)(this,_a)){var n=(0,p.Z)(this,_a).discard_buffer;null===n.owner&&r.writeDataSet("discards","Uint8",null,n)}}}],[{key:"defaults",value:function(){return{}}}]),e}();function Sa(){k((0,p.Z)(this,_a).matrix),(0,p.Z)(this,_a).matrix=new b.MultiMatrix;var e,t=(0,p.Z)(this,ya).listAvailableTypes(),r=(0,n.Z)(t);try{for(r.s();!(e=r.n()).done;){var i=e.value,a=(0,p.Z)(this,ya).fetchCountMatrix({type:i}),s=void 0;s="discard_buffer"in(0,p.Z)(this,_a)?b.filterCells(a,(0,p.Z)(this,_a).discard_buffer):a.clone(),(0,p.Z)(this,_a).matrix.add(i,s)}}catch(Ke){r.e(Ke)}finally{r.f()}}function Oa(){k((0,p.Z)(this,_a).block_buffer);var e=(0,p.Z)(this,ya).fetchBlock();if(null!==e)if("discard_buffer"in(0,p.Z)(this,_a)){var t=E(this.fetchFilteredMatrix().numberOfColumns(),"Int32Array",(0,p.Z)(this,_a),"block_buffer");b.filterBlock(e,(0,p.Z)(this,_a).discard_buffer,{buffer:t})}else(0,p.Z)(this,_a).block_buffer=e.view();else(0,p.Z)(this,_a).block_buffer=null}function Ia(e,t,r){var n,i=Ea.defaults(),a={};try{if(ga in e.children){var s=e.open(ga).open("results");if("discards"in s.children){var o=s.open("discards",{load:!0}).values;a.discard_buffer=b.createUint8WasmArray(o.length),a.discard_buffer.set(o)}}if(!("discard_buffer"in a)){var u=ba(r,"QC");if(1==u.length){var l=r[u[0]];a.discard_buffer=l.fetchDiscards().view()}else if(0!=u.length)throw new Error("no more than one upstream QC state should be valid if 'discards' is not available")}n=new Ea(t,r,i,a)}catch(c){throw k(a.discard_buffer),k(n),c}return n}function Ca(e,t,r,n,i){if(e.skipped())return null;var a=E(r.numberOfColumns(),"Float64Array",n,i),s=t.fetchDiscards(),o=e.fetchSums({unsafe:!0});if(null==s)a.set(o);else{var u=a.array(),l=0;if(s.forEach((function(e,t){if(!e){if(l==a.length)throw new Error("normalization and filtering are not in sync");u[l]=o[t],l++}})),l!==a.length)throw new Error("normalization and filtering are not in sync")}return a}var Ra=(0,h.Z)((function e(){(0,c.Z)(this,e)})),Na="normalization",Ma=new WeakMap,Fa=new WeakMap,Da=new WeakMap,za=new WeakMap,Ba=new WeakSet,Wa=function(e){(0,qi.Z)(r,e);var t=(0,Pi.Z)(r);function r(e,n){var i,a=arguments.length>2&&void 0!==arguments[2]?arguments[2]:null,s=arguments.length>3&&void 0!==arguments[3]?arguments[3]:null;if((0,c.Z)(this,r),i=t.call(this),(0,f.Z)((0,Ui.Z)(i),Ba),(0,d.Z)((0,Ui.Z)(i),Ma,{writable:!0,value:void 0}),(0,d.Z)((0,Ui.Z)(i),Fa,{writable:!0,value:void 0}),(0,d.Z)((0,Ui.Z)(i),Da,{writable:!0,value:void 0}),(0,d.Z)((0,Ui.Z)(i),za,{writable:!0,value:void 0}),!(e instanceof ra))throw new Error("'filt' should be a State object from './quality_control.js'");if((0,w.Z)((0,Ui.Z)(i),Ma,e),!(n instanceof Ea))throw new Error("'filt' should be a State object from './cell_filtering.js'");return(0,w.Z)((0,Ui.Z)(i),Fa,n),(0,w.Z)((0,Ui.Z)(i),Da,null===a?{}:a),(0,w.Z)((0,Ui.Z)(i),za,null===s?{}:s),i.changed=!1,i}return(0,h.Z)(r,[{key:"free",value:function(){k((0,p.Z)(this,za).matrix),k((0,p.Z)(this,za).sum_buffer)}},{key:"valid",value:function(){return!0}},{key:"fetchNormalizedMatrix",value:function(){return"matrix"in(0,p.Z)(this,za)||(0,v.Z)(this,Ba,Ga).call(this),(0,p.Z)(this,za).matrix}},{key:"fetchExpression",value:function(e){var t=this.fetchNormalizedMatrix(),r=E(t.numberOfColumns(),"Float64Array",(0,p.Z)(this,za));return t.row(e,{buffer:r}),r.slice()}},{key:"fetchParameters",value:function(){return(0,l.Z)({},(0,p.Z)(this,Da))}},{key:"compute",value:function(){this.changed=!1,((0,p.Z)(this,Ma).changed||(0,p.Z)(this,Fa).changed)&&(this.changed=!0),this.changed&&(0,v.Z)(this,Ba,Ga).call(this)}},{key:"summary",value:function(){return{}}},{key:"serialize",value:function(e){var t=e.createGroup("normalization");t.createGroup("parameters"),t.createGroup("results")}}],[{key:"defaults",value:function(){return{}}}]),r}(Ra);function Ga(){var e=(0,p.Z)(this,Fa).fetchFilteredMatrix({type:"RNA"}),t=Ca((0,p.Z)(this,Ma),(0,p.Z)(this,Fa),e,(0,p.Z)(this,za),"sum_buffer"),r=(0,p.Z)(this,Fa).fetchFilteredBlock();k((0,p.Z)(this,za).matrix),(0,p.Z)(this,za).matrix=b.logNormCounts(e,{sizeFactors:t,block:r,allowZeros:!0})}function ja(e,t,r){return new Wa(t,r)}var Ta="adt_normalization",Qa=new WeakMap,Ua=new WeakMap,qa=new WeakMap,Pa=new WeakMap,La=new WeakSet,Va=function(e){(0,qi.Z)(r,e);var t=(0,Pi.Z)(r);function r(e,n){var i,a=arguments.length>2&&void 0!==arguments[2]?arguments[2]:null,s=arguments.length>3&&void 0!==arguments[3]?arguments[3]:null;if((0,c.Z)(this,r),i=t.call(this),(0,f.Z)((0,Ui.Z)(i),La),(0,d.Z)((0,Ui.Z)(i),Qa,{writable:!0,value:void 0}),(0,d.Z)((0,Ui.Z)(i),Ua,{writable:!0,value:void 0}),(0,d.Z)((0,Ui.Z)(i),qa,{writable:!0,value:void 0}),(0,d.Z)((0,Ui.Z)(i),Pa,{writable:!0,value:void 0}),!(e instanceof da))throw new Error("'qc' should be a AdtQualityControlState object");if((0,w.Z)((0,Ui.Z)(i),Qa,e),!(n instanceof Ea))throw new Error("'filter' should be a CellFilteringState object");return(0,w.Z)((0,Ui.Z)(i),Ua,n),(0,w.Z)((0,Ui.Z)(i),qa,null===a?{}:a),(0,w.Z)((0,Ui.Z)(i),Pa,null===s?{}:s),i.changed=!1,(0,p.Z)((0,Ui.Z)(i),qa).target_matrix="ADT",i}return(0,h.Z)(r,[{key:"free",value:function(){k((0,p.Z)(this,Pa).matrix),k((0,p.Z)(this,Pa).exp_buffer),k((0,p.Z)(this,Pa).total_buffer),k((0,p.Z)(this,Pa).sf_buffer)}},{key:"valid",value:function(){return(0,p.Z)(this,Ua).hasAvailable((0,p.Z)(this,qa).target_matrix)}},{key:"fetchNormalizedMatrix",value:function(){return this.valid()?("matrix"in(0,p.Z)(this,Pa)||(0,v.Z)(this,La,Ha).call(this),(0,p.Z)(this,Pa).matrix):null}},{key:"fetchExpression",value:function(e){var t=this.fetchNormalizedMatrix(),r=E(t.numberOfColumns(),"Float64Array",(0,p.Z)(this,Pa),"exp_buffer");return t.row(e,{buffer:r}),r.slice()}},{key:"fetchParameters",value:function(){var e=(0,l.Z)({},(0,p.Z)(this,qa));return delete e.target_matrix,e}},{key:"useRNAMatrix",value:function(){(0,p.Z)(this,qa).target_matrix="RNA"}},{key:"compute",value:function(e,t){if(this.changed=!1,(0,p.Z)(this,Qa).changed||(0,p.Z)(this,Ua).changed||e!==(0,p.Z)(this,qa).num_pcs||t!=(0,p.Z)(this,qa).num_clusters){if(this.valid()){var r=(0,p.Z)(this,Ua).fetchFilteredMatrix({type:(0,p.Z)(this,qa).target_matrix}),n=Ca((0,p.Z)(this,Qa),(0,p.Z)(this,Ua),r,(0,p.Z)(this,Pa),"total_buffer"),i=(0,p.Z)(this,Ua).fetchFilteredBlock(),a=E(r.numberOfColumns(),"Float64Array",(0,p.Z)(this,Pa),"sf_buffer");b.quickAdtSizeFactors(r,{totals:n,block:i,buffer:a,numberOfPCs:e,numberOfClusters:t}),this.changed=!0}(0,p.Z)(this,qa).num_pcs=e,(0,p.Z)(this,qa).num_clusters=t}this.changed&&this.valid()&&(0,v.Z)(this,La,Ha).call(this)}},{key:"summary",value:function(){return this.valid()?{size_factors:(0,p.Z)(this,Pa).sf_buffer.slice()}:null}},{key:"serialize",value:function(e){var t=e.createGroup(Ta),r=t.createGroup("parameters");r.writeDataSet("num_pcs","Int32",[],(0,p.Z)(this,qa).num_pcs),r.writeDataSet("num_clusters","Int32",[],(0,p.Z)(this,qa).num_clusters);var n=t.createGroup("results");this.valid()&&n.writeDataSet("size_factors","Float64",null,(0,p.Z)(this,Pa).sf_buffer)}}],[{key:"defaults",value:function(){return{num_pcs:25,num_clusters:20}}}]),r}(Ra);function Ha(){var e=(0,p.Z)(this,Ua).fetchFilteredMatrix({type:(0,p.Z)(this,qa).target_matrix}),t=(0,p.Z)(this,Ua).fetchFilteredBlock(),r=(0,p.Z)(this,Pa).sf_buffer;if(r.length!=e.numberOfColumns())throw new Error("length of size factor vector should equal number of columns after QC");k((0,p.Z)(this,Pa).matrix),(0,p.Z)(this,Pa).matrix=b.logNormCounts(e,{sizeFactors:r,block:t,allowZeros:!0})}function Ya(e,t,r){var n,i={},a=Va.defaults();if(Ta in e.children){var s=e.open(Ta),o=s.open("parameters");a.num_pcs=o.open("num_pcs",{load:!0}).values[0],a.num_clusters=o.open("num_clusters",{load:!0}).values[0];try{var u=s.open("results");if("size_factors"in u.children){var l=u.open("size_factors",{load:!0}).values;i.sf_buffer=b.createFloat64WasmArray(l.length),i.sf_buffer.set(l)}n=new Va(t,r,a,i)}catch(c){throw k(i.sf_buffer),k(n),c}}else n=new Va(t,r,a,i);return n}function Ja(e){return{pcs:e.principalComponents({copy:"view"}),num_pcs:e.numberOfPCs(),num_obs:e.numberOfCells()}}function Ka(e){var t=e.varianceExplained(),r=e.totalVariance();return t.forEach((function(e,n){t[n]=e/r})),{var_exp:t}}var Xa=(0,h.Z)((function e(){(0,c.Z)(this,e)})),$a=function(){function e(t,r){(0,c.Z)(this,e),this.var_exp=r;try{this.pcs=b.createFloat64WasmArray(t.length),this.pcs.set(t)}catch(n){throw k(this.pcs),n}}return(0,h.Z)(e,[{key:"principalComponents",value:function(e){var t=e.copy;return _(this.pcs,t)}},{key:"numberOfCells",value:function(){return this.pcs.length/this.numberOfPCs()}},{key:"numberOfPCs",value:function(){return this.var_exp.length}},{key:"varianceExplained",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t=e.copy,r=void 0===t||t;return _(this.var_exp,r)}},{key:"totalVariance",value:function(){return 1}},{key:"free",value:function(){this.pcs.free()}}]),e}(),es=new WeakMap,ts=new WeakMap,rs=new WeakMap,ns=new WeakMap,is=new WeakSet,as=function(){function e(t,r){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:null,i=arguments.length>3&&void 0!==arguments[3]?arguments[3]:null;if((0,c.Z)(this,e),(0,f.Z)(this,is),(0,d.Z)(this,es,{writable:!0,value:void 0}),(0,d.Z)(this,ts,{writable:!0,value:void 0}),(0,d.Z)(this,rs,{writable:!0,value:void 0}),(0,d.Z)(this,ns,{writable:!0,value:void 0}),!(t instanceof Ea))throw new Error("'filter' should be a State object from './cell_filtering.js'");if((0,w.Z)(this,es,t),!(r instanceof Wa))throw new Error("'norm' should be a State object from './normalization.js'");(0,w.Z)(this,ts,r),(0,w.Z)(this,ns,null===n?{}:n),(0,w.Z)(this,rs,null===i?{}:i),this.changed=!1}return(0,h.Z)(e,[{key:"free",value:function(){k((0,p.Z)(this,rs).matrix)}},{key:"fetchSortedResiduals",value:function(){return(0,p.Z)(this,rs).sorted_residuals}},{key:"fetchResiduals",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t=e.unsafe,r=void 0!==t&&t;return(0,p.Z)(this,rs).results.residuals({copy:!r})}},{key:"fetchParameters",value:function(){return(0,l.Z)({},(0,p.Z)(this,ns))}},{key:"compute",value:function(e){if(this.changed=!1,(0,p.Z)(this,ts).changed||e!=(0,p.Z)(this,ns).span){k((0,p.Z)(this,rs).results);var t=(0,p.Z)(this,ts).fetchNormalizedMatrix(),r=(0,p.Z)(this,es).fetchFilteredBlock();(0,p.Z)(this,rs).results=b.modelGeneVar(t,{span:e,block:r}),(0,p.Z)(this,rs).sorted_residuals=(0,p.Z)(this,rs).results.residuals().slice(),(0,p.Z)(this,rs).sorted_residuals.sort(),(0,p.Z)(this,ns).span=e,this.changed=!0}}},{key:"summary",value:function(){return(0,v.Z)(this,is,ss).call(this)}},{key:"serialize",value:function(e){var t=e.createGroup("feature_selection");t.createGroup("parameters").writeDataSet("span","Float64",[],(0,p.Z)(this,ns).span);for(var r=(0,v.Z)(this,is,ss).call(this,{copy:"hdf5"}),n=t.createGroup("results"),i=0,a=Object.entries(r);i<a.length;i++){var s=(0,o.Z)(a[i],2),u=s[0],l=s[1];n.writeDataSet(u,"Float64",null,l)}}}]),e}();function ss(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t=e.copy,r=void 0===t||t;return{means:(0,p.Z)(this,rs).results.means({copy:r}),vars:(0,p.Z)(this,rs).results.variances({copy:r}),fitted:(0,p.Z)(this,rs).results.fitted({copy:r}),resids:(0,p.Z)(this,rs).results.residuals({copy:r})}}var os=function(){function e(t,r,n,i){(0,c.Z)(this,e),this.means_=t,this.vars_=r,this.fitted_=n,this.resids_=i}return(0,h.Z)(e,[{key:"means",value:function(e){var t=e.copy;return _(this.means_,t)}},{key:"variances",value:function(e){var t=e.copy;return _(this.vars_,t)}},{key:"fitted",value:function(e){var t=e.copy;return _(this.fitted_,t)}},{key:"residuals",value:function(e){var t=e.copy;return _(this.resids_,t)}},{key:"free",value:function(){}}]),e}();function us(e,t,r,n){var i,a=e.open("feature_selection");i={span:a.open("parameters").open("span",{load:!0}).values[0]};for(var s={},o=a.open("results"),u={},l=0,c=["means","vars","fitted","resids"];l<c.length;l++){var h=c[l],f=o.open(h,{load:!0}).values;t(f),u[h]=f}return s.results=new os(u.means,u.vars,u.fitted,u.resids),s.sorted_residuals=s.results.residuals({copy:!0}),s.sorted_residuals.sort(),new as(r,n,i,s)}var ls="pca",cs=new WeakMap,hs=new WeakMap,fs=new WeakMap,ds=new WeakMap,vs=new WeakMap,ms=function(e){(0,qi.Z)(r,e);var t=(0,Pi.Z)(r);function r(e,n,i){var a,s=arguments.length>3&&void 0!==arguments[3]?arguments[3]:null,o=arguments.length>4&&void 0!==arguments[4]?arguments[4]:null;if((0,c.Z)(this,r),a=t.call(this),(0,d.Z)((0,Ui.Z)(a),cs,{writable:!0,value:void 0}),(0,d.Z)((0,Ui.Z)(a),hs,{writable:!0,value:void 0}),(0,d.Z)((0,Ui.Z)(a),fs,{writable:!0,value:void 0}),(0,d.Z)((0,Ui.Z)(a),ds,{writable:!0,value:void 0}),(0,d.Z)((0,Ui.Z)(a),vs,{writable:!0,value:void 0}),!(e instanceof Ea))throw new Error("'filter' should be a State object from './cell_filtering.js'");if((0,w.Z)((0,Ui.Z)(a),cs,e),!(n instanceof Wa))throw new Error("'norm' should be a State object from './normalization.js'");if((0,w.Z)((0,Ui.Z)(a),hs,n),!(i instanceof as))throw new Error("'feat' should be a State object from './feature_selection.js'");return(0,w.Z)((0,Ui.Z)(a),fs,i),(0,w.Z)((0,Ui.Z)(a),vs,null===s?{}:s),(0,w.Z)((0,Ui.Z)(a),ds,null===o?{}:o),a.changed=!1,a}return(0,h.Z)(r,[{key:"free",value:function(){k((0,p.Z)(this,ds).hvg_buffer),k((0,p.Z)(this,ds).pcs)}},{key:"valid",value:function(){return!0}},{key:"fetchPCs",value:function(){return Ja((0,p.Z)(this,ds).pcs)}},{key:"fetchParameters",value:function(){return(0,l.Z)({},(0,p.Z)(this,vs))}},{key:"compute",value:function(e,t,r){if(this.changed=!1,((0,p.Z)(this,fs).changed||e!==(0,p.Z)(this,vs).num_hvgs)&&(ps(e,(0,p.Z)(this,fs),(0,p.Z)(this,ds)),(0,p.Z)(this,vs).num_hvgs=e,this.changed=!0),this.changed||(0,p.Z)(this,hs).changed||t!==(0,p.Z)(this,vs).num_pcs||r!==(0,p.Z)(this,vs).block_method){var n=(0,p.Z)(this,ds).hvg_buffer,i=(0,p.Z)(this,cs).fetchFilteredBlock(),a=(0,p.Z)(this,hs).fetchNormalizedMatrix();k((0,p.Z)(this,ds).pcs),(0,p.Z)(this,ds).pcs=b.runPCA(a,{features:n,numberOfPCs:t,block:i,blockMethod:r}),(0,p.Z)(this,vs).num_pcs=t,(0,p.Z)(this,vs).block_method=r,this.changed=!0}}},{key:"summary",value:function(){return Ka((0,p.Z)(this,ds).pcs)}},{key:"serialize",value:function(e){var t=e.createGroup(ls),r=t.createGroup("parameters");r.writeDataSet("num_hvgs","Int32",[],(0,p.Z)(this,vs).num_hvgs),r.writeDataSet("num_pcs","Int32",[],(0,p.Z)(this,vs).num_pcs),r.writeDataSet("block_method","String",[],(0,p.Z)(this,vs).block_method);var n=t.createGroup("results"),i=this.summary().var_exp;n.writeDataSet("var_exp","Float64",null,i);var a=this.fetchPCs();n.writeDataSet("pcs","Float64",[a.num_obs,a.num_pcs],a.pcs)}}],[{key:"defaults",value:function(){return{num_hvgs:2e3,num_pcs:20,block_method:"none"}}}]),r}(Xa);function ps(e,t,r){var n=t.fetchSortedResiduals(),i=E(n.length,"Uint8Array",r,"hvg_buffer");if(e<n.length){var a=n[n.length-e],s=t.fetchResiduals({unsafe:!0});i.array().forEach((function(e,t,r){r[t]=s[t]>=a}))}else i.fill(1);return i}function ws(e,t,r,n){var i,a=e.open(ls),s={},o=a.open("parameters");s={num_hvgs:o.open("num_hvgs",{load:!0}).values[0],num_pcs:o.open("num_pcs",{load:!0}).values[0]},"block_method"in o.children?(s.block_method=o.open("block_method",{load:!0}).values[0],"mnn"==s.block_method&&(s.block_method="weight")):s.block_method="none";var u={};try{ps(s.num_hvgs,n,u);var l=a.open("results"),c=l.open("var_exp",{load:!0}).values,h=l.open("pcs",{load:!0}).values;u.pcs=new $a(h,c),i=new ms(t,r,n,s,u)}catch(f){throw k(u.hvg_buffer),k(u.pcs),k(i),f}return i}var gs="adt_pca",bs=new WeakMap,ys=new WeakMap,Zs=new WeakMap,_s=new WeakMap,ks=function(e){(0,qi.Z)(r,e);var t=(0,Pi.Z)(r);function r(e,n){var i,a=arguments.length>2&&void 0!==arguments[2]?arguments[2]:null,s=arguments.length>3&&void 0!==arguments[3]?arguments[3]:null;if((0,c.Z)(this,r),i=t.call(this),(0,d.Z)((0,Ui.Z)(i),bs,{writable:!0,value:void 0}),(0,d.Z)((0,Ui.Z)(i),ys,{writable:!0,value:void 0}),(0,d.Z)((0,Ui.Z)(i),Zs,{writable:!0,value:void 0}),(0,d.Z)((0,Ui.Z)(i),_s,{writable:!0,value:void 0}),!(e instanceof Ea))throw new Error("'filter' should be a CellFilteringState object");if((0,w.Z)((0,Ui.Z)(i),bs,e),!(n instanceof Va))throw new Error("'norm' should be a AdtNormalizationState object");return(0,w.Z)((0,Ui.Z)(i),ys,n),(0,w.Z)((0,Ui.Z)(i),_s,null===a?{}:a),(0,w.Z)((0,Ui.Z)(i),Zs,null===s?{}:s),i.changed=!1,i}return(0,h.Z)(r,[{key:"free",value:function(){k((0,p.Z)(this,Zs).pcs)}},{key:"valid",value:function(){return(0,p.Z)(this,ys).valid()}},{key:"fetchPCs",value:function(){return this.valid()?Ja((0,p.Z)(this,Zs).pcs):null}},{key:"fetchParameters",value:function(){return(0,l.Z)({},(0,p.Z)(this,_s))}},{key:"compute",value:function(e,t){if(this.changed=!1,(0,p.Z)(this,ys).changed||e!==(0,p.Z)(this,_s).num_pcs||t!==(0,p.Z)(this,_s).block_method){if(this.valid()){var r=(0,p.Z)(this,bs).fetchFilteredBlock(),n=(0,p.Z)(this,ys).fetchNormalizedMatrix();k((0,p.Z)(this,Zs).pcs),(0,p.Z)(this,Zs).pcs=b.runPCA(n,{numberOfPCs:e,block:r,blockMethod:t}),this.changed=!0}(0,p.Z)(this,_s).num_pcs=e,(0,p.Z)(this,_s).block_method=t}}},{key:"summary",value:function(){return this.valid()?Ka((0,p.Z)(this,Zs).pcs):null}},{key:"serialize",value:function(e){var t=e.createGroup(gs),r=t.createGroup("parameters");r.writeDataSet("num_pcs","Int32",[],(0,p.Z)(this,_s).num_pcs),r.writeDataSet("block_method","String",[],(0,p.Z)(this,_s).block_method);var n=t.createGroup("results");if(this.valid()){var i=this.summary().var_exp;n.writeDataSet("var_exp","Float64",null,i);var a=this.fetchPCs();n.writeDataSet("pcs","Float64",[a.num_obs,a.num_pcs],a.pcs)}}}],[{key:"defaults",value:function(){return{num_pcs:20,block_method:"none"}}}]),r}(Xa);function As(e,t,r){var n,i={},a=ks.defaults();if(gs in e.children){var s=e.open(gs),o=s.open("parameters");a.num_pcs=o.open("num_pcs",{load:!0}).values[0],a.block_method=o.open("block_method",{load:!0}).values[0];try{var u=s.open("results");if("var_exp"in u.children){var l=u.open("var_exp",{load:!0}).values,c=u.open("pcs",{load:!0}).values;i.pcs=new $a(c,l)}n=new ks(t,r,a,i)}catch(h){throw k(i.pcs),k(n),h}}else n=new ks(t,r,a,i);return n}var xs="combine_embeddings",Es=new WeakMap,Ss=new WeakMap,Os=new WeakMap,Is=function(){function e(t){var r=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null,n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:null;(0,c.Z)(this,e),(0,d.Z)(this,Es,{writable:!0,value:void 0}),(0,d.Z)(this,Ss,{writable:!0,value:void 0}),(0,d.Z)(this,Os,{writable:!0,value:void 0});for(var i=0,a=Object.values(t);i<a.length;i++){var s=a[i];if(!(s instanceof Xa))throw new Error("each entry of 'pc_states' should be a PcaStateBase object")}(0,w.Z)(this,Es,t),(0,w.Z)(this,Ss,null===r?{}:r),(0,w.Z)(this,Os,null===n?{}:n),this.changed=!1}return(0,h.Z)(e,[{key:"free",value:function(){k((0,p.Z)(this,Os).combined_buffer)}},{key:"fetchPCs",value:function(){return{pcs:(0,p.Z)(this,Os).combined_buffer,num_obs:(0,p.Z)(this,Os).num_cells,num_pcs:(0,p.Z)(this,Os).total_dims}}},{key:"fetchParameters",value:function(){var e=(0,l.Z)({},(0,p.Z)(this,Ss));return null!==e.weights&&(e.weights=(0,l.Z)({},e.weights)),e}},{key:"compute",value:function(e,t){this.changed=!1;for(var r=0,i=Object.entries((0,p.Z)(this,Es));r<i.length;r++){var a=(0,o.Z)(i[r],2);a[0];a[1].changed&&(this.changed=!0)}var s=S((0,p.Z)(this,Es),"PCA");if(s.length>1){if(this.changed||t!==(0,p.Z)(this,Ss).approximate||x(e,(0,p.Z)(this,Ss).weights)){var u=null;if(null!==e){u=[];var c,h=[],f=(0,n.Z)(s);try{for(f.s();!(c=f.n()).done;){var d=c.value;if(!(d in e))throw new Error("no weight specified for '"+d+"'");e[d]>0&&(u.push(e[d]),h.push(d))}}catch(Ke){f.e(Ke)}finally{f.f()}s=h}if(1==s.length){var v=(0,p.Z)(this,Es)[s[0]].fetchPCs();this.constructor.createPcsView((0,p.Z)(this,Os),v)}else{var m,w=[],g=0,y=null,Z=(0,n.Z)(s);try{for(Z.s();!(m=Z.n()).done;){var _=m.value,k=(0,p.Z)(this,Es)[_].fetchPCs();if(w.push(k.pcs),null==y)y=k.num_obs;else if(y!==k.num_obs)throw new Error("number of cells should be consistent across all embeddings");g+=k.num_pcs}}catch(Ke){Z.e(Ke)}finally{Z.f()}var A=E(y*g,"Float64Array",(0,p.Z)(this,Os),"combined_buffer");b.scaleByNeighbors(w,y,{buffer:A,weights:u,approximate:t}),(0,p.Z)(this,Os).num_cells=y,(0,p.Z)(this,Os).total_dims=g}this.changed=!0}}else if(this.changed){var O=(0,p.Z)(this,Es)[s[0]].fetchPCs();this.constructor.createPcsView((0,p.Z)(this,Os),O)}null!==e&&(e=(0,l.Z)({},e)),(0,p.Z)(this,Ss).weights=e,(0,p.Z)(this,Ss).approximate=t}},{key:"summary",value:function(){return{}}},{key:"serialize",value:function(e){var t=e.createGroup(xs),r=t.createGroup("parameters");r.writeDataSet("approximate","Uint8",[],(0,p.Z)(this,Ss).approximate);var n=r.createGroup("weights");if(null!==(0,p.Z)(this,Ss).weights)for(var i=0,a=Object.entries((0,p.Z)(this,Ss).weights);i<a.length;i++){var s=(0,o.Z)(a[i],2),u=s[0],l=s[1];n.writeDataSet(u,"Float64",[],l)}var c=t.createGroup("results"),h=this.fetchPCs();null===h.pcs.owner&&c.writeDataSet("combined","Float64",[h.num_obs,h.num_pcs],h.pcs)}}],[{key:"defaults",value:function(){return{weights:null,approximate:!0}}},{key:"createPcsView",value:function(e,t){k(e.combined_buffer),e.combined_buffer=t.pcs.view(),e.num_cells=t.num_obs,e.total_dims=t.num_pcs}}]),e}();function Cs(e,t){var r,i={},a=Is.defaults();try{if(xs in e.children){var s=e.open(xs),o=s.open("parameters");a.approximate=o.open("approximate",{load:!0}).values[0]>0;var u=o.open("weights"),l=Object.keys(u.children);if(l.length){a.weights={};var c,h=(0,n.Z)(l);try{for(h.s();!(c=h.n()).done;){var f=c.value;a.weights[f]=u.open(f,{load:!0}).values[0]}}catch(Ke){h.e(Ke)}finally{h.f()}}var d=s.open("results");if("combined"in d.children){var v=d.open("combined",{load:!0});i.num_cells=v.shape[0],i.total_dims=v.shape[1];var m=v.values;i.combined_buffer=b.createFloat64WasmArray(m.length),i.combined_buffer.set(m)}}if(!("combined_buffer"in i)){var p=S(t,"PCA");if(p.length>1&&null!==a.weights){var w,g=[],y=(0,n.Z)(p);try{for(y.s();!(w=y.n()).done;){var Z=w.value;a.weights[Z]>0&&g.push(Z)}}catch(Ke){y.e(Ke)}finally{y.f()}p=g}if(1!=p.length)throw new Error("only one upstream PCA state should be valid with non-zero weight if 'combined' is not available");var _=t[p[0]].fetchPCs();Is.createPcsView(i,_)}r=new Is(t,a,i)}catch(A){throw k(i.combined_buffer),k(r),A}return r}var Rs="batch_correction",Ns=new WeakMap,Ms=new WeakMap,Fs=new WeakMap,Ds=new WeakMap,zs=function(){function e(t,r){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:null,i=arguments.length>3&&void 0!==arguments[3]?arguments[3]:null;if((0,c.Z)(this,e),(0,d.Z)(this,Ns,{writable:!0,value:void 0}),(0,d.Z)(this,Ms,{writable:!0,value:void 0}),(0,d.Z)(this,Fs,{writable:!0,value:void 0}),(0,d.Z)(this,Ds,{writable:!0,value:void 0}),!(t instanceof Ea))throw new Error("'filter' should be a CellFilteringState object");if((0,w.Z)(this,Ns,t),!(r instanceof Is))throw new Error("'pca' should be a CombineEmbeddingsState object");(0,w.Z)(this,Ms,r),(0,w.Z)(this,Fs,null===n?{}:n),(0,w.Z)(this,Ds,null===i?{}:i),this.changed=!1}return(0,h.Z)(e,[{key:"free",value:function(){k((0,p.Z)(this,Ds).corrected)}},{key:"fetchPCs",value:function(){var e=(0,p.Z)(this,Ms).fetchPCs();return e.pcs=(0,p.Z)(this,Ds).corrected,e}},{key:"fetchParameters",value:function(){return(0,l.Z)({},(0,p.Z)(this,Fs))}},{key:"compute",value:function(e,t,r){this.changed=!1,((0,p.Z)(this,Ns).changed||(0,p.Z)(this,Ms).changed)&&(this.changed=!0);var n=(0,p.Z)(this,Ns).fetchFilteredBlock(),i="mnn"==e&&null!==n;if((this.changed||e!==(0,p.Z)(this,Fs).method||t!==(0,p.Z)(this,Fs).num_neighbors||r!==(0,p.Z)(this,Fs).approximate)&&i){var a=(0,p.Z)(this,Ms).fetchPCs(),s=E(a.pcs.length,"Float64Array",(0,p.Z)(this,Ds),"corrected");b.mnnCorrect(a.pcs,n,{k:t,buffer:s,numberOfCells:a.num_obs,numberOfDims:a.num_pcs,approximate:r}),this.changed=!0}if(this.changed&&!i){k((0,p.Z)(this,Ds).corrected);var o=(0,p.Z)(this,Ms).fetchPCs();(0,p.Z)(this,Ds).corrected=o.pcs.view()}(0,p.Z)(this,Fs).method=e,(0,p.Z)(this,Fs).num_neighbors=t,(0,p.Z)(this,Fs).approximate=r}},{key:"summary",value:function(){return{}}},{key:"serialize",value:function(e){var t=e.createGroup(Rs),r=t.createGroup("parameters");r.writeDataSet("method","String",[],(0,p.Z)(this,Fs).method),r.writeDataSet("num_neighbors","Int32",[],(0,p.Z)(this,Fs).num_neighbors),r.writeDataSet("approximate","Uint8",[],Number((0,p.Z)(this,Fs).approximate));var n=t.createGroup("results"),i=this.fetchPCs();null===i.pcs.owner&&n.writeDataSet("corrected","Float64",[i.num_obs,i.num_pcs],i.pcs)}}],[{key:"defaults",value:function(){return{method:"mnn",num_neighbors:15,approximate:!0}}}]),e}();function Bs(e,t,r){var n,i={},a=zs.defaults();if(Rs in e.children){var s=e.open(Rs),o=s.open("parameters");a.method=o.open("method",{load:!0}).values[0],a.num_neighbors=o.open("num_neighbors",{load:!0}).values[0],a.approximate=o.open("approximate",{load:!0}).values[0]>0;try{var u=s.open("results");if("corrected"in u.children){var l=u.open("corrected",{load:!0}).values;i.corrected=b.createFloat64WasmArray(l.length),i.corrected.set(l)}else{var c=r.fetchPCs();i.corrected=c.pcs.view()}n=new zs(t,r,a,i)}catch(d){throw k(i.corrected),k(n),d}}else{var h=e.open("pca").open("results");if("corrected"in h){var f=h.open("corrected",{load:!0}).values;E(f.length,"Float64Array",i,"corrected").set(f)}n=new zs(t,r,a,i)}return n}var Ws="neighbor_index",Gs=new WeakMap,js=new WeakMap,Ts=new WeakMap,Qs=new WeakSet,Us=function(){function e(t){var r=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null,n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:null;if((0,c.Z)(this,e),(0,f.Z)(this,Qs),(0,d.Z)(this,Gs,{writable:!0,value:void 0}),(0,d.Z)(this,js,{writable:!0,value:void 0}),(0,d.Z)(this,Ts,{writable:!0,value:void 0}),!(t instanceof zs))throw new Error("'correct' should be a BatchCorrectionState object");(0,w.Z)(this,Gs,t),(0,w.Z)(this,js,null===r?{}:r),(0,w.Z)(this,Ts,null===n?{}:n),this.changed=!1}return(0,h.Z)(e,[{key:"free",value:function(){k((0,p.Z)(this,Ts).raw)}},{key:"fetchIndex",value:function(){return"raw"in(0,p.Z)(this,Ts)||(0,v.Z)(this,Qs,qs).call(this,(0,p.Z)(this,js).approximate),(0,p.Z)(this,Ts).raw}},{key:"fetchParameters",value:function(){return(0,l.Z)({},(0,p.Z)(this,js))}},{key:"compute",value:function(e){this.changed=!1,((0,p.Z)(this,Gs).changed||e!=(0,p.Z)(this,js).approximate)&&(k((0,p.Z)(this,Ts).raw),(0,v.Z)(this,Qs,qs).call(this,e),(0,p.Z)(this,js).approximate=e,this.changed=!0)}},{key:"summary",value:function(){return{}}},{key:"serialize",value:function(e){var t=e.createGroup("neighbor_index");t.createGroup("parameters").writeDataSet("approximate","Uint8",[],Number((0,p.Z)(this,js).approximate)),t.createGroup("results")}}],[{key:"defaults",value:function(){return{approximate:!0}}}]),e}();function qs(e){var t=(0,p.Z)(this,Gs).fetchPCs();(0,p.Z)(this,Ts).raw=b.buildNeighborSearchIndex(t.pcs,{approximate:e,numberOfDims:t.num_pcs,numberOfCells:t.num_obs})}function Ps(e,t){var r;r={approximate:e.open("neighbor_index").open("parameters").open("approximate",{load:!0}).values[0]>0};return new Us(t,r,{})}var Ls={min:0,mean:1,min_rank:4},Vs={0:"min",1:"mean",4:"min_rank"};function Hs(e,t,r){for(var n=arguments.length>3&&void 0!==arguments[3]?arguments[3]:{},i=n.no_summaries,a=void 0!==i&&i,s=0,u=["means","detected"];s<u.length;s++){var l=u[s],c=t[l](r,{copy:"hdf5"});e.writeDataSet(l,"Float64",null,c)}for(var h=function(){var n=d[f],i=n;"delta_detected"==n&&(i="deltaDetected");var s=function(e){return t[i](r,{summary:e,copy:"hdf5"})};if(a){var u=s(Ls.mean);e.writeDataSet(n,"Float64",null,u)}else for(var l=e.createGroup(n),c=0,h=Object.entries(Ls);c<h.length;c++){var v=(0,o.Z)(h[c],2),m=v[0],p=s(v[1]);l.writeDataSet(m,"Float64",null,p)}},f=0,d=["lfc","delta_detected","auc","cohen"];f<d.length;f++)h()}function Ys(e,t){for(var r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{},n=r.no_summaries,i=void 0!==n&&n,a={},s=0,o=["means","detected"];s<o.length;s++){var u=o[s];a[u]=e.open(u,{load:!0}).values,t(a[u])}for(var l=0,c=["lfc","delta_detected","auc","cohen"];l<c.length;l++){var h=c[l];if(i)a[h]=e.open(h,{load:!0}).values;else{for(var f=e.open(h),d={},v=0,m=Object.keys(Ls);v<m.length;v++){var p=m[v];d[p]=f.open(p,{load:!0}).values,t(d[p])}a[h]=d}}return a}function Js(e,t,r){var n;r&&void 0!==r||(r="cohen-min-rank");var i,a=!1,s=1;if(r.match(/-min$/)?s=0:r.match(/-min-rank$/)&&(a=!0,s=4),r.match(/^cohen-/))i=e.cohen(t,{summary:s,copy:!1});else if(r.match(/^auc-/))i=e.auc(t,{summary:s,copy:!1});else if(r.match(/^lfc-/))i=e.lfc(t,{summary:s,copy:!1});else{if(!r.match(/^delta-d-/))throw"unknown rank type '"+r+"'";i=e.deltaDetected(t,{summary:s,copy:!1})}n=new Int32Array(i.length);for(var o=0;o<n.length;o++)n[o]=o;a?n.sort((function(e,t){return i[e]-i[t]})):n.sort((function(e,t){return i[t]-i[e]}));var u=function(e){for(var t=new Float64Array(e.length),r=0;r<n.length;r++)t[r]=e[n[r]];return t},l=u(e.detected(t,{copy:!1})),c=u(e.means(t,{copy:!1})),h=u(e.lfc(t,{summary:1,copy:!1})),f=u(e.deltaDetected(t,{summary:1,copy:!1}));return{ordering:n,means:c,detected:l,lfc:h,delta_detected:f}}function Ks(e,t,r,n,i,a){"versus"in i||(i.versus={});var s=i.versus,o=e<t?t:e,u=e<t?e:t;o in s||(s[o]={});var l=s[o];u in l||(l[u]={});var c=l[u];return n in c||(c[n]=a(u,o)),Js(c[n],e<t?0:1,r+"-mean")}function Xs(e){if("versus"in e){for(var t=0,r=Object.values(e.versus);t<r.length;t++)for(var n=r[t],i=0,a=Object.values(n);i<a.length;i++)for(var s=a[i],o=0,u=Object.values(s);o<u.length;o++){var l=u[o];b.free(l)}delete e.versus}}function $s(e){var t=0,r={};e.forEach((function(n,i){n in r||(r[n]=t,t++),e[i]=r[n]}))}var eo=new WeakMap,to=new WeakMap,ro=new WeakMap,no=new WeakSet,io=new WeakSet,ao=new WeakSet,so=new WeakSet,oo=function(){function e(t){var r=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null,n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:null;if((0,c.Z)(this,e),(0,f.Z)(this,so),(0,f.Z)(this,ao),(0,f.Z)(this,io),(0,f.Z)(this,no),(0,d.Z)(this,eo,{writable:!0,value:void 0}),(0,d.Z)(this,to,{writable:!0,value:void 0}),(0,d.Z)(this,ro,{writable:!0,value:void 0}),!(t instanceof Us))throw new Error("'index' should be a State object from './neighbor_index.js'");(0,w.Z)(this,eo,t),(0,w.Z)(this,to,null===r?{}:r),(0,w.Z)(this,ro,null===n?{}:n),this.changed=!1}return(0,h.Z)(e,[{key:"free",value:function(){k((0,p.Z)(this,ro).neighbors),k((0,p.Z)(this,ro).graph),k((0,p.Z)(this,ro).clusters)}},{key:"fetchClustersAsWasmArray",value:function(){if((0,v.Z)(this,no,uo).call(this))return(0,p.Z)(this,ro).clusters.membership({copy:"view"});throw"cannot fetch SNN clusters from an invalid state"}},{key:"fetchParameters",value:function(){return(0,l.Z)({},(0,p.Z)(this,to))}},{key:"compute",value:function(e,t,r,n){this.changed=!1,((0,p.Z)(this,eo).changed||t!==(0,p.Z)(this,to).k)&&(k((0,p.Z)(this,ro).neighbors),e?(0,v.Z)(this,io,lo).call(this,t):delete(0,p.Z)(this,ro).neighbors,(0,p.Z)(this,to).k=t,this.changed=!0),(this.changed||r!==(0,p.Z)(this,to).scheme)&&(k((0,p.Z)(this,ro).graph),e?(0,v.Z)(this,ao,co).call(this,r):delete(0,p.Z)(this,ro).graph,(0,p.Z)(this,to).scheme=r,this.changed=!0),(this.changed||n!==(0,p.Z)(this,to).resolution||!(0,v.Z)(this,no,uo).call(this)&&e)&&(k((0,p.Z)(this,ro).clusters),e?(0,v.Z)(this,so,ho).call(this,n):delete(0,p.Z)(this,ro).clusters,(0,p.Z)(this,to).resolution=n,this.changed=!0)}},{key:"summary",value:function(){return{}}},{key:"serialize",value:function(e){var t=e.createGroup("snn_graph_cluster"),r=t.createGroup("parameters");r.writeDataSet("k","Int32",[],(0,p.Z)(this,to).k),r.writeDataSet("scheme","String",[],(0,p.Z)(this,to).scheme),r.writeDataSet("resolution","Float64",[],(0,p.Z)(this,to).resolution);var n=t.createGroup("results");if((0,v.Z)(this,no,uo).call(this)){var i=this.fetchClustersAsWasmArray();n.writeDataSet("clusters","Int32",null,i)}}}]),e}();function uo(){return"clusters"in(0,p.Z)(this,ro)}function lo(e){(0,p.Z)(this,ro).neighbors=b.findNearestNeighbors((0,p.Z)(this,eo).fetchIndex(),e)}function co(e){"neighbors"in(0,p.Z)(this,ro)||(0,v.Z)(this,io,lo).call(this,(0,p.Z)(this,to).k),(0,p.Z)(this,ro).graph=b.buildSNNGraph((0,p.Z)(this,ro).neighbors,{scheme:e})}function ho(e){"graph"in(0,p.Z)(this,ro)||(0,v.Z)(this,ao,co).call(this,(0,p.Z)(this,to).scheme),(0,p.Z)(this,ro).clusters=b.clusterSNNGraph((0,p.Z)(this,ro).graph,{resolution:e})}var fo=function(){function e(t){(0,c.Z)(this,e),this.buffer=b.createInt32WasmArray(t.length),this.buffer.set(t)}return(0,h.Z)(e,[{key:"membership",value:function(e){var t=e.copy;return _(this.buffer,t)}},{key:"free",value:function(){this.buffer.free()}}]),e}();function vo(e,t){var r=e.open("snn_graph_cluster"),n={},i=r.open("parameters");n.k=i.open("k",{load:!0}).values[0],n.scheme=i.open("scheme",{load:!0}).values[0],"string"!==typeof n.scheme&&(n.scheme="rank"),n.resolution=i.open("resolution",{load:!0}).values[0];var a={},s=r.open("results");if("clusters"in s.children){var o=s.open("clusters",{load:!0}).values;a.clusters=new fo(o)}return new oo(t,n,a)}var mo=new WeakMap,po=new WeakMap,wo=new WeakMap,go=new WeakSet,bo=function(){function e(t){var r=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null,n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:null;if((0,c.Z)(this,e),(0,f.Z)(this,go),(0,d.Z)(this,mo,{writable:!0,value:void 0}),(0,d.Z)(this,po,{writable:!0,value:void 0}),(0,d.Z)(this,wo,{writable:!0,value:void 0}),!(t instanceof zs))throw new Error("'correct' should be a BatchCorrectionState object");(0,w.Z)(this,mo,t),(0,w.Z)(this,po,null===r?{}:r),(0,w.Z)(this,wo,null===n?{}:n),this.changed=!1}return(0,h.Z)(e,[{key:"free",value:function(){k((0,p.Z)(this,wo).raw)}},{key:"fetchClustersAsWasmArray",value:function(){if((0,v.Z)(this,go,yo).call(this))return(0,p.Z)(this,wo).raw.clusters({copy:"view"});throw new Error("cannot fetch k-means clusters from an invalid state")}},{key:"fetchParameters",value:function(){return(0,l.Z)({},(0,p.Z)(this,po))}},{key:"compute",value:function(e,t){if(this.changed=!1,(0,p.Z)(this,mo).changed||t!=(0,p.Z)(this,po).k||!(0,v.Z)(this,go,yo).call(this)&&e){if(k((0,p.Z)(this,wo).raw),e){var r=(0,p.Z)(this,mo).fetchPCs();(0,p.Z)(this,wo).raw=b.clusterKmeans(r.pcs,t,{numberOfDims:r.num_pcs,numberOfCells:r.num_obs,initMethod:"pca-part"})}else delete(0,p.Z)(this,wo).raw;(0,p.Z)(this,po).k=t,this.changed=!0}}},{key:"summary",value:function(){return{}}},{key:"serialize",value:function(e){var t=e.createGroup("kmeans_cluster");t.createGroup("parameters").writeDataSet("k","Int32",[],(0,p.Z)(this,po).k);var r=t.createGroup("results");if((0,v.Z)(this,go,yo).call(this)){var n=this.fetchClustersAsWasmArray();r.writeDataSet("clusters","Int32",null,n)}}}]),e}();function yo(){return"raw"in(0,p.Z)(this,wo)}var Zo=function(){function e(t){(0,c.Z)(this,e),this.buffer=b.createInt32WasmArray(t.length),this.buffer.set(t)}return(0,h.Z)(e,[{key:"clusters",value:function(e){var t=e.copy;return _(this.buffer,t)}},{key:"free",value:function(){this.buffer.free()}}]),e}();function _o(e,t){var r={k:10},n={};if("kmeans_cluster"in e.children){var i=e.open("kmeans_cluster"),a=i.open("parameters");r.k=a.open("k",{load:!0}).values[0];var s=i.open("results");if("clusters"in s.children){var o=s.open("clusters",{load:!0}).values;n.raw=new Zo(o)}}return new bo(t,r,n)}var ko=new WeakMap,Ao=new WeakMap,xo=new WeakMap,Eo=new WeakMap,So=function(){function e(t,r){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:null,i=arguments.length>3&&void 0!==arguments[3]?arguments[3]:null;if((0,c.Z)(this,e),(0,d.Z)(this,ko,{writable:!0,value:void 0}),(0,d.Z)(this,Ao,{writable:!0,value:void 0}),(0,d.Z)(this,xo,{writable:!0,value:void 0}),(0,d.Z)(this,Eo,{writable:!0,value:void 0}),!(t instanceof oo))throw new Error("'snn' should be a State object from './snn_graph_cluster.js'");if((0,w.Z)(this,ko,t),!(r instanceof bo))throw new Error("'kmeans' should be a State object from './kmeans_cluster.js'");(0,w.Z)(this,Ao,r),(0,w.Z)(this,xo,null===n?{}:n),(0,w.Z)(this,Eo,null===i?{}:i),this.changed=!1}return(0,h.Z)(e,[{key:"free",value:function(){}},{key:"fetchClustersAsWasmArray",value:function(){return"snn_graph"==(0,p.Z)(this,xo).method?(0,p.Z)(this,ko).fetchClustersAsWasmArray():"kmeans"==(0,p.Z)(this,xo).method?(0,p.Z)(this,Ao).fetchClustersAsWasmArray():void 0}},{key:"fetchParameters",value:function(){return(0,l.Z)({},(0,p.Z)(this,xo))}},{key:"fetchClusterIndices",value:function(e){var t=[];return this.fetchClustersAsWasmArray().forEach((function(r,n){r==e&&t.push(n)})),t}},{key:"compute",value:function(e){this.changed=!0,e==(0,p.Z)(this,xo).method&&("snn_graph"==e?(0,p.Z)(this,ko).changed||(this.changed=!1):"kmeans"==e&&((0,p.Z)(this,Ao).changed||(this.changed=!1))),(0,p.Z)(this,xo).method=e}},{key:"summary",value:function(){return{clusters:this.fetchClustersAsWasmArray().slice()}}},{key:"serialize",value:function(e){var t=e.createGroup("choose_clustering");t.createGroup("parameters").writeDataSet("method","String",[],(0,p.Z)(this,xo).method),t.createGroup("results")}}]),e}();function Oo(e,t,r){var n;n={method:e.open("choose_clustering").open("parameters").open("method",{load:!0}).values[0]};return new So(t,r,n,{})}var Io="marker_detection",Co=new WeakMap,Ro=new WeakMap,No=new WeakMap,Mo=new WeakMap,Fo=new WeakMap,Do=function(){function e(t,r,n){var i=arguments.length>3&&void 0!==arguments[3]?arguments[3]:null,a=arguments.length>4&&void 0!==arguments[4]?arguments[4]:null;if((0,c.Z)(this,e),(0,d.Z)(this,Co,{writable:!0,value:void 0}),(0,d.Z)(this,Ro,{writable:!0,value:void 0}),(0,d.Z)(this,No,{writable:!0,value:void 0}),(0,d.Z)(this,Mo,{writable:!0,value:void 0}),(0,d.Z)(this,Fo,{writable:!0,value:void 0}),!(t instanceof Ea))throw new Error("'filter' should be a State object from './cell_filtering.js'");(0,w.Z)(this,Co,t);for(var s=0,o=Object.values(r);s<o.length;s++){var u=o[s];if(!(u instanceof Ra))throw new Error("'norm' should be a NormalizationStateBase object")}if((0,w.Z)(this,Ro,r),!(n instanceof So))throw new Error("'choice' should be a State object from './choose_clustering.js'");(0,w.Z)(this,No,n),(0,w.Z)(this,Mo,null===i?{}:i),(0,w.Z)(this,Fo,null===a?{raw:{}}:a),this.changed=!1}return(0,h.Z)(e,[{key:"free",value:function(){for(var e=0,t=Object.values((0,p.Z)(this,Fo).raw);e<t.length;e++){k(t[e])}Xs((0,p.Z)(this,Fo))}},{key:"fetchGroupResults",value:function(e,t,r){return Js((0,p.Z)(this,Fo).raw[r],e,t)}},{key:"numberOfGroups",value:function(){return Object.values((0,p.Z)(this,Fo).raw)[0].numberOfGroups()}},{key:"fetchGroupMeans",value:function(e,t,r){var n=r.copy,i=void 0===n||n;return(0,p.Z)(this,Fo).raw[t].means(e,{copy:i})}},{key:"fetchParameters",value:function(){return(0,l.Z)({},(0,p.Z)(this,Mo))}},{key:"compute",value:function(){this.changed=!1;for(var e=0,t=Object.entries((0,p.Z)(this,Ro));e<t.length;e++){var r=(0,o.Z)(t[e],2),n=r[0],i=r[1];if(i.valid()&&(i.changed||(0,p.Z)(this,No).changed)){var a=i.fetchNormalizedMatrix(),s=(0,p.Z)(this,No).fetchClustersAsWasmArray(),u=(0,p.Z)(this,Co).fetchFilteredBlock();k((0,p.Z)(this,Fo).raw[n]),(0,p.Z)(this,Fo).raw[n]=b.scoreMarkers(a,s,{block:u}),this.changed=!0}}this.changed&&Xs((0,p.Z)(this,Fo))}},{key:"computeVersus",value:function(e,t,r,n){var i=(0,p.Z)(this,No).fetchClustersAsWasmArray(),a=(0,p.Z)(this,Ro)[n].fetchNormalizedMatrix(),s=(0,p.Z)(this,Co).fetchFilteredBlock();return this.constructor.computeVersusCustom(e,t,r,n,a,i,{cache:(0,p.Z)(this,Fo),block:s})}},{key:"summary",value:function(){return{}}},{key:"serialize",value:function(e){var t=e.createGroup("marker_detection");t.createGroup("parameters");for(var r=t.createGroup("results").createGroup("per_cluster"),n=0,i=Object.entries((0,p.Z)(this,Fo).raw);n<i.length;n++)for(var a=(0,o.Z)(i[n],2),s=a[0],u=a[1],l=r.createGroup(s),c=u.numberOfGroups(),h=0;h<c;h++){Hs(l.createGroup(String(h)),u,h)}}}],[{key:"defaults",value:function(){return{}}},{key:"computeVersusCustom",value:function(e,t,r,n,i,a){var s=arguments.length>6&&void 0!==arguments[6]?arguments[6]:{},o=s.cache,u=void 0===o?{}:o,l=s.block,c=void 0===l?null:l,h=function(e,t){var r=[],n=[],s=!1,o=!1;if(a.forEach((function(i,a){i==e?(r.push(0),n.push(a),s=!0):i==t&&(r.push(1),n.push(a),o=!0)})),!s||!o)throw new Error("non-zero entries should be present for both requested clusters in versus mode");var u,l,h=null;if(null!==c){var f=c.array();$s(h=n.map((function(e){return f[e]})))}try{l=b.subsetColumns(i,n),u=b.scoreMarkers(l,r,{block:h})}finally{k(l)}return u};return Ks(e,t,r,n,u,h)}}]),e}(),zo=function(){function e(t){(0,c.Z)(this,e),this.clusters=t}return(0,h.Z)(e,[{key:"effect_grabber",value:function(e,t,r,n){var i=Vs[r];return _(this.clusters[t][e][i],n)}},{key:"lfc",value:function(e,t){var r=t.summary,n=t.copy;return this.effect_grabber("lfc",e,r,n)}},{key:"deltaDetected",value:function(e,t){var r=t.summary,n=t.copy;return this.effect_grabber("delta_detected",e,r,n)}},{key:"cohen",value:function(e,t){var r=t.summary,n=t.copy;return this.effect_grabber("cohen",e,r,n)}},{key:"auc",value:function(e,t){var r=t.summary,n=t.copy;return this.effect_grabber("auc",e,r,n)}},{key:"stat_grabber",value:function(e,t,r){return _(this.clusters[t][e],r)}},{key:"means",value:function(e,t){var r=t.copy;return this.stat_grabber("means",e,r)}},{key:"detected",value:function(e,t){var r=t.copy;return this.stat_grabber("detected",e,r)}},{key:"numberOfGroups",value:function(){return Object.keys(this.clusters).length}},{key:"free",value:function(){}}]),e}();function Bo(e,t,r,n,i){var a={},s=e.open("marker_detection").open("results");if("clusters"in s.children){for(var o=s.open("clusters"),u={},l=0,c=Object.keys(o.children);l<c.length;l++){var h=c[l];u[Number(h)]=Ys(o.open(h),t.RNA)}a.raw={RNA:new zo(u)}}else{var f=s.open("per_cluster");a.raw={};for(var d=0,v=Object.keys(f.children);d<v.length;d++){for(var m=v[d],p={},w=f.open(m),g=0,b=Object.keys(w.children);g<b.length;g++){var y=b[g];p[Number(y)]=Ys(w.open(y),t[m])}a.raw[m]=new zo(p)}}return new Do(r,n,i,{},a)}var Wo="custom_selections",Go=new WeakMap,jo=new WeakMap,To=new WeakMap,Qo=new WeakMap,Uo=new WeakSet,qo=function(){function e(t,r){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:null,i=arguments.length>3&&void 0!==arguments[3]?arguments[3]:null;if((0,c.Z)(this,e),(0,f.Z)(this,Uo),(0,d.Z)(this,Go,{writable:!0,value:void 0}),(0,d.Z)(this,jo,{writable:!0,value:void 0}),(0,d.Z)(this,To,{writable:!0,value:void 0}),(0,d.Z)(this,Qo,{writable:!0,value:void 0}),!(t instanceof Ea))throw new Error("'filter' should be a State object from './cell_filtering.js'");(0,w.Z)(this,Go,t);for(var a=0,s=Object.values(r);a<s.length;a++){var o=s[a];if(!(o instanceof Ra))throw new Error("'norm' should be a NormalizationStateBase object")}(0,w.Z)(this,jo,r),(0,w.Z)(this,To,null===i?{results:{}}:i),(0,w.Z)(this,Qo,null===n?{selections:{}}:n),this.changed=!1}return(0,h.Z)(e,[{key:"free",value:function(){k((0,p.Z)(this,To).buffer);for(var e=0,t=Object.keys((0,p.Z)(this,To).results);e<t.length;e++){var r=t[e];(0,v.Z)(this,Uo,Po).call(this,r)}Xs((0,p.Z)(this,To))}},{key:"addSelection",value:function(e,t){var r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{},i=r.copy,a=void 0===i||i,s=S((0,p.Z)(this,jo)),o=(0,p.Z)(this,jo)[s[0]].fetchNormalizedMatrix();O(t,o.numberOfColumns());var u=E(o.numberOfColumns(),"Int32Array",(0,p.Z)(this,To));u.fill(0);var l=u.array();t.forEach((function(e){l[e]=1}));var c,h={},f=(0,n.Z)(s);try{for(f.s();!(c=f.n()).done;){var d=c.value,m=(0,p.Z)(this,jo)[d];if(m.valid()){var w=m.fetchNormalizedMatrix();h[d]=b.scoreMarkers(w,u)}}}catch(Ke){f.e(Ke)}finally{f.f()}e in(0,p.Z)(this,To).results&&(0,v.Z)(this,Uo,Po).call(this,e),(0,p.Z)(this,To).results[e]={raw:h},a&&(t=t.slice()),(0,p.Z)(this,Qo).selections[e]=t}},{key:"removeSelection",value:function(e){(0,v.Z)(this,Uo,Po).call(this,e),delete(0,p.Z)(this,To).results[e],delete(0,p.Z)(this,Qo).selections[e]}},{key:"fetchResults",value:function(e,t,r){return Js((0,p.Z)(this,To).results[e].raw[r],1,t+"-mean")}},{key:"fetchSelectionIndices",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},r=t.copy,n=void 0===r||r,i=(0,p.Z)(this,Qo).selections[e];return n&&(i=i.slice()),i}},{key:"fetchSelections",value:function(){for(var e={},t=0,r=Object.entries((0,p.Z)(this,Qo).selections);t<r.length;t++){var n=(0,o.Z)(r[t],2),i=n[0],a=n[1];e[i]=a.slice()}return e}},{key:"fetchParameters",value:function(){return{}}},{key:"compute",value:function(){if(this.changed=!1,(0,p.Z)(this,Go).changed){for(var e=0,t=Object.entries((0,p.Z)(this,To).results);e<t.length;e++){var r=t[e];(0,v.Z)(this,Uo,Po).call(this,r)}(0,p.Z)(this,Qo).selections={},(0,p.Z)(this,To).results={},Xs((0,p.Z)(this,To)),this.changed=!0}}},{key:"computeVersus",value:function(e,t,r,n){var i=(0,p.Z)(this,Go).fetchFilteredBlock(),a=(0,p.Z)(this,jo)[n].fetchNormalizedMatrix();return this.constructor.computeVersusCustom(e,t,r,n,a,(0,p.Z)(this,Qo).selections,{cache:(0,p.Z)(this,To),block:i})}},{key:"summary",value:function(){return{}}},{key:"serialize",value:function(e){for(var t=e.createGroup("custom_selections"),r=t.createGroup("parameters").createGroup("selections"),n=0,i=Object.entries((0,p.Z)(this,Qo).selections);n<i.length;n++){var a=(0,o.Z)(i[n],2),s=a[0],u=a[1];r.writeDataSet(String(s),"Int32",null,u)}for(var l=t.createGroup("results").createGroup("per_selection"),c=0,h=Object.entries((0,p.Z)(this,To).results);c<h.length;c++)for(var f=(0,o.Z)(h[c],2),d=f[0],v=f[1],m=l.createGroup(d),w=0,g=Object.entries(v.raw);w<g.length;w++){var b=(0,o.Z)(g[w],2),y=b[0],Z=b[1];Hs(m.createGroup(y),Z,1,{no_summaries:!0})}}}],[{key:"defaults",value:function(){return{}}},{key:"computeVersusCustom",value:function(e,t,r,n,i,a){var s=arguments.length>6&&void 0!==arguments[6]?arguments[6]:{},o=s.cache,u=void 0===o?{}:o,l=s.block,c=void 0===l?null:l,h=function(e,t){if(!(e in a)||!(t in a))throw new Error("invalid selection ID requested in versus mode");var r=a[e],n=a[t];if(0==r.length||0==n.length)throw new Error("non-zero entries should be present for both requested selections in versus mode");var s=[];r.forEach((function(e,t){s.push({index:t,cluster:0})})),n.forEach((function(e,t){s.push({index:t,cluster:1})})),s.sort((function(e,t){return e.index-t.index}));var o,u,l=s.map((function(e){return e.index})),h=s.map((function(e){return e.cluster})),f=null;if(null!==c){var d=c.array();$s(f=l.map((function(e){return d[e]})))}try{u=b.subsetColumns(i,l),o=b.scoreMarkers(u,h,{block:f})}finally{k(u)}return o};return Ks(e,t,r,n,u,h)}}]),e}();function Po(e){for(var t=0,r=Object.entries((0,p.Z)(this,To).results[e].raw);t<r.length;t++){var n=(0,o.Z)(r[t],2);n[0];n[1].free()}}var Lo=function(){function e(t){(0,c.Z)(this,e),this.results=t}return(0,h.Z)(e,[{key:"effect_grabber",value:function(e,t,r,n){if(1!=t)throw"only group 1 is supported for custom marker mimics";if(1!=r)throw"only the mean effect size is supported for custom marker mimics";return _(this.results[t][e],n)}},{key:"lfc",value:function(e,t){var r=t.summary,n=t.copy;return this.effect_grabber("lfc",e,r,n)}},{key:"deltaDetected",value:function(e,t){var r=t.summary,n=t.copy;return this.effect_grabber("delta_detected",e,r,n)}},{key:"cohen",value:function(e,t){var r=t.summary,n=t.copy;return this.effect_grabber("cohen",e,r,n)}},{key:"auc",value:function(e,t){var r=t.summary,n=t.copy;return this.effect_grabber("auc",e,r,n)}},{key:"stat_grabber",value:function(e,t,r){return _(this.results[t][e],r)}},{key:"means",value:function(e,t){var r=t.copy;return this.stat_grabber("means",e,r)}},{key:"detected",value:function(e,t){var r=t.copy;return this.stat_grabber("detected",e,r)}},{key:"free",value:function(){}}]),e}();function Vo(e,t,r,n){for(var i=e.open("custom_selections"),a={selections:{}},s=i.open("parameters").open("selections"),o=0,u=Object.keys(s.children);o<u.length;o++){for(var l=u[o],c=s.open(l,{load:!0}).values,h=1;h<c.length;h++)if(c[h]<c[h-1]){c.sort();break}a.selections[l]=c}var f={results:{}},d=i.open("results");if("markers"in d.children)for(var v=d.open("markers"),m=0,p=Object.keys(v.children);m<p.length;m++){var w=p[m],g=Ys(v.open(w),t.RNA,{no_summaries:!0});f.results[w]={raw:{RNA:new Lo({1:g})}}}else for(var b=d.open("per_selection"),y=0,Z=Object.keys(b.children);y<Z.length;y++){for(var _=Z[y],k=b.open(_),A={},x=0,E=Object.keys(k.children);x<E.length;x++){var S=E[x],O=Ys(k.open(S),t[S],{no_summaries:!0});A[S]=new Lo({1:O})}f.results[_]={raw:A}}return new qo(r,n,a,f)}function Ho(){var e={feature_selection:{span:.3},combine_embeddings:{weights:null},batch_correction:{method:"none"},tsne:{perplexity:30,iterations:500,animate:!1},umap:{num_neighbors:15,num_epochs:500,min_dist:.1,animate:!1},kmeans_cluster:{k:10},snn_graph_cluster:{k:10,scheme:"rank",resolution:1},choose_clustering:{method:"snn_graph"},cell_labelling:{mouse_references:[],human_references:[]}};return e.inputs=wi.defaults(),e.quality_control=ra.defaults(),e.adt_quality_control=da.defaults(),e.cell_filtering=Ea.defaults(),e.normalization=Wa.defaults(),e.adt_normalization=Va.defaults(),e.pca=ms.defaults(),e.adt_pca=ks.defaults(),e.combine_embeddings=Is.defaults(),e.batch_correction=zs.defaults(),e.neighbor_index=Us.defaults(),e.marker_detection=Do.defaults(),e.custom_selections=qo.defaults(),e}var Yo=[ls,gs];function Jo(e,t){var r,i;if("mnn"==t)r=t,i="weight";else if("regress"==t)r="none",i=t;else{if("none"!=t)throw new Error("unknown correction method '"+t+"'");r=t,i=t}e.batch_correction.method=r;var a,s=(0,n.Z)(Yo);try{for(s.s();!(a=s.n()).done;){e[a.value].block_method=i}}catch(Ke){s.e(Ke)}finally{s.f()}return e}function Ko(e){var t,r=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},n=r.strict,i=void 0!==n&&n,a=new Set(Yo.map((function(t){return e[t].block_method})));return"mnn"==e.batch_correction.method?(t="mnn",i&&(a.size>1||!a.has("weight"))&&(t=null)):t=a.has("regress")?i&&a.size>1?null:"regress":a.has("none")?i&&a.size>1?null:"none":i?null:"none",t}var Xo=[Rs,xs,Ws];function $o(e,t){var r,i=(0,n.Z)(Xo);try{for(i.s();!(r=i.n()).done;){e[r.value].approximate=t}}catch(Ke){i.e(Ke)}finally{i.f()}return e}function eu(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},r=t.strict,n=void 0!==r&&r,i=new Set(Xo.map((function(t){return e[t].approximate})));return n&&i.size>1?null:i.has(!0)}function tu(){return new Worker(new URL(r.p+r.u(484),r.b),{type:void 0})}function ru(){return new Worker(new URL(r.p+r.u(933),r.b),{type:void 0})}function nu(e,t,r){e.postMessage(t,r)}var iu=function(e,t,r){return null};function au(e){var t=iu;return iu=e,t}var su={numberOfThreads:1};function ou(e,t){var r=e.fetchIndex(),n={num_obs:r.numberOfCells()},i=null,a=null,s=null,o=null;try{i=b.findNearestNeighbors(r,t),a=b.createInt32WasmArray(i.numberOfCells()),s=b.createInt32WasmArray(i.size()),o=b.createFloat64WasmArray(i.size()),i.serialize({runs:a,indices:s,distances:o}),n.size=i.size(),n.runs=a.array().slice(),n.indices=s.array().slice(),n.distances=o.array().slice()}finally{null!==i&&i.free(),null!==a&&a.free(),null!==s&&s.free(),null!==o&&o.free()}return n}function uu(e,t,r){var n=arguments.length>3&&void 0!==arguments[3]?arguments[3]:[],i=r.counter,a=new Promise((function(e,t){r.promises[i]={resolve:e,reject:t}}));return r.counter++,t.id=i,nu(e,t,n),a}var lu=[];function cu(e,t,r){var n=lu.length;return lu.push(e),function(e,t){e.onmessage=t}(e,(function(e){var r=e.data.type;if(r.endsWith("_iter"))iu(r.slice(0,-5),e.data.x,e.data.y,e.data.iteration);else{var n=e.data.id,i=t.promises[n];"error"==r?i.reject(e.data.error):i.resolve(e.data.data),delete t.promises[n]}})),{worker_id:n,ready:uu(e,{cmd:"INIT",scranOptions:r},t)}}function hu(e){var t=lu[e];return lu[e]=null,function(e){e.terminate()}(t)}function fu(e,t,r,n){var i={cmd:"RUN",params:t},a=[];return null!==r&&(a=[r.runs.buffer,r.indices.buffer,r.distances.buffer],i.neighbors=r),uu(e,i,n,a)}var du=new WeakMap,vu=new WeakMap,mu=new WeakMap,pu=new WeakMap,wu=new WeakMap,gu=new WeakMap,bu=new WeakMap,yu=new WeakMap,Zu=new WeakSet,_u=new WeakSet,ku=function(){function e(t){var r=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null,n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:null;if((0,c.Z)(this,e),(0,f.Z)(this,_u),(0,f.Z)(this,Zu),(0,d.Z)(this,du,{writable:!0,value:void 0}),(0,d.Z)(this,vu,{writable:!0,value:void 0}),(0,d.Z)(this,mu,{writable:!0,value:void 0}),(0,d.Z)(this,pu,{writable:!0,value:void 0}),(0,d.Z)(this,wu,{writable:!0,value:void 0}),(0,d.Z)(this,gu,{writable:!0,value:void 0}),(0,d.Z)(this,bu,{writable:!0,value:void 0}),(0,d.Z)(this,yu,{writable:!0,value:void 0}),!(t instanceof Us))throw new Error("'index' should be a State object from './neighbor_index.js'");(0,w.Z)(this,du,t),(0,w.Z)(this,vu,null===r?{}:r),(0,w.Z)(this,mu,{counter:0,promises:{}}),(0,w.Z)(this,pu,n),this.changed=!1;var i=tu(),a=cu(i,(0,p.Z)(this,mu),su),s=a.worker_id,o=a.ready;(0,w.Z)(this,wu,i),(0,w.Z)(this,gu,s),(0,w.Z)(this,bu,o),(0,w.Z)(this,yu,null)}return(0,h.Z)(e,[{key:"ready",value:function(){return(0,p.Z)(this,bu)}},{key:"free",value:function(){return hu((0,p.Z)(this,gu))}},{key:"fetchParameters",value:function(){return(0,l.Z)({},(0,p.Z)(this,vu))}},{key:"compute",value:function(e,t,r){var n=!(0,p.Z)(this,du).changed&&e===(0,p.Z)(this,vu).perplexity;return n&&t==(0,p.Z)(this,vu).iterations?(this.changed=!1,new Promise((function(e){return e(null)}))):(null!==(0,p.Z)(this,pu)&&(n=!1,(0,w.Z)(this,pu,null)),(0,v.Z)(this,Zu,Au).call(this,e,t,r,!n),(0,p.Z)(this,vu).perplexity=e,(0,p.Z)(this,vu).iterations=t,(0,p.Z)(this,vu).animate=r,this.changed=!0,(0,p.Z)(this,yu))}},{key:"summary",value:function(){return(0,v.Z)(this,_u,xu).call(this,!0)}},{key:"serialize",value:function(){var e=(0,u.Z)(g.mark((function e(t){var r,n,i,a;return g.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return r=t.createGroup("tsne"),(n=r.createGroup("parameters")).writeDataSet("perplexity","Float64",[],(0,p.Z)(this,vu).perplexity),n.writeDataSet("iterations","Int32",[],(0,p.Z)(this,vu).iterations),n.writeDataSet("animate","Uint8",[],Number((0,p.Z)(this,vu).animate)),e.next=7,(0,v.Z)(this,_u,xu).call(this,!1);case 7:return i=e.sent,(a=r.createGroup("results")).writeDataSet("x","Float64",null,i.x),a.writeDataSet("y","Float64",null,i.y),e.abrupt("return");case 12:case"end":return e.stop()}}),e,this)})));return function(t){return e.apply(this,arguments)}}()},{key:"animate",value:function(){return null!==(0,p.Z)(this,pu)?((0,w.Z)(this,pu,null),(0,v.Z)(this,Zu,Au).call(this,(0,p.Z)(this,vu).perplexity,(0,p.Z)(this,vu).iterations,!0,!0),(0,p.Z)(this,yu).then((function(e){return{type:"tsne_rerun",data:{status:"SUCCESS"}}}))):uu((0,p.Z)(this,wu),{cmd:"RERUN"},(0,p.Z)(this,mu))}}]),e}();function Au(e,t,r,n){var i=null;if(n){var a=b.perplexityToNeighbors(e);i=ou((0,p.Z)(this,du),a)}var s={perplexity:e,iterations:t,animate:r};(0,w.Z)(this,yu,fu((0,p.Z)(this,wu),s,i,(0,p.Z)(this,mu)))}function xu(e){return Eu.apply(this,arguments)}function Eu(){return(Eu=(0,u.Z)(g.mark((function e(t){var r;return g.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(null===(0,p.Z)(this,pu)){e.next=7;break}return r={x:(0,p.Z)(this,pu).x,y:(0,p.Z)(this,pu).y},t&&(r.x=r.x.slice(),r.y=r.y.slice()),r.iterations=(0,p.Z)(this,vu).iterations,e.abrupt("return",r);case 7:return e.next=9,(0,p.Z)(this,yu);case 9:return e.abrupt("return",uu((0,p.Z)(this,wu),{cmd:"FETCH"},(0,p.Z)(this,mu)));case 10:case"end":return e.stop()}}),e,this)})))).apply(this,arguments)}function Su(e,t){var r,n,i=e.open("tsne"),a=i.open("parameters");r={perplexity:a.open("perplexity",{load:!0}).values[0],iterations:a.open("iterations",{load:!0}).values[0],animate:a.open("animate",{load:!0}).values[0]>0};var s=i.open("results");return n={x:s.open("x",{load:!0}).values,y:s.open("y",{load:!0}).values},new ku(t,r,n)}var Ou=new WeakMap,Iu=new WeakMap,Cu=new WeakMap,Ru=new WeakMap,Nu=new WeakMap,Mu=new WeakMap,Fu=new WeakMap,Du=new WeakMap,zu=new WeakSet,Bu=new WeakSet,Wu=function(){function e(t){var r=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null,n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:null;if((0,c.Z)(this,e),(0,f.Z)(this,Bu),(0,f.Z)(this,zu),(0,d.Z)(this,Ou,{writable:!0,value:void 0}),(0,d.Z)(this,Iu,{writable:!0,value:void 0}),(0,d.Z)(this,Cu,{writable:!0,value:void 0}),(0,d.Z)(this,Ru,{writable:!0,value:void 0}),(0,d.Z)(this,Nu,{writable:!0,value:void 0}),(0,d.Z)(this,Mu,{writable:!0,value:void 0}),(0,d.Z)(this,Fu,{writable:!0,value:void 0}),(0,d.Z)(this,Du,{writable:!0,value:void 0}),!(t instanceof Us))throw new Error("'index' should be a State object from './neighbor_index.js'");(0,w.Z)(this,Ou,t),(0,w.Z)(this,Iu,null===r?{}:r),(0,w.Z)(this,Cu,{counter:0,promises:{}}),(0,w.Z)(this,Ru,n),this.changed=!1;var i=ru(),a=cu(i,(0,p.Z)(this,Cu),su),s=a.worker_id,o=a.ready;(0,w.Z)(this,Nu,i),(0,w.Z)(this,Mu,s),(0,w.Z)(this,Fu,o),(0,w.Z)(this,Du,null)}return(0,h.Z)(e,[{key:"ready",value:function(){return(0,p.Z)(this,Fu)}},{key:"free",value:function(){return hu((0,p.Z)(this,Mu))}},{key:"fetchParameters",value:function(){return(0,l.Z)({},(0,p.Z)(this,Iu))}},{key:"compute",value:function(e,t,r,n){var i=!(0,p.Z)(this,Ou).changed&&(0,p.Z)(this,Iu).num_neighbors===e;return i&&t===(0,p.Z)(this,Iu).num_epochs&&r===(0,p.Z)(this,Iu).min_dist?(this.changed=!1,new Promise((function(e){return e(null)}))):(null!==(0,p.Z)(this,Ru)&&(i=!1,(0,w.Z)(this,Ru,null)),(0,v.Z)(this,zu,Gu).call(this,e,t,r,n,!i),(0,p.Z)(this,Iu).num_neighbors=e,(0,p.Z)(this,Iu).num_epochs=t,(0,p.Z)(this,Iu).min_dist=r,(0,p.Z)(this,Iu).animate=n,this.changed=!0,(0,p.Z)(this,Du))}},{key:"summary",value:function(){return(0,v.Z)(this,Bu,ju).call(this,!0)}},{key:"serialize",value:function(){var e=(0,u.Z)(g.mark((function e(t){var r,n,i,a;return g.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return r=t.createGroup("umap"),(n=r.createGroup("parameters")).writeDataSet("num_neighbors","Int32",[],(0,p.Z)(this,Iu).num_neighbors),n.writeDataSet("num_epochs","Int32",[],(0,p.Z)(this,Iu).num_epochs),n.writeDataSet("min_dist","Float64",[],(0,p.Z)(this,Iu).min_dist),n.writeDataSet("animate","Uint8",[],Number((0,p.Z)(this,Iu).animate)),e.next=8,(0,v.Z)(this,Bu,ju).call(this,!1);case 8:return i=e.sent,(a=r.createGroup("results")).writeDataSet("x","Float64",null,i.x),a.writeDataSet("y","Float64",null,i.y),e.abrupt("return");case 13:case"end":return e.stop()}}),e,this)})));return function(t){return e.apply(this,arguments)}}()},{key:"animate",value:function(){return null!==(0,p.Z)(this,Ru)?((0,w.Z)(this,Ru,null),(0,v.Z)(this,zu,Gu).call(this,(0,p.Z)(this,Iu).num_neighbors,(0,p.Z)(this,Iu).num_epochs,(0,p.Z)(this,Iu).min_dist,!0,!0),(0,p.Z)(this,Du).then((function(e){return{type:"umap_rerun",data:{status:"SUCCESS"}}}))):uu((0,p.Z)(this,Nu),{cmd:"RERUN"},(0,p.Z)(this,Cu))}}]),e}();function Gu(e,t,r,n,i){var a=null;i&&(a=ou((0,p.Z)(this,Ou),e));var s={num_neighbors:e,num_epochs:t,min_dist:r,animate:n};(0,w.Z)(this,Du,fu((0,p.Z)(this,Nu),s,a,(0,p.Z)(this,Cu)))}function ju(e){return Tu.apply(this,arguments)}function Tu(){return(Tu=(0,u.Z)(g.mark((function e(t){var r;return g.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(null===(0,p.Z)(this,Ru)){e.next=7;break}return r={x:(0,p.Z)(this,Ru).x,y:(0,p.Z)(this,Ru).y},t&&(r.x=r.x.slice(),r.y=r.y.slice()),r.iterations=(0,p.Z)(this,Iu).num_epochs,e.abrupt("return",r);case 7:return e.next=9,(0,p.Z)(this,Du);case 9:return e.abrupt("return",uu((0,p.Z)(this,Nu),{cmd:"FETCH"},(0,p.Z)(this,Cu)));case 10:case"end":return e.stop()}}),e,this)})))).apply(this,arguments)}function Qu(e,t){var r,n,i=e.open("umap"),a=i.open("parameters");r={num_neighbors:a.open("num_neighbors",{load:!0}).values[0],num_epochs:a.open("num_epochs",{load:!0}).values[0],min_dist:a.open("min_dist",{load:!0}).values[0],animate:a.open("animate",{load:!0}).values[0]>0};var s=i.open("results");return n={x:s.open("x",{load:!0}).values,y:s.open("y",{load:!0}).values},new Wu(t,r,n)}var Uu=function(){var e=(0,u.Z)(g.mark((function e(t){var r;return g.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,fetch(t);case 2:if((r=e.sent).ok){e.next=5;break}throw new Error("failed to fetch content at "+t+"("+r.status+")");case 5:return e.t0=Uint8Array,e.next=8,r.arrayBuffer();case 8:return e.t1=e.sent,e.abrupt("return",new e.t0(e.t1));case 10:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),qu="https://github.com/clusterfork/singlepp-references/releases/download/hs-latest",Pu="https://github.com/clusterfork/singlepp-references/releases/download/mm-latest",Lu={},Vu={},Hu=new WeakMap,Yu=new WeakMap,Ju=new WeakMap,Ku=new WeakMap,Xu=new WeakMap,$u=new WeakMap,el=new WeakSet,tl=function(){function e(t,r){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:null,i=arguments.length>3&&void 0!==arguments[3]?arguments[3]:null;if((0,c.Z)(this,e),(0,f.Z)(this,el),(0,d.Z)(this,Hu,{writable:!0,value:void 0}),(0,d.Z)(this,Yu,{writable:!0,value:void 0}),(0,d.Z)(this,Ju,{writable:!0,value:void 0}),(0,d.Z)(this,Ku,{writable:!0,value:void 0}),(0,d.Z)(this,Xu,{writable:!0,value:void 0}),(0,d.Z)(this,$u,{writable:!0,value:void 0}),!(t instanceof wi))throw new Error("'inputs' should be a State object from './inputs.js'");if((0,w.Z)(this,Hu,t),!(r instanceof Do))throw new Error("'markers' should be a State object from './marker_detection.js'");(0,w.Z)(this,Yu,r),(0,w.Z)(this,Ju,null===n?{}:n),(0,w.Z)(this,Ku,null===i?{}:i),this.changed=!1,(0,w.Z)(this,Xu,{}),(0,w.Z)(this,$u,{})}return(0,h.Z)(e,[{key:"free",value:function(){k((0,p.Z)(this,Ku).buffer);for(var e=0,t=Object.entries((0,p.Z)(this,Xu));e<t.length;e++){var r=(0,o.Z)(t[e],2);r[0];r[1].raw.free()}for(var n=0,i=Object.entries((0,p.Z)(this,$u));n<i.length;n++){var a=(0,o.Z)(i[n],2);a[0];a[1].raw.free()}}},{key:"fetchParameters",value:function(){for(var e=(0,l.Z)({},(0,p.Z)(this,Ju)),t=0,r=["human_references","mouse_references"];t<r.length;t++){var n=r[t];e[n]=e[n].slice()}return e}},{key:"compute",value:function(e,t){var r=this;if(!(0,p.Z)(this,Hu).changed&&!(0,p.Z)(this,Yu).changed&&il(e,(0,p.Z)(this,Ju).human_references)&&il(t,(0,p.Z)(this,Ju).mouse_references))return this.changed=!1,new Promise((function(e){return e(null)}));if((0,p.Z)(this,Hu).changed||!("features"in(0,p.Z)(this,Ku))){var i=function(e){var t,r=e.fetchGenes("RNA"),i=null,a=null,s=(0,n.Z)(r.columnNames());try{for(s.s();!(t=s.n()).done;){var o=t.value,u=r.column(o),l=b.guessFeatures(u);(null===a||l.confidence>a.confidence)&&(i=o,a=l)}}catch(Ke){s.e(Ke)}finally{s.f()}return{details:a,features:null==i?null:r.column(i)}}((0,p.Z)(this,Hu));(0,p.Z)(this,Ku).features=i.features,(0,p.Z)(this,Ku).feature_details=i.details}var a=null!==(0,p.Z)(this,Ku).feature_details?(0,p.Z)(this,Ku).feature_details.species:null;e=e.slice(),t=t.slice();var s={};if("human"==a){var l,c=(0,n.Z)(e);try{for(c.s();!(l=c.n()).done;){var h=l.value;s[h]=(0,v.Z)(this,el,rl).call(this,h,"human",(0,p.Z)(this,Hu).changed)}}catch(Ke){c.e(Ke)}finally{c.f()}}else if("mouse"==a){var f,d=(0,n.Z)(t);try{for(d.s();!(f=d.n()).done;){var m=f.value;s[m]=(0,v.Z)(this,el,rl).call(this,m,"mouse",(0,p.Z)(this,Hu).changed)}}catch(Ke){d.e(Ke)}finally{d.f()}}var w,y,Z=(0,p.Z)(this,Ku).buffer;if(null!==(0,p.Z)(this,Ku).features&&(w=(0,p.Z)(this,Ku).features.length,y=(0,p.Z)(this,Yu).numberOfGroups(),(0,p.Z)(this,Yu).changed||"undefined"===typeof Z)){Z=E(y*w,"Float64Array",(0,p.Z)(this,Ku));for(var _=0;_<y;_++){var k=(0,p.Z)(this,Yu).fetchGroupMeans(_,"RNA",{copy:!1});Z.array().set(k,_*w)}}var A=[];(0,p.Z)(this,Ku).results={};for(var x=0,S=Object.entries(s);x<S.length;x++){var O=(0,o.Z)(S[x],2),I=O[0],C=O[1].then((function(e){var t,r=b.labelCells(Z,e.built.raw,{numberOfFeatures:w,numberOfCells:y}),i=[],a=(0,n.Z)(r);try{for(a.s();!(t=a.n()).done;){var s=t.value;i.push(e.loaded.labels[s])}}catch(Ke){a.e(Ke)}finally{a.f()}return i}));(0,p.Z)(this,Ku).results[I]=C,A.push(C)}var R=Object.keys(s);if(R.length>1){if((0,p.Z)(this,Hu).changed||!il(R,(0,p.Z)(this,Ku).used)||!("integrated"in(0,p.Z)(this,Ku))){var N=Object.values(s);(0,p.Z)(this,Ku).integrated=Promise.all(N).then((function(e){var t=e.map((function(e){return e.loaded.raw})),n=e.map((function(e){return e.built.features})),i=e.map((function(e){return e.built.raw}));return b.integrateLabelledReferences((0,p.Z)(r,Ku).features,t,n,i)}))}var M=(0,p.Z)(this,Ku).integrated.then(function(){var e=(0,u.Z)(g.mark((function e(t){var i,a,s,o,u,l;return g.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:i=[],a=(0,n.Z)(R),e.prev=2,a.s();case 4:if((s=a.n()).done){e.next=13;break}return o=s.value,e.t0=i,e.next=9,(0,p.Z)(r,Ku).results[o];case 9:e.t1=e.sent,e.t0.push.call(e.t0,e.t1);case 11:e.next=4;break;case 13:e.next=18;break;case 15:e.prev=15,e.t2=e.catch(2),a.e(e.t2);case 18:return e.prev=18,a.f(),e.finish(18);case 21:return u=b.integrateCellLabels(Z,i,t,{numberOfFeatures:w,numberOfCells:y}),l=[],u.forEach((function(e){l.push(R[e])})),e.abrupt("return",l);case 25:case"end":return e.stop()}}),e,null,[[2,15,18,21]])})));return function(t){return e.apply(this,arguments)}}());(0,p.Z)(this,Ku).integrated_results=M,A.push(M)}else delete(0,p.Z)(this,Ku).integrated_results;return(0,p.Z)(this,Ku).used=R,(0,p.Z)(this,Ju).human_references=e,(0,p.Z)(this,Ju).mouse_references=t,this.changed=!0,Promise.all(A).then((function(e){return null}))}},{key:"summary",value:function(){var e=(0,u.Z)(g.mark((function e(){var t,r,n,i,a,s,u;return g.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:t={},r=0,n=Object.entries((0,p.Z)(this,Ku).results);case 2:if(!(r<n.length)){e.next=10;break}return i=(0,o.Z)(n[r],2),a=i[0],s=i[1],e.next=6,s;case 6:t[a]=e.sent;case 7:r++,e.next=2;break;case 10:if(u={per_reference:t},!("integrated_results"in(0,p.Z)(this,Ku))){e.next=15;break}return e.next=14,(0,p.Z)(this,Ku).integrated_results;case 14:u.integrated=e.sent;case 15:return e.abrupt("return",u);case 16:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}()},{key:"serialize",value:function(){var e=(0,u.Z)(g.mark((function e(t){var r,n,i,a,s,u,l,c,h,f;return g.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return r=t.createGroup("cell_labelling"),(n=r.createGroup("parameters")).writeDataSet("mouse_references","String",null,(0,p.Z)(this,Ju).mouse_references),n.writeDataSet("human_references","String",null,(0,p.Z)(this,Ju).human_references),i=r.createGroup("results"),e.next=7,this.summary();case 7:for(a=e.sent,s=i.createGroup("per_reference"),u=0,l=Object.entries(a.per_reference);u<l.length;u++)c=(0,o.Z)(l[u],2),h=c[0],f=c[1],s.writeDataSet(h,"String",null,f);return"integrated"in a&&i.writeDataSet("integrated","String",null,a.integrated),e.abrupt("return");case 12:case"end":return e.stop()}}),e,this)})));return function(t){return e.apply(this,arguments)}}()}]),e}();function rl(e,t,r){return nl.apply(this,arguments)}function nl(){return nl=(0,u.Z)(g.mark((function e(t,r,n){var i,a,s,o,l,c,h,f,d,v,m,w,y,Z;return g.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if("human"==r?(i=qu,a=Lu,s=(0,p.Z)(this,Xu)):(i=Pu,a=Vu,s=(0,p.Z)(this,$u)),t in a){e.next=24;break}return o=["genes.csv.gz","labels_fine.csv.gz","label_names_fine.csv.gz","markers_fine.gmt.gz","matrix.csv.gz"],e.next=5,Promise.all(o.map(function(){var e=(0,u.Z)(g.mark((function e(r){var n,a;return g.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n=t+"_"+r,e.next=3,Uu(i+"/"+n);case 3:return a=e.sent,e.abrupt("return",new M(a,{name:n}));case 5:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}()));case 5:return l=e.sent,e.prev=6,c=b.loadLabelledReferenceFromBuffers(l[4].buffer(),l[3].buffer(),l[1].buffer()),e.next=10,Gr(l[0].content(),{compression:"gz"});case 10:return h=e.sent,f=[],d=[],h.forEach((function(e){var t=e.split(",");f.push(t[0]),d.push(t[1])})),e.next=16,Gr(l[2].content(),{compression:"gz"});case 16:v=e.sent,a[t]={raw:c,genes:{ensembl:f,symbol:d},labels:v},e.next=24;break;case 20:throw e.prev=20,e.t0=e.catch(6),k(c),e.t0;case 24:if(t in s&&!n){e.next=38;break}e.prev=25,t in s&&k(s[t].raw),m=a[t],w=m.raw,y="ensembl"===(0,p.Z)(this,Ku).feature_details.type?m.genes.ensembl:m.genes.symbol,Z=b.buildLabelledReference((0,p.Z)(this,Ku).features,w,y),s[t]={features:y,raw:Z},e.next=38;break;case 34:throw e.prev=34,e.t1=e.catch(25),k(undefined),e.t1;case 38:return e.abrupt("return",{loaded:a[t],built:s[t]});case 39:case"end":return e.stop()}}),e,this,[[6,20],[25,34]])}))),nl.apply(this,arguments)}function il(e,t){if("undefined"===typeof e||"undefined"===typeof t)return!1;if(e.length!=t.length)return!1;for(var r=0;r<e.length;r++)if(e[r]!=t[r])return!1;return!0}function al(e,t,r){var n={mouse_references:[],human_references:[]},i={results:{}};if("cell_labelling"in e.children){var a=e.open("cell_labelling"),s=a.open("parameters");n.mouse_references=s.open("mouse_references",{load:!0}).values,n.human_references=s.open("human_references",{load:!0}).values;for(var o=a.open("results"),u=o.open("per_reference"),l=0,c=Object.keys(u.children);l<c.length;l++){var h=c[l];i.results[h]=u.open(h,{load:!0}).values}"integrated"in o.children&&(i.integrated_results=o.open("integrated",{load:!0}).values)}return new tl(t,r,n,i)}function sl(e){var t=Uu;return Uu=e,t}var ol=ci,ul=Ji,ll=oa,cl=ga,hl=Na,fl=Ta,dl="feature_selection",vl=ls,ml=gs,pl="combine_embeddings",wl="batch_correction",gl=Ws,bl="tsne",yl="umap",Zl="kmeans_cluster",_l="snn_graph_cluster",kl="choose_clustering",Al=Io,xl="cell_labelling",El=Wo;function Sl(){return Ol.apply(this,arguments)}function Ol(){return(Ol=(0,u.Z)(g.mark((function e(){return g.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",Il(new wi));case 1:case"end":return e.stop()}}),e)})))).apply(this,arguments)}function Il(e){var t={};t.inputs=e,t[ul]=new ra(t.inputs),t[ll]=new da(t.inputs),t[cl]=new Ea(t.inputs,{RNA:t[ul],ADT:t[ll]}),t[hl]=new Wa(t[ul],t[cl]),t[fl]=new Va(t[ll],t[cl]),t[dl]=new as(t[cl],t[hl]),t.pca=new ms(t[cl],t[hl],t[dl]),t.adt_pca=new ks(t[cl],t[fl]),t[pl]=new Is({RNA:t.pca,ADT:t.adt_pca}),t[wl]=new zs(t[cl],t[pl]),t.neighbor_index=new Us(t[wl]),t.tsne=new ku(t.neighbor_index),t.umap=new Wu(t.neighbor_index),t[Zl]=new bo(t[wl]),t[_l]=new oo(t.neighbor_index),t[kl]=new So(t[_l],t[Zl]);var r={RNA:t[hl],ADT:t[fl]};return t[Al]=new Do(t[cl],r,t[kl]),t[xl]=new tl(t.inputs,t[Al]),t[El]=new qo(t[cl],r),Promise.all([t.tsne.ready(),t.umap.ready()]).then((function(e){return t}))}function Cl(e){for(var t=[],r=0,n=Object.entries(e);r<n.length;r++){var i=(0,o.Z)(n[r],2),a=(i[0],i[1].free());a&&t.push(a)}return Promise.all(t).then((function(e){return null}))}function Rl(e,t,r){return Nl.apply(this,arguments)}function Nl(){return Nl=(0,u.Z)(g.mark((function e(t,r,n){var i,a,s,o,u,l,c,h,f,d,v,m,p,w=arguments;return g.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return i=w.length>3&&void 0!==w[3]?w[3]:{},a=i.startFun,s=void 0===a?null:a,o=i.finishFun,u=void 0===o?null:o,c=function(e){null!==u&&(t[e].changed?u(e,t[e].summary()):u(e))},h=[],f=function(e,r){null!==u&&(r=t[e].changed?t[e].summary().then((function(t){return u(e,t)})):r.then((function(t){return u(e)}))),h.push(r)},(l=function(e){null!==s&&s(e)})(ol),e.next=8,t.inputs.compute(r,n.inputs.sample_factor,n.inputs.subset);case 8:return c(ol),l(ul),t[ul].compute(n[ul].skip,n[ul].use_mito_default,n[ul].mito_prefix,n[ul].nmads),c(ul),l(ll),t[ll].compute(n[ll].skip,n[ll].igg_prefix,n[ll].nmads,n[ll].min_detected_drop),c(ll),l(cl),t[cl].compute(),c(cl),l(hl),t[hl].compute(),c(hl),l(fl),t[fl].compute(n[fl].num_pcs,n[fl].num_clusters),c(fl),l(dl),t[dl].compute(n[dl].span),c(dl),l(vl),t.pca.compute(n.pca.num_hvgs,n.pca.num_pcs,n.pca.block_method),c(vl),l(ml),t.adt_pca.compute(n.adt_pca.num_pcs,n.adt_pca.block_method),c(ml),l(pl),t[pl].compute(n[pl].weights,n[pl].approximate),c(pl),l(wl),t[wl].compute(n[wl].method,n[wl].num_neighbors,n[wl].approximate),c(wl),l(gl),t.neighbor_index.compute(n.neighbor_index.approximate),c(gl),l(bl),d=t.tsne.compute(n.tsne.perplexity,n.tsne.iterations,n.tsne.animate),f(bl,d),l(yl),v=t.umap.compute(n.umap.num_neighbors,n.umap.num_epochs,n.umap.min_dist,n.umap.animate),f(yl,v),m=n[kl].method,l(Zl),t[Zl].compute("kmeans"==m,n[Zl].k),c(Zl),l(_l),t[_l].compute("snn_graph"==m,n[_l].k,n[_l].scheme,n[_l].resolution),c(_l),l(kl),t[kl].compute(m),c(kl),l(Al),t[Al].compute(),c(Al),l(xl),p=t[xl].compute(n[xl].human_references,n[xl].mouse_references),f(xl,p),t[El].compute(),c(El),e.next=68,Promise.all(h);case 68:return e.abrupt("return",null);case 69:case"end":return e.stop()}}),e)}))),Nl.apply(this,arguments)}function Ml(e,t){return Fl.apply(this,arguments)}function Fl(){return Fl=(0,u.Z)(g.mark((function e(t,r){var n,i,a,s,o,u=arguments;return g.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n=u.length>2&&void 0!==u[2]?u[2]:{},i=n.embedded,a=null,s=null,(void 0===i||i)&&(s={collected:[],total:0},a=function(e,t){s.collected.push(e);var r=s.total;return s.total+=t,{offset:r,size:t}}),o=b.createNewHDF5File(r),e.next=7,t.inputs.serialize(o,a);case 7:return t[ul].serialize(o),t[ll].serialize(o),t[cl].serialize(o),t[hl].serialize(o),t[fl].serialize(o),t[dl].serialize(o),t.pca.serialize(o),t.adt_pca.serialize(o),t[pl].serialize(o),t[wl].serialize(o),t.neighbor_index.serialize(o),e.next=20,t.tsne.serialize(o);case 20:return e.next=22,t.umap.serialize(o);case 22:return t[Zl].serialize(o),t[_l].serialize(o),t[kl].serialize(o),t[Al].serialize(o),e.next=28,t[xl].serialize(o);case 28:return t[El].serialize(o),e.abrupt("return",s);case 30:case"end":return e.stop()}}),e)}))),Fl.apply(this,arguments)}function Dl(e,t){return zl.apply(this,arguments)}function zl(){return zl=(0,u.Z)(g.mark((function e(t,r){var n,i,a,s,o,u,l,c,h,f=arguments;return g.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n=f.length>2&&void 0!==f[2]?f[2]:{},i=n.finishFun,a=void 0===i?null:i,s={},o=new b.H5File(t),u=function(e){null!==a&&a(e,s[e].summary())},e.next=6,Bi(o,r);case 6:if(c=e.sent,s.inputs=c.state,l=c.permuters,u(ol),s[ul]=sa(o,s.inputs),u(ul),s[ll]=wa(o,s.inputs),u(ll),s[cl]=Ia(o,s.inputs,{RNA:s[ul],ADT:s[ll]}),u(cl),s[hl]=ja(0,s[ul],s[cl]),u(hl),s[fl]=Ya(o,s[ll],s[cl]),u(fl),s[dl]=us(o,l.RNA,s[cl],s[hl]),u(dl),s.pca=ws(o,s[cl],s[hl],s[dl]),u(vl),s.adt_pca=As(o,s[cl],s[fl]),u(ml),s[pl]=Cs(o,{RNA:s.pca,ADT:s.adt_pca}),u(pl),s[wl]=Bs(o,s[cl],s[pl]),u(wl),s.neighbor_index=Ps(o,s[wl]),u(gl),s.tsne=Su(o,s.neighbor_index),null===a){e.next=40;break}return e.t0=a,e.t1=bl,e.next=38,s.tsne.summary();case 38:e.t2=e.sent,(0,e.t0)(e.t1,e.t2);case 40:if(s.umap=Qu(o,s.neighbor_index),null===a){e.next=48;break}return e.t3=a,e.t4=yl,e.next=46,s.umap.summary();case 46:e.t5=e.sent,(0,e.t3)(e.t4,e.t5);case 48:if(s[Zl]=_o(o,s[wl]),u(Zl),s[_l]=vo(o,s.neighbor_index),u(_l),s[kl]=Oo(o,s[_l],s[Zl]),u(kl),h={RNA:s[hl],ADT:s[fl]},s[Al]=Bo(o,l,s[cl],h,s[kl]),u(Al),s[xl]=al(o,s.inputs,s[Al]),null===a){e.next=65;break}return e.t6=a,e.t7=xl,e.next=63,s[xl].summary();case 63:e.t8=e.sent,(0,e.t6)(e.t7,e.t8);case 65:return s[El]=Vo(o,l,s[cl],h),u(El),e.abrupt("return",s);case 68:case"end":return e.stop()}}),e)}))),zl.apply(this,arguments)}function Bl(e){for(var t={},r=0,n=Object.entries(e);r<n.length;r++){var i=(0,o.Z)(n[r],2),a=i[0],s=i[1];t[a]=s.fetchParameters()}return t}function Wl(e){if(Array.isArray(e))for(var t=0;t<e.length;t++)e[t]=Wl(e[t]);else if(e instanceof Object)if("_TypedArray_class"in e){var r=e[["_TypedArray_class"]],n=e[["_TypedArray_values"]];switch(r){case"Uint8Array":case"Uint8Array":e=new Uint8Array(n.length);break;case"Int8Array":e=new Int8Array(n.length);break;case"Uint16Array":e=new Uint16Array(n.length);break;case"Int16Array":e=new Int16Array(n.length);break;case"Uint32Array":e=new Uint32Array(n.length);break;case"Int32Array":e=new Int32Array(n.length);break;case"Uint64Array":e=new Uint64Array(n.length);break;case"Int64Array":e=new Int64Array(n.length);break;case"Float32Array":e=new Float32Array(n.length);break;case"Float64Array":e=new Float64Array(n.length);break;default:throw"unrecognized TypedArray class '"+r}e.set(n)}else for(var i=0,a=Object.entries(e);i<a.length;i++){var s=(0,o.Z)(a[i],2),u=s[0],l=s[1];e[u]=Wl(l)}return e}var Gl=2001e3;function jl(e){for(var t=new Uint8Array(8),r=0;e>0;)t[r]=e%256,e=Math.floor(e/256),r++;return t}function Tl(e){var t,r=0,i=1,a=(0,n.Z)(e);try{for(a.s();!(t=a.n()).done;){r+=i*t.value,i*=256}}catch(Ke){a.e(Ke)}finally{a.f()}return r}function Ql(e,t){var r=function(e){var t=0,r=Tl(e.subarray(t,t+8));t+=8;var n=Tl(e.subarray(t,t+8));return t+=8,{embedded:0==r,version:n,state:Tl(e.subarray(t,t+8)),offset:t+=8}}(e),i=r.offset+r.state,a=e.subarray(r.offset,r.offset+i);if(r.version<1e6){var s=Cr(a,{to:"string"});!function(e,t){var r=b.createNewHDF5File(t),i=r.createGroup("inputs"),a=e.inputs.parameters,s=i.createGroup("parameters");s.writeDataSet("format","String",[],a.type);var u,l=s.createGroup("files"),c=(0,n.Z)(a.files.entries());try{for(c.s();!(u=c.n()).done;){var h=(0,o.Z)(u.value,2),f=h[0],d=h[1],v=l.createGroup(String(f));v.writeDataSet("type","String",[],d.type),v.writeDataSet("name","String",[],d.name),d.buffer instanceof Object?(v.writeDataSet("offset","Uint32",[],d.buffer.offset),v.writeDataSet("size","Uint32",[],d.buffer.size)):v.writeDataSet("id","String",[],d.buffer)}}catch(Ke){c.e(Ke)}finally{c.f()}var m=i.createGroup("results"),p=e.inputs.contents,w=Object.values(p.genes)[0].length;m.writeDataSet("dimensions","Int32",null,[w,p.num_cells]);for(var g=m.createGroup("genes"),y=0,Z=Object.entries(p.genes);y<Z.length;y++){var _=(0,o.Z)(Z[y],2),k=_[0],A=_[1];g.writeDataSet(k,"String",null,A)}var x=r.createGroup("quality_control"),E=x.createGroup("parameters"),S=e.quality_control_metrics.parameters;E.writeDataSet("use_mito_default","Uint8",[],Number(S.use_mito_default)),E.writeDataSet("mito_prefix","String",[],S.mito_prefix);var O=e.quality_control_thresholds.parameters;E.writeDataSet("nmads","Float64",[],O.nmads);var I=x.createGroup("results"),C=I.createGroup("metrics"),R=Wl(e.quality_control_metrics.contents);C.writeDataSet("sums","Float64",null,R.sums),C.writeDataSet("detected","Int32",null,R.detected),C.writeDataSet("proportion","Float64",null,R.proportion);for(var N=I.createGroup("thresholds"),M=Wl(e.quality_control_thresholds.contents),F=0,D=["sums","detected","proportion"];F<D.length;F++){var z=D[F];N.writeDataSet(z,"Float64",null,[M[z]])}var B=M.discards;I.writeDataSet("discards","Uint8",null,B);var W=r.createGroup("normalization");W.createGroup("parameters"),W.createGroup("results");var G=r.createGroup("feature_selection");G.createGroup("parameters").writeDataSet("span","Float64",[],e.feature_selection.parameters.span);for(var j=G.createGroup("results"),T=Wl(e.feature_selection.contents),Q=0,U=["means","vars","fitted","resids"];Q<U.length;Q++){var q=U[Q];j.writeDataSet(q,"Float64",null,T[q])}for(var P=r.createGroup("pca"),L=P.createGroup("parameters"),V=e.pca.parameters,H=0,Y=["num_hvgs","num_pcs"];H<Y.length;H++){var J=Y[H];L.writeDataSet(J,"Int32",null,V[J])}var K=P.createGroup("results"),X=Wl(e.pca.contents),$=X.var_exp;K.writeDataSet("var_exp","Float64",null,$);var ee=$.length,te=X.pcs.length/ee;K.writeDataSet("pcs","Float64",[te,ee],X.pcs);var re=r.createGroup("neighbor_index"),ne=re.createGroup("parameters"),ie=e.pca.parameters;ne.writeDataSet("approximate","Uint8",[],Number(ie.approximate)),re.createGroup("results");var ae=r.createGroup("tsne"),se=ae.createGroup("parameters"),oe=e.tsne.parameters;se.writeDataSet("perplexity","Float64",[],oe.perplexity),se.writeDataSet("iterations","Int32",[],oe.iterations),se.writeDataSet("animate","Uint8",[],oe.animate);var ue=ae.createGroup("results"),le=Wl(e.tsne.contents);ue.writeDataSet("x","Float64",null,le.x),ue.writeDataSet("y","Float64",null,le.y);var ce=r.createGroup("umap"),he=ce.createGroup("parameters"),fe=e.umap.parameters;he.writeDataSet("num_neighbors","Int32",[],fe.num_neighbors),he.writeDataSet("num_epochs","Int32",[],fe.num_epochs),he.writeDataSet("min_dist","Float64",[],fe.min_dist),he.writeDataSet("animate","Uint8",[],Number(fe.animate));var de=ce.createGroup("results"),ve=Wl(e.umap.contents);de.writeDataSet("x","Float64",null,ve.x),de.writeDataSet("y","Float64",null,ve.y);var me=r.createGroup("kmeans_cluster"),pe=me.createGroup("parameters").createDataSet("k","Int32",[]);if("kmeans_cluster"in e){var we=e.kmeans_cluster.parameters;pe.write(we.k)}else pe.write(10);var ge=me.createGroup("results"),be=Wl(e.kmeans_cluster.contents);"kmeans_cluster"in e&&ge.writeDataSet("clusters","Int32",null,be.clusters);var ye=r.createGroup("snn_graph_cluster"),Ze=ye.createGroup("parameters"),_e=e.snn_find_neighbors.parameters;Ze.writeDataSet("k","Int32",[],_e.k);var ke=e.snn_build_graph.parameters;Ze.writeDataSet("scheme","String",[],["rank","number","jaccard"][ke.scheme]);var Ae=e.snn_cluster_graph.parameters;Ze.writeDataSet("resolution","Float64",[],Ae.resolution);var xe=ye.createGroup("results"),Ee=Wl(e.snn_cluster_graph.contents);xe.writeDataSet("clusters","Int32",null,Ee.clusters),r.createGroup("choose_clustering").createGroup("parameters").writeDataSet("method","String",[],e.choose_clustering.parameters.method);var Se=r.createGroup("marker_detection");Se.createGroup("parameters");var Oe,Ie=Se.createGroup("results").createGroup("clusters"),Ce=e.marker_detection.contents,Re=(0,n.Z)(Ce.entries());try{for(Re.s();!(Oe=Re.n()).done;){for(var Ne=(0,o.Z)(Oe.value,2),Me=Ne[0],Fe=Ne[1],De=Ie.createGroup(String(Me)),ze=Wl(Fe),Be=0,We=["means","detected"];Be<We.length;Be++){var Ge=We[Be];De.writeDataSet(Ge,"Float64",null,ze[Ge])}for(var je=0,Te=["lfc","delta_detected","auc","cohen"];je<Te.length;je++)for(var Qe=Te[je],Ue=ze[Qe],qe=De.createGroup(Qe),Pe=0,Le=["min","mean","min-rank"];Pe<Le.length;Pe++){var Ve=Le[Pe],He="min-rank"==Ve?"min_rank":Ve;qe.writeDataSet(He,"Float64",null,Ue[Ve])}}}catch(Ke){Re.e(Ke)}finally{Re.f()}for(var Ye=r.createGroup("custom_selections"),Je=Ye.createGroup("parameters").createGroup("selections"),Xe=e.custom_marker_management.parameters,$e=0,et=Object.entries(Xe.selections);$e<et.length;$e++){var tt=(0,o.Z)(et[$e],2),rt=tt[0],nt=tt[1];Je.writeDataSet(String(rt),"Int32",null,nt)}for(var it=Ye.createGroup("results").createGroup("markers"),at=0,st=Object.entries(e.custom_marker_management.contents.results);at<st.length;at++){for(var ot=(0,o.Z)(st[at],2),ut=ot[0],lt=ot[1],ct=it.createGroup(String(ut)),ht=Wl(lt),ft=0,dt=["means","detected"];ft<dt.length;ft++){var vt=dt[ft];ct.writeDataSet(vt,"Float64",null,ht[vt])}for(var mt=0,pt=["lfc","delta_detected","auc","cohen"];mt<pt.length;mt++){var wt=pt[mt];ct.writeDataSet(wt,"Float64",null,ht[wt].mean)}}}(JSON.parse(s),t)}else b.writeFile(t,a);return r.embedded?function(t,r){return e.slice(i+t,i+t+r)}:null}function Ul(e,t){var r=null!==t,i=b.readFile(e),a=function(e,t){var r=new Uint8Array(24),n=0,i=jl(e?0:1);r.set(i,n),n+=i.length;var a=jl(Gl);r.set(a,n),n+=a.length;var s=jl(t);if(r.set(s,n),24!=(n+=s.length))throw"oops - accounting error in the serialization code!";return r}(r,i.byteLength),s=a.length+i.length;if(r){var o,u=(0,n.Z)(t);try{for(u.s();!(o=u.n()).done;){s+=o.value.byteLength}}catch(Ke){u.e(Ke)}finally{u.f()}}var l=new Uint8Array(s);l.set(a);var c=a.length;if(l.set(i,c),c+=i.length,r){var h,f=(0,n.Z)(t);try{for(f.s();!(h=f.n()).done;){var d=h.value;l.set(d,c),c+=d.length}}catch(Ke){f.e(Ke)}finally{f.f()}}return l}function ql(e,t){return Ql(e,t)}function Pl(e,t){return Ul(e,t)}function Ll(e,t){return ql(e,t)}function Vl(e){return Hl.apply(this,arguments)}function Hl(){return Hl=(0,u.Z)(g.mark((function e(t){var r,n,i,a,s,u,l,c,h,f,d,v,m,p,w,b,y,Z,_,k,A,x,E,S,O,I,C,R,N,M,F,D,z,B,W=arguments;return g.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:for(r=W.length>1&&void 0!==W[1]?W[1]:{},n=r.cache,i=void 0!==n&&n,a=Object.keys(t),s=a.length>1,u=[],l=0,c=a;l<c.length;l++)h=c[l],u.push(t[h].annotations({cache:i}));return e.next=7,Promise.all(u);case 7:for(f=e.sent,d={},v=0,m=Object.entries(a);v<m.length;v++)p=(0,o.Z)(m[v],2),w=p[0],b=p[1],d[b]=f[w].cells.summary;if(y=_i(f),0!=Object.keys(y).length){e.next=13;break}throw new Error("failed to find any common modalities");case 13:Z={},_=0,k=Object.entries(y);case 15:if(!(_<k.length)){e.next=36;break}for(A=(0,o.Z)(k[_],2),x=A[0],E=A[1],Z[x]={fields:{}},S=[],O=0;O<f.length;O++)S.push(f[O].features[E[O]]);if(I=yi(S),!s){e.next=30;break}if(null!==I.best_type){e.next=24;break}throw new Error("cannot find common feature types across all datasets");case 24:for(O=0;O<f.length;O++)Z[x].fields[a[O]]=I.best_fields[O];for(C=null,R=0,N=Object.entries(I.best_fields);R<N.length;R++)M=(0,o.Z)(N[R],2),F=M[0],D=M[1],z=S[F].column(D),null===C?C=z:function(){var e=new Set(z);C=C.filter((function(t){return e.has(t)}))}();Z[x].common=C.length,e.next=33;break;case 30:B=S[0].columnNames(),Z[x].fields[a[0]]=B.length?B[0]:"",Z[x].common=S[0].numberOfRows();case 33:_++,e.next=15;break;case 36:return e.abrupt("return",{annotations:d,features:Z});case 37:case"end":return e.stop()}}),e)}))),Hl.apply(this,arguments)}function Yl(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t=e.numberOfThreads,r=void 0===t?1:t,n=e.localFile,i=void 0!==n&&n,a=b.initialize({numberOfThreads:r,localFile:i});return su.localFile=i,a.then((function(e){return null}))}function Jl(e){return e(b)}},7806:function(e,t,r){"use strict";r.d(t,{G9:function(){return u},Nd:function(){return l},NR:function(){return c},bl:function(){return h},Tm:function(){return f}});var n=r(1413),i=r(3324),a=r(7762),s=r(3637),o=r(8497);function u(e){if("_bioconductor_LENGTH"in e)return e._bioconductor_LENGTH();if(!s.zG(e))throw new Error("no method for 'LENGTH' in '"+e.constructor.name+"' instance");return e.length}function l(e,t){var r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{},n=r.allowInPlace,i=void 0!==n&&n,a=r.allowView,o=void 0!==a&&a;if("_bioconductor_SLICE"in e)return e._bioconductor_SLICE(t,{allowInPlace:i,allowView:o});if(!s.zG(e))throw new Error("no method for 'SLICE' in '"+e.constructor.name+"' instance");if(t.constructor==Object)return o&&ArrayBuffer.isView(e)?e.subarray(t.start,t.end):e.slice(t.start,t.end);var u=new e.constructor(t.length);return t.forEach((function(t,r){u[r]=e[t]})),u}function c(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},r=t.allowAppend,n=void 0!==r&&r,i=e[0];if("_bioconductor_COMBINE"in i)return i._bioconductor_COMBINE(e,{allowAppend:n});if(!s.zG(i))throw new Error("no method for 'COMBINE' in '"+i.constructor.name+"' instance");var o,u=0,l=i.constructor,c=(0,a.Z)(e);try{for(c.s();!(o=c.n()).done;){var h=o.value;u+=h.length,l=s.BQ(l,h.constructor)}}catch(w){c.e(w)}finally{c.f()}var f,d=new l(u),v=0,m=(0,a.Z)(e);try{for(m.s();!(f=m.n()).done;){var p=f.value;"set"in d?(d.set(p,v),v+=p.length):p.forEach((function(e){d[v]=e,v++}))}}catch(w){m.e(w)}finally{m.f()}return d}function h(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},r=t.deepCopy,a=void 0===r||r;if(e instanceof Object){var o={deepCopy:a};if("_bioconductor_CLONE"in e)return e._bioconductor_CLONE(o);if(s.zG(e))return e.constructor==Array?e.map((function(e){return h(e,o)})):a?e.slice():e.subarray();if(e.constructor==Object){if(a){for(var u={},l=0,c=Object.entries(e);l<c.length;l++){var f=(0,i.Z)(c[l],2),d=f[0],v=f[1];u[d]=h(v)}return u}return(0,n.Z)({},e)}}return e}function f(e,t){if(t.constructor!=Object&&(t=o.L(t)),"_bioconductor_SPLIT"in e)return e._bioconductor_SPLIT(t);for(var r={},n=0,a=Object.entries(t);n<a.length;n++){var s=(0,i.Z)(a[n],2),u=s[0],c=s[1];r[u]=l(e,c)}return r}},815:function(e,t,r){"use strict";r.d(t,{N:function(){return l},s:function(){return c}});var n=r(3324),i=r(7762),a=r(5671),s=r(3144),o=r(7806),u=r(3637),l=function(){function e(t){var r=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},n=r.numberOfRows,i=void 0===n?null:n,s=r.rowNames,l=void 0===s?null:s,c=r.columnOrder,h=void 0===c?null:c,f=r.metadata,d=void 0===f?{}:f;(0,a.Z)(this,e),this._numberOfRows=i,this._rowNames=l,this._columns=t,this._columnOrder=h,this._metadata=d;var v=Object.values(t);if(v.length)for(var m=0;m<v.length;m++){var p=o.G9(v[m]);if(null==this._numberOfRows)this._numberOfRows=p;else if(p!=this._numberOfRows)throw new Error("expected all arrays in 'x' to have equal length")}if(null==h)this._columnOrder=Object.keys(t);else{if(h.length!=v.length)throw new Error("'columnOrder' should have the same length as 'x'");e._check_names(h,"column names");var w=Array.from(new Set(h));w.sort();var g=Object.keys(t);if(g.sort(),!u.Hj(w,g))throw new Error("values of 'columnOrder' should be the same as the keys of 'x'")}if(null!=l){if(null==this._numberOfRows)this._numberOfRows=l.length;else if(this._numberOfRows!=l.length)throw new Error("length of 'rowNames' is inconsistent with the number of rows of 'x'");e._check_names(l,"row names")}null==this._numberOfRows&&(this._numberOfRows=0)}return(0,s.Z)(e,[{key:"_check_index",value:function(e){if(e<0||e>=this._columnOrder.length)throw new Error("column index '"+String(e)+"' out of range for this DataFrame")}},{key:"rowNames",value:function(){return this._rowNames}},{key:"columnNames",value:function(){return this._columnOrder}},{key:"hasColumn",value:function(e){return e in this._columns}},{key:"numberOfRows",value:function(){return this._numberOfRows}},{key:"numberOfColumns",value:function(){return this._columnOrder.length}},{key:"column",value:function(e){if("string"==typeof e){if(!(e in this._columns))throw new Error("no column '"+e+"' present in this DataFrame");return this._columns[e]}return this._check_index(e),this._columns[this._columnOrder[e]]}},{key:"metadata",value:function(){return this._metadata}},{key:"$removeColumn",value:function(e){if("string"==typeof e){var t=this._columnOrder.indexOf(e);if(t<0)throw new Error("no column '"+e+"' in this DataFrame");this._columnOrder.splice(t,1),delete this._columns[e]}else{this._check_index(e);var r=this._columnOrder[e];this._columnOrder.splice(e,1),delete this._columns[r]}return this}},{key:"$setColumn",value:function(e,t){if(o.G9(t)!=this._numberOfRows)throw new Error("expected 'value' to have the same length as the number of rows in 'x'");return"string"==typeof e?(e in this._columns||this._columnOrder.push(e),this._columns[e]=t):(this._check_index(e),this._columns[this._columnOrder[e]]=t),this}},{key:"$setColumnNames",value:function(t){if(e._check_names(t,"column names"),t.length!=this._columnOrder.length)throw new Error("length of replacement 'names' must be equal to the number of columns");for(var r={},n=0;n<t.length;n++){if(t[n]in r)throw new Error("detected duplicates in replacement 'names'");r[t[n]]=this._columns[this._columnOrder[n]]}return this._columns=r,this._columnOrder=t,this}},{key:"$setRowNames",value:function(t){if(null!=t){if(t.length!=this._numberOfRows)throw new Error("length of replacement 'names' must be equal to the number of rows");e._check_names(t,"row names")}return this._rowNames=t,this}},{key:"$sliceColumns",value:function(e){var t,r={},n=[],a=(0,i.Z)(e);try{for(a.s();!(t=a.n()).done;){var s=t.value;if("string"!=typeof s&&(this._check_index(s),s=this._columnOrder[s]),s in r)throw new Error("duplicate columns detected in slice request");r[s]=this._columns[s],n.push(s)}}catch(o){a.e(o)}finally{a.f()}return this._columns=r,this._columnOrder=n,this}},{key:"$setMetadata",value:function(e){return this._metadata=e,this}},{key:"_bioconductor_LENGTH",value:function(){return this.numberOfRows()}},{key:"_bioconductor_SLICE",value:function(e,t){for(var r=t.allowInPlace,i=void 0!==r&&r,a=t.allowView,s={allowInPlace:i,allowView:void 0!==a&&a},u={},l=0,c=Object.entries(this._columns);l<c.length;l++){var h=(0,n.Z)(c[l],2),f=h[0],d=h[1];u[f]=o.Nd(d,e,s)}var v,m=null==this._rowNames?null:o.Nd(this._rowNames,e,s);if(v=e.constructor==Object?e.end-e.start:e.length,i)return this._columns=u,this._rowNames=m,this._numberOfRows=v,this;var p=Object.create(this.constructor.prototype);return p._columns=u,p._rowNames=m,p._columnOrder=this._columnOrder,p._numberOfRows=v,p._metadata=this._metadata,p}},{key:"_bioconductor_COMBINE",value:function(e,t){var r,n=t.allowAppend,a=void 0!==n&&n,s={allowAppend:a},u={},l=(0,i.Z)(this._columnOrder);try{for(l.s();!(r=l.n()).done;){var c,h=r.value,f=[],d=(0,i.Z)(e);try{for(d.s();!(c=d.n()).done;){var v=c.value;if(!(h in v._columns))throw new Error("missing column '"+h+"' across DataFrames to be combined");f.push(v._columns[h])}}catch(_){d.e(_)}finally{d.f()}u[h]=o.NR(f,s)}}catch(_){l.e(_)}finally{l.f()}var m,p=0,w=!1,g=(0,i.Z)(e);try{for(g.s();!(m=g.n()).done;){var b=m.value;if(b.numberOfColumns()!=this.numberOfColumns())throw new Error("mismatching number of columns across DataFrames to be combined");w||null===b._rowNames||(w=!0),p+=b._numberOfRows}}catch(_){g.e(_)}finally{g.f()}var y=null;if(w&&function(){y=new Array(p);var t,r=0,n=(0,i.Z)(e);try{for(n.s();!(t=n.n()).done;){var a=t.value;null==a._rowNames?(y.fill("",r,r+a._numberOfRows),r+=a._numberOfRows):a._rowNames.forEach((function(e){y[r]=e,r++}))}}catch(_){n.e(_)}finally{n.f()}}(),a)return this._columns=u,this._numberOfRows=p,this._rowNames=y,this;var Z=Object.create(this.constructor.prototype);return Z._columns=u,Z._rowNames=y,Z._columnOrder=this._columnOrder,Z._numberOfRows=p,Z._metadata=this._metadata,Z}},{key:"_bioconductor_CLONE",value:function(e){var t=e.deepCopy,r=void 0===t||t,n=this._columnOrder.slice(),i=null==this._rowNames?null:this._rowNames.slice(),a=o.bl(this._columns,{deepCopy:r}),s=o.bl(this._metadata,{deepCopy:r}),u=Object.create(this.constructor.prototype);return u._columns=a,u._rowNames=i,u._columnOrder=n,u._numberOfRows=this._numberOfRows,u._metadata=s,u}}],[{key:"_check_names",value:function(e,t){var r,n=(0,i.Z)(e);try{for(n.s();!(r=n.n()).done;){if("string"!==typeof r.value)throw new Error("array of "+t+" should only contain strings")}}catch(a){n.e(a)}finally{n.f()}}}]),e}();function c(e){var t,r=new Set,n=[],a=(0,i.Z)(e);try{for(a.s();!(t=a.n()).done;){var s,u=t.value.columnNames(),l=(0,i.Z)(u);try{for(l.s();!(s=l.n()).done;){var c=s.value;r.has(c)||(r.add(c),n.push(c))}}catch(y){l.e(y)}finally{l.f()}}}catch(y){a.e(y)}finally{a.f()}var h,f=[],d=(0,i.Z)(e);try{for(d.s();!(h=d.n()).done;){var v=h.value,m=new Array(v.numberOfRows());m.fill(null);var p,w=o.bl(v,{deepCopy:!1}),g=(0,i.Z)(n);try{for(g.s();!(p=g.n()).done;){var b=p.value;v.hasColumn(b)||w.$setColumn(b,m)}}catch(y){g.e(y)}finally{g.f()}f.push(w)}}catch(y){d.e(y)}finally{d.f()}return o.NR(f)}},8497:function(e,t,r){"use strict";function n(e){var t={};return e.forEach((function(e,r){e in t||(t[e]=[]),t[e].push(r)})),t}r.d(t,{L:function(){return n}})},3637:function(e,t,r){"use strict";function n(e,t){if(e.length!==t.length)return!1;for(var r=0;r<e.length;r++)if(e[r]!=t[r])return!1;return!0}function i(e){return e.constructor==Array||ArrayBuffer.isView(e)}function a(e,t){return e==t?e:e==Array||t==Array||e==BigInt64Array||t==BigInt64Array||e==BigUint64Array||t==BigUint64Array?Array:Float64Array}r.d(t,{Hj:function(){return n},zG:function(){return i},BQ:function(){return a}})},4021:function(e,t,r){"use strict";r.d(t,{V:function(){return f}});var n=r(3324),i=r(5671),a=r(3144),s=r(2346),o=r(6033),u=r(3092),l=r(6635),c=new WeakMap,h=new WeakMap,f=function(){function e(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},r=t.store,n=void 0===r?{}:r;(0,i.Z)(this,e),(0,s.Z)(this,c,{writable:!0,value:void 0}),(0,s.Z)(this,h,{writable:!0,value:void 0}),(0,u.Z)(this,c,n),(0,u.Z)(this,h,null);var a=Object.keys(n);if(a.length)for(var l=0;l<a.length;l++){var f=n[a[l]];if(0==l)(0,u.Z)(this,h,f.numberOfColumns());else if(f.numberOfColumns()!=(0,o.Z)(this,h))throw new Error("all matrices should have the same number of columns")}}return(0,a.Z)(e,[{key:"numberOfColumns",value:function(){return(0,o.Z)(this,h)}},{key:"available",value:function(){return Object.keys((0,o.Z)(this,c))}},{key:"has",value:function(e){return e in(0,o.Z)(this,c)}},{key:"get",value:function(e){return(0,o.Z)(this,c)[e]}},{key:"add",value:function(e,t){if(null===(0,o.Z)(this,h))(0,u.Z)(this,h,t.numberOfColumns());else if(t.numberOfColumns()!=(0,o.Z)(this,h))throw new Error("all matrices should have the same number of columns");if(e in(0,o.Z)(this,c)){var r=(0,o.Z)(this,c)[e];l.gd(r)}(0,o.Z)(this,c)[e]=t}},{key:"remove",value:function(e){l.gd((0,o.Z)(this,c)[e]),delete(0,o.Z)(this,c)[e],0==Object.keys((0,o.Z)(this,c)).length&&(0,u.Z)(this,h,null)}},{key:"clone",value:function(){var t=new e;try{for(var r=0,i=Object.entries((0,o.Z)(this,c));r<i.length;r++){var a=(0,n.Z)(i[r],2),s=a[0],u=a[1];t.add(s,u.clone())}}catch(l){throw t.free(),l}return t}},{key:"rename",value:function(e,t){e!==t&&(t in(0,o.Z)(this,c)&&l.gd((0,o.Z)(this,c)[t]),(0,o.Z)(this,c)[t]=(0,o.Z)(this,c)[e],delete(0,o.Z)(this,c)[e])}},{key:"free",value:function(){for(var e=0,t=Object.entries((0,o.Z)(this,c));e<t.length;e++){var r=(0,n.Z)(t[e],2),i=(r[0],r[1]);l.gd(i)}}}]),e}()},2306:function(e,t,r){"use strict";r.d(t,{p:function(){return f}});var n=r(5671),i=r(3144),a=r(2346),s=r(6033),o=r(3092),u=r(6635),l=r(7108),c=new WeakMap,h=new WeakMap,f=function(){function e(t,r){(0,n.Z)(this,e),(0,a.Z)(this,c,{writable:!0,value:void 0}),(0,a.Z)(this,h,{writable:!0,value:void 0}),(0,o.Z)(this,c,t),(0,o.Z)(this,h,r)}return(0,i.Z)(e,[{key:"clone",value:function(){var t=this;return l.R((function(e){return(0,s.Z)(t,h).clone()}),e)}},{key:"matrix",get:function(){return(0,s.Z)(this,h)}},{key:"numberOfRows",value:function(){return(0,s.Z)(this,h).nrow()}},{key:"numberOfColumns",value:function(){return(0,s.Z)(this,h).ncol()}},{key:"row",value:function(e){var t,r=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},n=r.buffer,i=void 0===n?null:n;if(null!=i)return(0,s.Z)(this,h).row(e,i.offset),i.array();i=u.RJ((0,s.Z)(this,h).ncol());try{(0,s.Z)(this,h).row(e,i.offset),t=i.slice()}finally{i.free()}return t}},{key:"column",value:function(e){var t,r=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},n=r.buffer,i=void 0===n?null:n;if(null!=i)return(0,s.Z)(this,h).column(e,i.offset),i.array();i=u.RJ((0,s.Z)(this,h).nrow());try{(0,s.Z)(this,h).column(e,i.offset),t=i.slice()}finally{i.free()}return t}},{key:"free",value:function(){null!==(0,s.Z)(this,h)&&(l.A((0,s.Z)(this,c)),(0,o.Z)(this,h,null))}},{key:"isSparse",value:function(){return(0,s.Z)(this,h).sparse()}},{key:"isReorganized",value:function(){return(0,s.Z)(this,h).reorganized()}},{key:"isPermuted",value:function(){return this.isReorganized()}},{key:"identities",value:function(){var e,t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},r=t.buffer,n=void 0===r?null:r;if(null!=n)return(0,s.Z)(this,h).identities(n.offset),n.array();n=u.Wf((0,s.Z)(this,h).nrow());try{(0,s.Z)(this,h).identities(n.offset),e=n.slice()}finally{n.free()}return e}},{key:"wipeIdentities",value:function(){(0,s.Z)(this,h).wipe_identities()}}]),e}()},5941:function(e,t,r){"use strict";r.d(t,{NC:function(){return i},pJ:function(){return a},Yd:function(){return s},xW:function(){return o}});var n=r(8782);function i(e,t){n.RE((function(r){return r.FS.writeFile(e,t)}))}function a(e){return n.RE((function(t){return t.FS.readFile(e,{encoding:"binary"})}))}function s(e){n.RE((function(t){return t.FS.unlink(e)}))}function o(e){return n.RE((function(t){return t.FS.analyzePath(e).exists}))}},5644:function(e,t,r){"use strict";r.d(t,{j4:function(){return a},jn:function(){return s},DS:function(){return o},fw:function(){return u},D4:function(){return l}});var n=r(6635),i=r(6737);function a(e){var t,r=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},i=r.buffer,a=void 0===i?null:i,s=0;e.forEach((function(e){s+=e}));try{if(null==a)a=t=n.Wf(s);else if(a.length!==s)throw new Error("'buffer' should have length equal to sum of 'ncells'");for(var o=a.array(),u=0,l=0;l<e.length;l++){var c=u;u+=e[l],o.fill(l,c,u)}}catch(h){throw n.gd(t),h}return a}function s(e){var t,r=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},i=r.buffer,a=void 0===i?null:i,s=[];try{if(null==a)a=t=n.Wf(e.length);else if(a.length!==e.length)throw new Error("'buffer' should have length equal to that of 'x'");var o=a.array(),u={};e.forEach((function(e,t){e in u||(u[e]=s.length,s.push(e)),o[t]=u[e]}))}catch(l){throw n.gd(t),l}return{ids:a,levels:s}}function o(e,t){var r,i=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{},a=i.filter,s=void 0===a?null:a,o=i.buffer,u=void 0===o?null:o,l=0;if(null===s)l=t.length;else{if(t.length!=e.length)throw new Error("'x' and 'filter' should have the same length");var c=0;t.forEach((function(e){c+=0!=e})),l=s?t.length-c:c}try{if(null==u)u=r=n.Wf(l);else if(u.length!==l)throw new Error("length of 'buffer' is not consistent with 'subset'");var h=u.array(),f=e.array();if(null==s)t.forEach((function(e,t){h[t]=f[e]}));else if(s){var d=0;t.forEach((function(e,t){0==e&&(h[d]=f[t],d++)}))}else{var v=0;t.forEach((function(e,t){0!==e&&(h[v]=f[t],v++)}))}}catch(m){throw n.gd(r),m}return u}function u(e,t){var r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{},n=r.buffer,i=void 0===n?null:n;return o(e,t,{buffer:i,filter:!0})}function l(e){e instanceof i.PQ&&(e=e.array());var t=new Set(e),r=Array.from(t).sort(),n={};return r.forEach((function(e,t){n[e]=t})),e.forEach((function(t,r){e[r]=n[t]})),r}},5470:function(e,t,r){"use strict";r.d(t,{Us:function(){return u},Ar:function(){return l},KV:function(){return c}});var n=r(7762),i=r(6635),a=r(2306),s=r(7108);function o(e){for(var t=i.GF(e.length),r=t.array(),n=0;n<e.length;n++)r[n]=BigInt(e[n].matrix.$$.ptr);return t}function u(e){var t,r;try{t=o(e),r=s.R((function(e){return e.cbind(t.length,t.offset)}),a.p)}catch(n){throw i.gd(r),n}finally{i.gd(t)}return r}function l(e){var t,r;try{t=o(e),r=s.R((function(e){return e.rbind(t.length,t.offset)}),a.p)}catch(n){throw i.gd(r),n}finally{i.gd(t)}return r}function c(e,t){var r,u,l,c=[],h={};try{var f;!function(){if(t.length!==e.length)throw new Error("length of 'names' should be equal to length of 'x'");var d={},v=[];for(f=0;f<t.length;f++){if(e[f].numberOfRows()!==t[f].length)throw new Error("length of each 'names' must equal number of rows of its corresponding 'x'");t[f].forEach((function(e){e in d||(d[e]=v.length,v.push(e))}))}var m=(u=i.GF(e.length)).array(),p=function(){var e=t[f],r=i.Wf(e.length),n=r.array();e.forEach((function(e,t){n[t]=d[e]})),c.push(r),m[f]=BigInt(r.offset)};for(f=0;f<t.length;f++)p();r=o(e),l=i.Wf(e[0].numberOfRows()),h.matrix=s.R((function(t){return t.cbind_with_rownames(e.length,r.offset,u.offset,l.offset)}),a.p),h.indices=l.slice(0,h.matrix.numberOfRows());var w,g=[],b=(0,n.Z)(h.indices);try{for(b.s();!(w=b.n()).done;){var y=w.value;g.push(t[0][y])}}catch(Z){b.e(Z)}finally{b.f()}h.names=g}()}catch(p){throw i.gd(h.matrix),p}finally{i.gd(r),i.gd(u),i.gd(l);for(var d=0,v=c;d<v.length;d++){var m=v[d];i.gd(m)}}return h}},6199:function(e,t,r){"use strict";r.d(t,{F:function(){return a}});var n=r(6635),i=r(4812);function a(e){var t,r=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},a=r.number,s=void 0===a?4e3:a;(t=e instanceof i._?e.residuals():e.slice()).sort();var o=t[Math.max(0,t.length-s)],u=n.TS(t.length);try{t=e instanceof i._?e.residuals({copy:!1}):e;var l=u.array();t.forEach((function(e,t){l[t]=e>=o}))}catch(c){throw u.free(),c}return u}},2494:function(e,t,r){"use strict";r.d(t,{p:function(){return d},e:function(){return v}});var n=r(5671),i=r(3144),a=r(2346),s=r(6033),o=r(3092),u=r(6635),l=r(7108),c=r(5159),h=new WeakMap,f=new WeakMap,d=function(){function e(t,r){(0,n.Z)(this,e),(0,a.Z)(this,h,{writable:!0,value:void 0}),(0,a.Z)(this,f,{writable:!0,value:void 0}),(0,o.Z)(this,f,r),(0,o.Z)(this,h,t)}return(0,i.Z)(e,[{key:"numberOfCells",value:function(){return(0,s.Z)(this,f).num_obs()}},{key:"numberOfClusters",value:function(){return(0,s.Z)(this,f).num_clusters()}},{key:"clusters",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t=e.copy,r=void 0===t||t;return u.Yj((0,s.Z)(this,f).clusters(),r)}},{key:"clusterSizes",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t=e.copy,r=void 0===t||t;return u.Yj((0,s.Z)(this,f).cluster_sizes(),r)}},{key:"withinClusterSumSquares",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t=e.copy,r=void 0===t||t;return u.Yj((0,s.Z)(this,f).wcss(),r)}},{key:"clusterCenters",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t=e.copy,r=void 0===t||t;return u.Yj((0,s.Z)(this,f).centers(),r)}},{key:"iterations",value:function(){return(0,s.Z)(this,f).iterations()}},{key:"status",value:function(){return(0,s.Z)(this,f).status()}},{key:"free",value:function(){null!==(0,s.Z)(this,f)&&(l.A((0,s.Z)(this,h)),(0,o.Z)(this,f,null))}}]),e}();function v(e,t){var r,n,i=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{},a=i.numberOfDims,s=void 0===a?null:a,o=i.numberOfCells,h=void 0===o?null:o,f=i.initMethod,v=void 0===f?"pca-part":f,m=i.initSeed,p=void 0===m?5768:m,w=i.initPCASizeAdjust,g=void 0===w?1:w,b=i.numberOfThreads,y=void 0===b?null:b,Z=u.mV(y);try{var _;if(e instanceof c.R){s=e.numberOfPCs(),h=e.numberOfCells();var k=e.principalComponents({copy:!1});_=k.byteOffset}else{if(null===s||null===h)throw new Error("'numberOfDims' and 'numberOfCells' must be specified when 'x' is an Array");if((r=u.de(e,"Float64WasmArray")).length!=s*h)throw new Error("length of 'x' must be the product of 'numberOfDims' and 'numberOfCells'");_=r.offset}n=l.R((function(e){return e.cluster_kmeans(_,s,h,t,v,p,g,Z)}),d)}catch(A){throw u.gd(n),A}finally{u.gd(r)}return n}},9273:function(e,t,r){"use strict";r.d(t,{rL:function(){return d},bD:function(){return v},nf:function(){return w},Fo:function(){return y},a1:function(){return k},ZI:function(){return A}});var n=r(5671),i=r(3144),a=r(2346),s=r(6033),o=r(3092),u=r(6635),l=r(7108),c=r(7067),h=new WeakMap,f=new WeakMap,d=function(){function e(t,r){(0,n.Z)(this,e),(0,a.Z)(this,h,{writable:!0,value:void 0}),(0,a.Z)(this,f,{writable:!0,value:void 0}),(0,o.Z)(this,h,t),(0,o.Z)(this,f,r)}return(0,i.Z)(e,[{key:"free",value:function(){null!==(0,s.Z)(this,f)&&(l.A((0,s.Z)(this,h)),(0,o.Z)(this,f,null))}},{key:"graph",get:function(){return(0,s.Z)(this,f)}}]),e}();function v(e){var t,r,n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},i=n.scheme,a=void 0===i?"rank":i,s=n.neighbors,o=void 0===s?10:s,h=n.numberOfThreads,f=void 0===h?null:h,v=u.mV(f);"number"==typeof a&&(a=["rank","number","jaccard"][a]);try{var m;e instanceof c.qv?m=e:(r=(0,c.wf)(e,o,{numberOfThreads:v}),m=r),t=l.R((function(e){return e.build_snn_graph(m.results,a,v)}),d)}catch(p){throw u.gd(t),p}finally{u.gd(r)}return t}var m=new WeakMap,p=new WeakMap,w=function(){function e(t,r){(0,n.Z)(this,e),(0,a.Z)(this,m,{writable:!0,value:void 0}),(0,a.Z)(this,p,{writable:!0,value:void 0}),(0,o.Z)(this,m,t),(0,o.Z)(this,p,r)}return(0,i.Z)(e,[{key:"best",value:function(){return(0,s.Z)(this,p).best()}},{key:"numberOfLevels",value:function(){return(0,s.Z)(this,p).number()}},{key:"modularity",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t=e.level,r=void 0===t?null:t;return null===r&&(r=this.best()),(0,s.Z)(this,p).modularity(r)}},{key:"membership",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t=e.level,r=void 0===t?null:t,n=e.copy,i=void 0===n||n;return null===r&&(r=this.best()),u.Yj((0,s.Z)(this,p).membership(r),i)}},{key:"free",value:function(){null!==(0,s.Z)(this,p)&&(l.A((0,s.Z)(this,m)),(0,o.Z)(this,p,null))}}]),e}(),g=new WeakMap,b=new WeakMap,y=function(){function e(t,r){(0,n.Z)(this,e),(0,a.Z)(this,g,{writable:!0,value:void 0}),(0,a.Z)(this,b,{writable:!0,value:void 0}),(0,o.Z)(this,g,t),(0,o.Z)(this,b,r)}return(0,i.Z)(e,[{key:"modularity",value:function(){return(0,s.Z)(this,b).modularity()}},{key:"membership",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t=e.copy,r=void 0===t||t;return u.Yj((0,s.Z)(this,b).membership(),r)}},{key:"free",value:function(){null!==(0,s.Z)(this,b)&&(l.A((0,s.Z)(this,g)),(0,o.Z)(this,b,null))}}]),e}(),Z=new WeakMap,_=new WeakMap,k=function(){function e(t,r){(0,n.Z)(this,e),(0,a.Z)(this,Z,{writable:!0,value:void 0}),(0,a.Z)(this,_,{writable:!0,value:void 0}),(0,o.Z)(this,Z,t),(0,o.Z)(this,_,r)}return(0,i.Z)(e,[{key:"modularity",value:function(){return(0,s.Z)(this,_).modularity()}},{key:"membership",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t=e.copy,r=void 0===t||t;return u.Yj((0,s.Z)(this,_).membership(),r)}},{key:"free",value:function(){null!==(0,s.Z)(this,_)&&(l.A((0,s.Z)(this,Z)),(0,o.Z)(this,_,null))}}]),e}();function A(e){var t,r=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},n=r.method,i=void 0===n?"multilevel":n,a=r.resolution,s=void 0===a?1:a,o=r.walktrapSteps,c=void 0===o?4:o;try{if("multilevel"==i)t=l.R((function(t){return t.cluster_snn_graph_multilevel(e.graph,s)}),w);else if("walktrap"==i)t=l.R((function(t){return t.cluster_snn_graph_walktrap(e.graph,c)}),y);else{if("leiden"!=i)throw new Error("unknown method '"+i+"'");t=l.R((function(t){return t.cluster_snn_graph_leiden(e.graph,s)}),k)}}catch(h){throw u.gd(t),h}return t}},2690:function(e,t,r){"use strict";r.d(t,{P:function(){return d},r:function(){return v}});var n=r(5671),i=r(3144),a=r(2346),s=r(6033),o=r(3092),u=r(7108),l=r(6635),c=r(6807),h=new WeakMap,f=new WeakMap,d=function(){function e(t,r){(0,n.Z)(this,e),(0,a.Z)(this,h,{writable:!0,value:void 0}),(0,a.Z)(this,f,{writable:!0,value:void 0}),(0,o.Z)(this,f,t),(0,o.Z)(this,h,r)}return(0,i.Z)(e,[{key:"discardDetected",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t=e.copy,r=void 0===t||t;return l.Yj((0,s.Z)(this,h).discard_detected(),r)}},{key:"discardSubsetTotals",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},r=t.copy,n=void 0===r||r;return l.Yj((0,s.Z)(this,h).discard_subset_totals(e),n)}},{key:"discardOverall",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t=e.copy,r=void 0===t||t;return l.Yj((0,s.Z)(this,h).discard_overall(),r)}},{key:"thresholdsDetected",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t=e.copy,r=void 0===t||t;return l.Yj((0,s.Z)(this,h).thresholds_detected(),r)}},{key:"thresholdsSubsetTotals",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},r=t.copy,n=void 0===r||r;return l.Yj((0,s.Z)(this,h).thresholds_subset_totals(e),n)}},{key:"numberOfSubsets",value:function(){return(0,s.Z)(this,h).num_subsets()}},{key:"free",value:function(){null!==(0,s.Z)(this,h)&&(u.A((0,s.Z)(this,f)),(0,o.Z)(this,h,null))}}]),e}();function v(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},r=t.numberOfMADs,n=void 0===r?3:r,i=t.minDetectedDrop,a=void 0===i?.1:i,s=t.block,o=void 0===s?null:s;return c.H(e,o,(function(e){return e.detected().length}),(function(e,t,r){return u.R((function(i){return i.per_cell_adt_qc_filters(e.results,t,r,n,a)}),d)}))}},2195:function(e,t,r){"use strict";r.d(t,{yf:function(){return d},pN:function(){return v},oY:function(){return m}});var n=r(5671),i=r(3144),a=r(2346),s=r(6033),o=r(3092),u=r(7108),l=r(6635),c=r(6078),h=new WeakMap,f=new WeakMap,d=function(){function e(t,r){(0,n.Z)(this,e),(0,a.Z)(this,h,{writable:!0,value:void 0}),(0,a.Z)(this,f,{writable:!0,value:void 0}),(0,o.Z)(this,h,t),(0,o.Z)(this,f,r)}return(0,i.Z)(e,[{key:"results",get:function(){return(0,s.Z)(this,f)}},{key:"sums",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t=e.copy,r=void 0===t||t;return l.Yj((0,s.Z)(this,f).sums(),r)}},{key:"detected",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t=e.copy,r=void 0===t||t;return l.Yj((0,s.Z)(this,f).detected(),r)}},{key:"subsetTotals",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},r=t.copy,n=void 0===r||r;return l.Yj((0,s.Z)(this,f).subset_totals(e),n)}},{key:"numberOfSubsets",value:function(){return(0,s.Z)(this,f).num_subsets()}},{key:"free",value:function(){null!==(0,s.Z)(this,f)&&(u.A((0,s.Z)(this,h)),(0,o.Z)(this,f,null))}}]),e}();function v(e,t){var r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{},n=r.numberOfThreads,i=void 0===n?null:n,a=l.mV(i);return c.$(e,t,(function(e,t,r){return u.R((function(n){return n.per_cell_adt_qc_metrics(e,t,r,a)}),d)}))}function m(e,t){return u.R((function(r){return new r.PerCellAdtQcMetrics_Results(e,t)}),d)}},4902:function(e,t,r){"use strict";r.d(t,{x:function(){return d},r:function(){return v}});var n=r(5671),i=r(3144),a=r(2346),s=r(6033),o=r(3092),u=r(7108),l=r(6635),c=r(6807),h=new WeakMap,f=new WeakMap,d=function(){function e(t,r){(0,n.Z)(this,e),(0,a.Z)(this,h,{writable:!0,value:void 0}),(0,a.Z)(this,f,{writable:!0,value:void 0}),(0,o.Z)(this,h,t),(0,o.Z)(this,f,r)}return(0,i.Z)(e,[{key:"discardSums",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t=e.copy,r=void 0===t||t;return l.Yj((0,s.Z)(this,f).discard_sums(),r)}},{key:"discardDetected",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t=e.copy,r=void 0===t||t;return l.Yj((0,s.Z)(this,f).discard_detected(),r)}},{key:"discardSubsetProportions",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},r=t.copy,n=void 0===r||r;return l.Yj((0,s.Z)(this,f).discard_proportions(e),n)}},{key:"discardOverall",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t=e.copy,r=void 0===t||t;return l.Yj((0,s.Z)(this,f).discard_overall(),r)}},{key:"thresholdsSums",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t=e.copy,r=void 0===t||t;return l.Yj((0,s.Z)(this,f).thresholds_sums(),r)}},{key:"thresholdsDetected",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t=e.copy,r=void 0===t||t;return l.Yj((0,s.Z)(this,f).thresholds_detected(),r)}},{key:"thresholdsSubsetProportions",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},r=t.copy,n=void 0===r||r;return l.Yj((0,s.Z)(this,f).thresholds_proportions(e),n)}},{key:"numberOfSubsets",value:function(){return(0,s.Z)(this,f).num_subsets()}},{key:"free",value:function(){null!==(0,s.Z)(this,f)&&(u.A((0,s.Z)(this,h)),(0,o.Z)(this,f,null))}}]),e}();function v(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},r=t.numberOfMADs,n=void 0===r?3:r,i=t.block,a=void 0===i?null:i;return c.H(e,a,(function(e){return e.sums().length}),(function(e,t,r){return u.R((function(i){return i.per_cell_qc_filters(e.results,t,r,n)}),d)}))}},6292:function(e,t,r){"use strict";r.d(t,{ml:function(){return d},i4:function(){return v},HN:function(){return m}});var n=r(5671),i=r(3144),a=r(2346),s=r(6033),o=r(3092),u=r(7108),l=r(6635),c=r(6078),h=new WeakMap,f=new WeakMap,d=function(){function e(t,r){(0,n.Z)(this,e),(0,a.Z)(this,h,{writable:!0,value:void 0}),(0,a.Z)(this,f,{writable:!0,value:void 0}),(0,o.Z)(this,h,t),(0,o.Z)(this,f,r)}return(0,i.Z)(e,[{key:"results",get:function(){return(0,s.Z)(this,f)}},{key:"sums",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t=e.copy,r=void 0===t||t;return l.Yj((0,s.Z)(this,f).sums(),r)}},{key:"detected",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t=e.copy,r=void 0===t||t;return l.Yj((0,s.Z)(this,f).detected(),r)}},{key:"subsetProportions",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},r=t.copy,n=void 0===r||r;return l.Yj((0,s.Z)(this,f).subset_proportions(e),n)}},{key:"isProportion",value:function(){return(0,s.Z)(this,f).is_proportion()}},{key:"numberOfSubsets",value:function(){return(0,s.Z)(this,f).num_subsets()}},{key:"free",value:function(){null!==(0,s.Z)(this,f)&&(u.A((0,s.Z)(this,h)),(0,o.Z)(this,f,null))}}]),e}();function v(e,t){var r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{},n=r.subsetProportions,i=void 0===n||n,a=r.numberOfThreads,s=void 0===a?null:a,o=l.mV(s);return c.$(e,t,(function(e,t,r){return u.R((function(n){return n.per_cell_qc_metrics(e,t,r,i,o)}),d)}))}function m(e,t){var r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{},n=r.subsetProportions,i=void 0===n||n;return u.R((function(r){return new r.PerCellQCMetrics_Results(e,t,i)}),d)}},5219:function(e,t,r){"use strict";r.d(t,{uC:function(){return a},Xr:function(){return s},p4:function(){return o}});var n=r(6635),i=r(8782);function a(e,t,r){var a,s,o,u=arguments.length>3&&void 0!==arguments[3]?arguments[3]:{},l=u.right,c=void 0===l||l,h=u.along,f=void 0===h?"row":h,d=u.inPlace,v=void 0!==d&&d;try{v?o=e:(a=e.clone(),o=a);var m="row"==f?0:1;"number"==typeof r?i.RE((function(e){return e.delayed_arithmetic_scalar(o.matrix,t,c,r)})):(s=n.de(r,"Float64WasmArray"),i.RE((function(e){return e.delayed_arithmetic_vector(o.matrix,t,c,m,s.offset,s.length)})))}catch(p){throw n.gd(a),p}finally{n.gd(s)}return o}function s(e,t){var r,a,s=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{},o=s.logBase,u=void 0===o?null:o,l=s.inPlace,c=void 0!==l&&l;try{c?a=e:(r=e.clone(),a=r),null===u&&(u=-1),i.RE((function(e){return e.delayed_math(a.matrix,t,u)}))}catch(h){throw n.gd(r),h}return a}function o(e){var t,r,a=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},s=a.inPlace,o=void 0!==s&&s;try{o?r=e:(t=e.clone(),r=t),i.RE((function(e){return e.transpose(r.matrix)}))}catch(u){throw n.gd(t),u}return r}},489:function(e,t,r){"use strict";r.d(t,{NC:function(){return i},pJ:function(){return a},Yd:function(){return s},xW:function(){return o}});var n=r(5941);function i(e,t){n.NC(e,t)}function a(e){return n.pJ(e)}function s(e){o(e)&&n.Yd(e)}function o(e){return n.xW(e)}},8420:function(e,t,r){"use strict";r.d(t,{b:function(){return s}});var n=r(7108),i=r(6635),a=r(4902);function s(e,t){var r,s;try{var o;if(t instanceof a.x){var u=t.discardOverall({copy:!1});o=u.byteOffset}else{if((r=i.de(t,"Uint8WasmArray")).length!=e.numberOfColumns())throw new Error("length of 'filters' must be equal to number of columns in 'x'");o=r.offset}s=n.R((function(t){return t.filter_cells(e.matrix,o,!1)}),e.constructor)}catch(l){throw i.gd(s),l}finally{i.gd(r)}return s}},7067:function(e,t,r){"use strict";r.d(t,{ZF:function(){return d},Fu:function(){return v},qv:function(){return w},wf:function(){return g}});var n=r(5671),i=r(3144),a=r(2346),s=r(6033),o=r(3092),u=r(6635),l=r(7108),c=r(5159),h=new WeakMap,f=new WeakMap,d=function(){function e(t,r){(0,n.Z)(this,e),(0,a.Z)(this,h,{writable:!0,value:void 0}),(0,a.Z)(this,f,{writable:!0,value:void 0}),(0,o.Z)(this,h,t),(0,o.Z)(this,f,r)}return(0,i.Z)(e,[{key:"numberOfCells",value:function(){return(0,s.Z)(this,f).num_obs()}},{key:"numberOfDims",value:function(){return(0,s.Z)(this,f).num_dim()}},{key:"free",value:function(){null!==(0,s.Z)(this,f)&&(l.A((0,s.Z)(this,h)),(0,o.Z)(this,f,null))}},{key:"index",get:function(){return(0,s.Z)(this,f)}}]),e}();function v(e){var t,r,n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},i=n.numberOfDims,a=void 0===i?null:i,s=n.numberOfCells,o=void 0===s?null:s,h=n.approximate,f=void 0===h||h;try{var v;if(e instanceof c.R){a=e.numberOfPCs(),o=e.numberOfCells();var m=e.principalComponents({copy:!1});v=m.byteOffset}else{if(null===a||null===o)throw new Error("'numberOfDims' and 'numberOfCells' must be specified when 'x' is an Array");if((t=u.de(e,"Float64WasmArray")).length!=a*o)throw new Error("length of 'x' must be the product of 'numberOfDims' and 'numberOfCells'");v=t.offset}r=l.R((function(e){return e.build_neighbor_index(v,a,o,f)}),d)}catch(p){throw u.gd(r),p}finally{u.gd(t)}return r}var m=new WeakMap,p=new WeakMap,w=function(){function e(t,r){(0,n.Z)(this,e),(0,a.Z)(this,m,{writable:!0,value:void 0}),(0,a.Z)(this,p,{writable:!0,value:void 0}),(0,o.Z)(this,m,t),(0,o.Z)(this,p,r)}return(0,i.Z)(e,[{key:"size",value:function(){return(0,s.Z)(this,p).size()}},{key:"numberOfCells",value:function(){return(0,s.Z)(this,p).num_obs()}},{key:"results",get:function(){return(0,s.Z)(this,p)}},{key:"serialize",value:function(){var e,t,r,n,i=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},a=i.runs,o=void 0===a?null:a,l=i.indices,c=void 0===l?null:l,h=i.distances,f=void 0===h?null:h,d=(null===o)+(null===c)+(null===f);if(3!=d&&0!=d)throw new Error("either all or none of 'runs', 'indices' and 'distances' can be 'null'");if(3===d)try{t=u.Wf(this.numberOfCells());var v=this.size();r=u.Wf(v),n=u.RJ(v),(0,s.Z)(this,p).serialize(t.offset,r.offset,n.offset),e={runs:t.slice(),indices:r.slice(),distances:n.slice()}}finally{u.gd(t),u.gd(r),u.gd(n)}else(0,s.Z)(this,p).serialize(o.offset,c.offset,f.offset),e={runs:o.array(),indices:c.array(),distances:f.array()};return e}},{key:"free",value:function(){null!==(0,s.Z)(this,p)&&(l.A((0,s.Z)(this,m)),(0,o.Z)(this,p,null))}}],[{key:"unserialize",value:function(t,r,n){var i,a,s,o;try{a=u.de(t,"Int32WasmArray"),s=u.de(r,"Int32WasmArray"),o=u.de(n,"Float64WasmArray"),i=l.R((function(e){return new e.NeighborResults(t.length,a.offset,s.offset,o.offset)}),e)}catch(c){throw u.gd(i),c}finally{u.gd(a),u.gd(s),u.gd(o)}return i}}]),e}();function g(e,t){var r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{},n=r.numberOfThreads,i=void 0===n?null:n,a=u.mV(i);return l.R((function(r){return r.find_nearest_neighbors(e.index,t,a)}),w)}},7108:function(e,t,r){"use strict";r.d(t,{A:function(){return o},R:function(){return l}});var n=r(5647),i=r(8782),a={},s=0;function o(e){e in a&&(a[e].delete(),delete a[e])}var u=new FinalizationRegistry(o);function l(e,t){var r,l=i.RE(e),c=s;a[c]=l,s++;try{for(var h=arguments.length,f=new Array(h>2?h-2:0),d=2;d<h;d++)f[d-2]=arguments[d];r=(0,n.Z)(t,[c,l].concat(f))}catch(v){throw o(c),v}return u.register(r,c),r}},9283:function(e,t,r){"use strict";r.d(t,{S:function(){return s}});var n=r(8782),i=r(6635),a=(r(2306),r(6737));function s(e,t){var r,s,o=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{},u=o.center,l=void 0===u||u,c=o.buffer,h=void 0===c?null:c,f=o.priorCount,d=void 0===f?10:f,v=o.reference,m=void 0===v?null:v,p=o.numberOfThreads,w=void 0===p?null:p,g=i.mV(w);try{if(h instanceof a.lt){if(h.length!==e.numberOfColumns())throw new Error("length of 'buffer' must be equal to the number of columns in 'x'")}else r=i.RJ(e.numberOfColumns()),h=r;s=i.de(t,"Int32WasmArray"),null==m&&(m=-1),n.RE((function(t){return t.grouped_size_factors(e.matrix,s.offset,l,d,m,h.offset,g)}))}catch(b){throw i.gd(r),b}finally{i.gd(s)}return h}},2284:function(e,t,r){"use strict";r.d(t,{g:function(){return n}});r(8939);function n(e){var t=0;e.forEach((function(e){e&&e.match(/^ENSG[0-9]{11}$/)&&t++}));var r=0;e.forEach((function(e){e&&e.match(/^[A-Z][^a-z]+$/)&&!e.match(/^ENS[A-Z]+[0-9]{11}/)&&r++}));var n=0;e.forEach((function(e){e&&e.match(/^ENSMUSG[0-9]{11}$/)&&n++}));var i=0;e.forEach((function(e){e&&e.match(/^[A-Z][^A-Z]+$/)&&i++}));for(var a=[{species:"human",type:"ensembl",confidence:t},{species:"human",type:"symbol",confidence:r},{species:"mouse",type:"ensembl",confidence:n},{species:"mouse",type:"symbol",confidence:i}],s=a[0],o=1;o<a.length;o++)a[o].confidence>s.confidence&&(s=a[o]);return s.confidence/=e.length,s}},6126:function(e,t,r){"use strict";r.d(t,{i2:function(){return S},Fv:function(){return N},pT:function(){return F},ll:function(){return D},kN:function(){return j},JM:function(){return U},dO:function(){return q}});var n=r(3112),i=r(7326),a=r(136),s=r(9388),o=r(3324),u=r(5671),l=r(3144),c=r(101),h=r(2346),f=r(3889),d=r(6033),v=r(3092),m=r(7762),p=r(6635),w=r(8782),g=r(6774);function b(e,t){if(t.length>0){var r=t.reduce((function(e,t){return e*t}));if(e.length!=r)throw new Error("length of 'x' must be equal to the product of 'shape'")}else if(e instanceof Array||ArrayBuffer.isView(e)){if(1!=e.length)throw new Error("length of 'x' should be 1 for a scalar dataset")}else e=[e];return e}function y(e,t){return null===t?"string"==typeof e||"number"==typeof e?(e=[e],t=[]):t=[e.length]:e=b(e,t),{x:e,shape:t}}function Z(e){if(Array.isArray(e)){var t,r=(0,m.Z)(e);try{for(r.s();!(t=r.n()).done;){if("string"===typeof t.value)throw new Error("'x' should not contain any strings for a non-string HDF5 dataset")}}catch(n){r.e(n)}finally{r.f()}}}function _(e){var t=0;return e.array().forEach((function(e){t<e&&(t=e)})),t}var k=new WeakMap,A=new WeakMap,x=new WeakMap,E=new WeakSet,S=function(){function e(t,r){(0,u.Z)(this,e),(0,c.Z)(this,E),(0,h.Z)(this,k,{writable:!0,value:void 0}),(0,h.Z)(this,A,{writable:!0,value:void 0}),(0,h.Z)(this,x,{writable:!0,value:void 0}),(0,v.Z)(this,k,t),(0,v.Z)(this,A,r)}return(0,l.Z)(e,[{key:"file",get:function(){return(0,d.Z)(this,k)}},{key:"name",get:function(){return(0,d.Z)(this,A)}},{key:"attributes",get:function(){return(0,d.Z)(this,x)}},{key:"set_attributes",value:function(e){(0,v.Z)(this,x,e)}},{key:"readAttribute",value:function(e){var t,r,n=this,i=w.RE((function(t){return new t.LoadedH5Attr(n.file,n.name,e)}));try{r=Array.from(i.shape());var a=i.type();if("other"==a)throw new Error("cannot load dataset for an unsupported type");t="String"==a?g.b(i.values(),i.lengths()):i.values().slice()}finally{i.delete()}return{values:t,shape:r}}},{key:"writeAttribute",value:function(e,t,r,n){var i=this,a=arguments.length>4&&void 0!==arguments[4]?arguments[4]:{},s=a.maxStringLength,u=void 0===s?null:s;if(null===n)throw new Error("cannot write 'null' to HDF5");var l=y(n,r);if(n=l.x,r=l.shape,"String"==t){var c=g.C(n),h=(0,o.Z)(c,2),d=h[0],v=h[1];try{null==u&&(u=_(d)),(0,f.Z)(this,E,O).call(this,e,t,r,{maxStringLength:u}),w.RE((function(t){return t.write_string_hdf5_attribute(i.file,i.name,e,d.length,d.offset,v.offset)}))}finally{p.gd(v),p.gd(d)}}else{Z(n);var m=p.de(n,null);try{(0,f.Z)(this,E,O).call(this,e,t,r),w.RE((function(t){return t.write_numeric_hdf5_attribute(i.file,i.name,e,m.constructor.className,m.offset)}))}finally{m.free()}}}}]),e}();function O(e,t,r){var n=this,i=arguments.length>3&&void 0!==arguments[3]?arguments[3]:{},a=i.maxStringLength,s=void 0===a?10:a,o=p.de(r,"Int32WasmArray");try{w.RE((function(r){return r.create_hdf5_attribute(n.file,n.name,e,t,o.length,o.offset,s)})),(0,d.Z)(this,x).push(e)}finally{o.free()}}var I=new WeakMap,C=new WeakMap,R=new WeakSet,N=function(e){(0,a.Z)(r,e);var t=(0,s.Z)(r);function r(e,n){var a,s=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{},o=s.newlyCreated,l=void 0!==o&&o;if((0,u.Z)(this,r),a=t.call(this,e,n),(0,c.Z)((0,i.Z)(a),R),(0,h.Z)((0,i.Z)(a),I,{writable:!0,value:void 0}),(0,h.Z)((0,i.Z)(a),C,{writable:!0,value:void 0}),l)(0,v.Z)((0,i.Z)(a),I,{}),a.set_attributes([]);else{var f=w.RE((function(t){return new t.H5GroupDetails(e,n)}));try{var m=g.b(f.child_buffer(),f.child_lengths()),p=f.child_types(),b=["Group","DataSet","Other"];(0,v.Z)((0,i.Z)(a),I,{});for(var y=0;y<m.length;y++)(0,d.Z)((0,i.Z)(a),I)[m[y]]=b[p[y]];var Z=g.b(f.attr_buffer(),f.attr_lengths());a.set_attributes(Z)}finally{f.delete()}}return a}return(0,l.Z)(r,[{key:"children",get:function(){return(0,d.Z)(this,I)}},{key:"open",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},n=(0,f.Z)(this,R,M).call(this,e);if(e in(0,d.Z)(this,I)){if("Group"==(0,d.Z)(this,I)[e])return new r(this.file,n,t);if("DataSet"==(0,d.Z)(this,I)[e])return new j(this.file,n,t);throw new Error("don't know how to open '"+e+"'")}throw new Error("no '"+e+"' child in this HDF5 Group")}},{key:"createGroup",value:function(e){var t=this,n=(0,f.Z)(this,R,M).call(this,e);if(e in this.children){if("Group"==this.children[e])return new r(this.file,n);throw new Error("existing child '"+n+"' is not a HDF5 group")}return w.RE((function(e){return e.create_hdf5_group(t.file,n)})),this.children[e]="Group",new r(this.file,n,{newlyCreated:!0})}},{key:"createDataSet",value:function(e,t,r){var n,i,a=this,s=arguments.length>3&&void 0!==arguments[3]?arguments[3]:{},o=s.maxStringLength,u=void 0===o?10:o,l=s.compression,c=void 0===l?6:l,h=s.chunks,d=void 0===h?null:h,v=(0,f.Z)(this,R,M).call(this,e);try{var m=(n=p.de(r,"Int32WasmArray")).offset;if(null!==d){if((i=p.de(d,"Int32WasmArray")).length!=n.length)throw new Error("'chunks' and 'shape' should have the same dimensions");m=i.offset}w.RE((function(e){return e.create_hdf5_dataset(a.file,v,t,n.length,n.offset,u,c,m)}))}finally{n.free()}return this.children[e]="DataSet",new j(this.file,v,{newlyCreated:!0,type:t,shape:r})}},{key:"writeDataSet",value:function(e,t,r,n){var i=arguments.length>4&&void 0!==arguments[4]?arguments[4]:{},a=i.compression,s=void 0===a?6:a,u=i.chunks,l=void 0===u?null:u,c=i.cache,h=void 0!==c&&c;if(null===n)throw new Error("cannot write 'null' to HDF5");var f,d=y(n,r);if(n=d.x,r=d.shape,"String"==t){var v=g.C(n),m=(0,o.Z)(v,2),b=m[0],Z=m[1];try{var k=_(b);f=this.createDataSet(e,"String",r,{maxStringLength:k,compression:s,chunks:l}),w.RE((function(e){return e.write_string_hdf5_dataset(f.file,f.name,b.length,b.offset,Z.offset)}))}finally{p.gd(b),p.gd(Z)}f.cache_loaded(n,h)}else(f=this.createDataSet(e,t,r,{compression:s,chunks:l})).write(n,{cache:h});return f}}]),r}(S);function M(e){var t=this.name;return"/"!=t&&(t+="/"),t+=e}var F=function(e){(0,a.Z)(r,e);var t=(0,s.Z)(r);function r(e){var n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};return(0,u.Z)(this,r),t.call(this,e,"/",n)}return(0,l.Z)(r)}(N);function D(e){return w.RE((function(t){return t.create_hdf5_file(e)})),new F(e,{newlyCreated:!0})}var z=new WeakMap,B=new WeakMap,W=new WeakMap,G=new WeakMap,j=function(e){(0,a.Z)(r,e);var t=(0,s.Z)(r);function r(e,a){var s,o=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{},l=o.load,c=void 0!==l&&l,f=o.newlyCreated,d=void 0!==f&&f,m=o.shape,p=void 0===m?null:m,b=o.type,y=void 0===b?null:b,Z=o.values,_=void 0===Z?null:Z;if((0,u.Z)(this,r),s=t.call(this,e,a),(0,h.Z)((0,i.Z)(s),z,{writable:!0,value:void 0}),(0,h.Z)((0,i.Z)(s),B,{writable:!0,value:void 0}),(0,h.Z)((0,i.Z)(s),W,{writable:!0,value:void 0}),(0,h.Z)((0,i.Z)(s),G,{writable:!0,value:void 0}),d){if(null===p||null===y)throw new Error("need to pass 'shape' and 'type' if 'newlyCreated = true'");(0,v.Z)((0,i.Z)(s),z,p),(0,v.Z)((0,i.Z)(s),B,y),(0,v.Z)((0,i.Z)(s),W,_),(0,v.Z)((0,i.Z)(s),G,null!==_),s.set_attributes([])}else{if(c){var k=(0,n.Z)(r,r,T).call(r,e,a);(0,v.Z)((0,i.Z)(s),B,k.type),(0,v.Z)((0,i.Z)(s),z,k.shape),(0,v.Z)((0,i.Z)(s),W,k.values),s.set_attributes(k.attributes)}else{var A=w.RE((function(t){return new t.H5DataSetDetails(e,a)}));try{(0,v.Z)((0,i.Z)(s),B,A.type()),(0,v.Z)((0,i.Z)(s),z,Array.from(A.shape())),(0,v.Z)((0,i.Z)(s),W,null),s.set_attributes(g.b(A.attr_buffer(),A.attr_lengths()))}finally{A.delete()}}(0,v.Z)((0,i.Z)(s),G,c)}return s}return(0,l.Z)(r,[{key:"type",get:function(){return(0,d.Z)(this,B)}},{key:"shape",get:function(){return(0,d.Z)(this,z)}},{key:"loaded",get:function(){return(0,d.Z)(this,G)}},{key:"values",get:function(){return(0,d.Z)(this,W)}},{key:"load",value:function(){if(!(0,d.Z)(this,G)){var e=(0,n.Z)(r,r,T).call(r,this.file,this.name);(0,v.Z)(this,W,e.values),(0,v.Z)(this,G,!0)}return(0,d.Z)(this,W)}},{key:"cache_loaded",value:function(e,t){t?((0,v.Z)(this,W,e.slice()),(0,v.Z)(this,G,!0)):((0,v.Z)(this,G,!1),(0,v.Z)(this,W,null))}},{key:"write",value:function(e){var t=this,r=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},n=r.cache,i=void 0!==n&&n;if(null===e)throw new Error("cannot write 'null' to HDF5");if(e=b(e,this.shape),"String"==this.type){var a=g.C(e),s=(0,o.Z)(a,2),u=s[0],l=s[1];try{w.RE((function(e){return e.write_string_hdf5_dataset(t.file,t.name,u.length,u.offset,l.offset)}))}finally{p.gd(l),p.gd(u)}this.cache_loaded(e,i)}else{Z(e);var c=p.de(e,null);try{w.RE((function(e){return e.write_numeric_hdf5_dataset(t.file,t.name,c.constructor.className,c.offset)})),this.cache_loaded(c,i)}finally{c.free()}}}}]),r}(S);function T(e,t){var r,n,i,a,s=w.RE((function(r){return new r.LoadedH5DataSet(e,t)}));try{if("other"==(n=s.type()))throw new Error("cannot load dataset for an unsupported type");r="String"==n?g.b(s.values(),s.lengths()):s.values().slice(),i=Array.from(s.shape()),a=g.b(s.attr_buffer(),s.attr_lengths())}finally{s.delete()}return{values:r,type:n,shape:i,attributes:a}}function Q(e,t){for(var r=!(arguments.length>2&&void 0!==arguments[2])||arguments[2],n=0,i=Object.entries(e.children);n<i.length;n++){var a=(0,o.Z)(i[n],2),s=a[0],u=a[1];if("Group"==u)t[s]={},r&&Q(e.open(s),t[s],r);else{var l=e.open(s),c=void 0;c=l.type.startsWith("Uint")||l.type.startsWith("Int")?"integer":l.type.startsWith("Float")?"float":l.type.toLowerCase(),t[s]=c+" dataset"}}}function U(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},r=t.group,n=void 0===r?"":r,i=t.recursive,a=void 0===i||i,s={};return Q(""==n?new F(e):new N(e,n),s,a),s}function q(e,t){var r=new j(e,t,{load:!0});return{dimensions:r.shape,contents:r.values}}},4660:function(e,t,r){"use strict";r.r(t),r.d(t,{BuildNeighborSearchIndexResults:function(){return S.ZF},BuildSNNGraphResults:function(){return O.rL},ClusterKmeansResults:function(){return H.p},ClusterSNNGraphLeidenResults:function(){return O.a1},ClusterSNNGraphMultiLevelResults:function(){return O.nf},ClusterSNNGraphWalktrapResults:function(){return O.Fo},FindNearestNeighborsResults:function(){return S.qv},H5Base:function(){return s.i2},H5DataSet:function(){return s.kN},H5File:function(){return s.pT},H5Group:function(){return s.Fv},InitializeTSNEResults:function(){return W},InitializeUMAPResults:function(){return P},ModelGeneVarResults:function(){return A._},MultiMatrix:function(){return $.V},PerCellAdtQcFiltersResults:function(){return g.P},PerCellAdtQcMetricsResults:function(){return p.yf},PerCellQCFiltersResults:function(){return w.x},PerCellQCMetricsResults:function(){return m.ml},RdsBooleanVector:function(){return o.Ox},RdsDetails:function(){return o.o5},RdsDoubleVector:function(){return o.k1},RdsGenericVector:function(){return o.SV},RdsIntegerVector:function(){return o.D6},RdsNull:function(){return o.aT},RdsObject:function(){return o.xL},RdsS4Object:function(){return o.BA},RdsStringVector:function(){return o.II},RdsVector:function(){return o.qu},RunPCAResults:function(){return E.R},ScoreMarkersResults:function(){return K.O},buildLabelledReference:function(){return X.St},buildNeighborSearchIndex:function(){return S.Fu},buildSNNGraph:function(){return O.bD},cbind:function(){return f.Us},cbindWithNames:function(){return f.KV},chooseHVGs:function(){return x.F},chooseTemporaryPath:function(){return ee._},clusterKmeans:function(){return H.e},clusterSNNGraph:function(){return O.ZI},computePerCellAdtQcFilters:function(){return g.r},computePerCellAdtQcMetrics:function(){return p.pN},computePerCellQCFilters:function(){return w.r},computePerCellQCMetrics:function(){return m.i4},convertBlock:function(){return h.jn},createBlock:function(){return h.j4},createFloat64WasmArray:function(){return i.RJ},createInt32WasmArray:function(){return i.Wf},createNewHDF5File:function(){return s.ll},createUint8WasmArray:function(){return i.TS},delayedArithmetic:function(){return v.uC},delayedMath:function(){return v.Xr},dropUnusedBlock:function(){return h.D4},emptyPerCellAdtQcMetricsResults:function(){return p.oY},emptyPerCellQCMetricsResults:function(){return m.HN},existsFile:function(){return u.xW},extractHDF5MatrixDetails:function(){return a.N6},extractHDF5ObjectNames:function(){return s.JM},extractMatrixMarketDimensions:function(){return a.us},filterBlock:function(){return h.fw},filterCells:function(){return b.b},findNearestNeighbors:function(){return S.wf},free:function(){return i.gd},groupedSizeFactors:function(){return Z.S},guessFeatures:function(){return c.g},heapSize:function(){return n.M1},initialize:function(){return n.j2},initializeDenseMatrixFromDenseArray:function(){return a.gP},initializeSparseMatrixFromCompressedVectors:function(){return a.el},initializeSparseMatrixFromDenseArray:function(){return a.xz},initializeSparseMatrixFromHDF5:function(){return a.EF},initializeSparseMatrixFromMatrixMarket:function(){return a._3},initializeSparseMatrixFromMatrixMarketBuffer:function(){return a.DK},initializeSparseMatrixFromRds:function(){return a.Bp},initializeTSNE:function(){return j},initializeUMAP:function(){return L},integrateCellLabels:function(){return X.Os},integrateLabelledReferences:function(){return X.Qj},labelCells:function(){return X.pG},loadHDF5Dataset:function(){return s.dO},loadLabelledReferenceFromBuffers:function(){return X.tY},logNormCounts:function(){return k.g},maximumThreads:function(){return n.TT},medianSizeFactors:function(){return y.W},mnnCorrect:function(){return Y.F},modelGeneVar:function(){return A.r},perplexityToNeighbors:function(){return G},quickAdtSizeFactors:function(){return _.C},rbind:function(){return f.Ar},readFile:function(){return u.pJ},readRds:function(){return o.p$},realizeFile:function(){return ee.$},removeFile:function(){return u.Yd},runPCA:function(){return E.d},runTSNE:function(){return T},runUMAP:function(){return V},safeFree:function(){return i.ek},scaleByNeighbors:function(){return J.j},scoreMarkers:function(){return K.y},splitRows:function(){return d.vc},subsetBlock:function(){return h.DS},subsetColumns:function(){return d.ZW},subsetRows:function(){return d.O7},terminate:function(){return n.RA},transpose:function(){return v.p4},updateRowIdentities:function(){return l.N},wasmArraySpace:function(){return n.Fx},writeFile:function(){return u.NC}});var n=r(8782),i=r(6635),a=r(8311),s=r(6126),o=r(6663),u=r(489),l=r(8939),c=r(2284),h=r(5644),f=r(5470),d=r(1196),v=r(5219),m=r(6292),p=r(2195),w=r(4902),g=r(2690),b=r(8420),y=r(845),Z=r(9283),_=r(6974),k=r(1184),A=r(4812),x=r(6199),E=r(5159),S=r(7067),O=r(9273),I=r(5671),C=r(3144),R=r(2346),N=r(6033),M=r(3092),F=r(7108),D=new WeakMap,z=new WeakMap,B=new WeakMap,W=function(){function e(t,r,n){(0,I.Z)(this,e),(0,R.Z)(this,D,{writable:!0,value:void 0}),(0,R.Z)(this,z,{writable:!0,value:void 0}),(0,R.Z)(this,B,{writable:!0,value:void 0}),(0,M.Z)(this,D,t),(0,M.Z)(this,z,r),(0,M.Z)(this,B,n)}return(0,C.Z)(e,[{key:"status",get:function(){return(0,N.Z)(this,z)}},{key:"coordinates",get:function(){return(0,N.Z)(this,B)}},{key:"clone",value:function(){var t=this;return F.R((function(e){return(0,N.Z)(t,z).deepcopy()}),e,(0,N.Z)(this,B).clone())}},{key:"numberOfCells",value:function(){return(0,N.Z)(this,z).num_obs()}},{key:"iterations",value:function(){return(0,N.Z)(this,z).iterations()}},{key:"extractCoordinates",value:function(){return i.ab(this.numberOfCells(),(0,N.Z)(this,B).array())}},{key:"free",value:function(){null!==(0,N.Z)(this,z)&&(F.A((0,N.Z)(this,D)),(0,M.Z)(this,z,null)),null!==(0,N.Z)(this,B)&&((0,N.Z)(this,B).free(),(0,M.Z)(this,B,null))}}]),e}();function G(e){return n.RE((function(t){return t.perplexity_to_k(e)}))}function j(e){var t,r,a,s=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},o=s.perplexity,u=void 0===o?30:o,l=s.checkMismatch,c=void 0===l||l,h=s.numberOfThreads,f=void 0===h?null:h,d=i.mV(f);try{var v;if(e instanceof S.ZF){var m=G(u);t=(0,S.wf)(e,m,{numberOfThreads:d}),v=t}else{if(c){var p=G(u);if(p*e.numberOfCells()!=e.size())throw new Error("number of neighbors in 'x' does not match '3 * perplexity'")}v=e}r=i.RJ(2*v.numberOfCells()),n.RE((function(e){return e.randomize_tsne_start(v.numberOfCells(),r.offset,42)})),a=F.R((function(e){return e.initialize_tsne(v.results,u,d)}),W,r)}catch(w){throw i.gd(a),i.gd(r),w}finally{i.gd(t)}return a}function T(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},r=t.maxIterations,i=void 0===r?1e3:r,a=t.runTime,s=void 0===a?null:a;null===s&&(s=-1),n.RE((function(t){return t.run_tsne(e.status,s,i,e.coordinates.offset)}))}var Q=new WeakMap,U=new WeakMap,q=new WeakMap,P=function(){function e(t,r,n){(0,I.Z)(this,e),(0,R.Z)(this,Q,{writable:!0,value:void 0}),(0,R.Z)(this,U,{writable:!0,value:void 0}),(0,R.Z)(this,q,{writable:!0,value:void 0}),(0,M.Z)(this,Q,t),(0,M.Z)(this,U,r),(0,M.Z)(this,q,n)}return(0,C.Z)(e,[{key:"status",get:function(){return(0,N.Z)(this,U)}},{key:"coordinates",get:function(){return(0,N.Z)(this,q)}},{key:"clone",value:function(){var t=this;return F.R((function(e){return(0,N.Z)(t,U).deepcopy()}),e,(0,N.Z)(this,q).clone())}},{key:"numberOfCells",value:function(){return(0,N.Z)(this,U).num_obs()}},{key:"currentEpoch",value:function(){return(0,N.Z)(this,U).epoch()}},{key:"totalEpochs",value:function(){return(0,N.Z)(this,U).num_epochs()}},{key:"extractCoordinates",value:function(){return i.ab(this.numberOfCells(),(0,N.Z)(this,q).array())}},{key:"free",value:function(){null!==(0,N.Z)(this,U)&&(F.A((0,N.Z)(this,Q)),(0,M.Z)(this,U,null)),null!==(0,N.Z)(this,q)&&((0,N.Z)(this,q).free(),(0,M.Z)(this,q,null))}}]),e}();function L(e){var t,r,n,a=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},s=a.neighbors,o=void 0===s?15:s,u=a.epochs,l=void 0===u?500:u,c=a.minDist,h=void 0===c?.01:c,f=a.numberOfThreads,d=void 0===f?null:f,v=i.mV(d);try{var m;e instanceof S.ZF?(t=(0,S.wf)(e,o,{numberOfThreads:v}),m=t):m=e,r=i.RJ(2*m.numberOfCells()),n=F.R((function(e){return e.initialize_umap(m.results,l,h,r.offset,v)}),P,r)}catch(p){throw i.gd(n),i.gd(r),p}finally{i.gd(t)}return n}function V(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},r=t.runTime,i=void 0===r?null:r;null===i&&(i=-1),n.RE((function(t){return t.run_umap(e.status,i,e.coordinates.offset)}))}var H=r(2494),Y=r(5696),J=r(2732),K=r(9249),X=r(3779),$=r(4021),ee=r(3459)},8311:function(e,t,r){"use strict";r.d(t,{xz:function(){return o},el:function(){return u},_3:function(){return l},DK:function(){return h},us:function(){return f},EF:function(){return d},N6:function(){return v},gP:function(){return m},Bp:function(){return p}});var n=r(7108),i=r(8782),a=r(6635),s=r(2306);function o(e,t,r){var i,o,u=arguments.length>3&&void 0!==arguments[3]?arguments[3]:{},l=u.layered,c=void 0===l||l,h=null;try{if((i=a.de(r,null)).length!==e*t)throw new Error("length of 'values' is not consistent with supplied dimensions");(o=n.R((function(r){return r.initialize_sparse_matrix_from_dense_vector(e,t,i.offset,i.constructor.className.replace("Wasm",""),c)}),s.p)).isReorganized()&&(h=o.identities(),o.wipeIdentities())}catch(f){throw a.gd(o),f}finally{a.gd(i)}return{matrix:o,row_ids:h}}function u(e,t,r,i,o){var u,l,c,h,f=arguments.length>5&&void 0!==arguments[5]?arguments[5]:{},d=f.byColumn,v=void 0===d||d,m=f.layered,p=void 0===m||m,w=null;try{if(u=a.de(r,null),l=a.de(i,null),c=a.de(o,null),u.length!=l.length)throw new Error("'values' and 'indices' should have the same length");if(c.length!=(v?t:e)+1)throw new Error("'pointers' does not have an appropriate length");(h=n.R((function(r){return r.initialize_sparse_matrix(e,t,u.length,u.offset,u.constructor.className.replace("Wasm",""),l.offset,l.constructor.className.replace("Wasm",""),c.offset,c.constructor.className.replace("Wasm",""),v,p)}),s.p)).isReorganized()&&(w=h.identities(),h.wipeIdentities())}catch(g){throw a.gd(h),g}finally{a.gd(u),a.gd(l),a.gd(c)}return{matrix:h,row_ids:w}}function l(e){var t,r,i=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},o=i.compressed,u=void 0===o?null:o,l=i.layered,h=void 0===l||l,f=null;try{u=c(u),"string"!==typeof e?(t=a.de(e,"Uint8WasmArray"),r=n.R((function(e){return e.read_matrix_market_from_buffer(t.offset,t.length,u,h)}),s.p)):r=n.R((function(t){return t.read_matrix_market_from_file(e,u,h)}),s.p),r.isReorganized()&&(f=r.identities(),r.wipeIdentities())}catch(d){throw a.gd(r),d}finally{a.gd(t)}return{matrix:r,row_ids:f}}function c(e){return null===e?-1:e?1:0}function h(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},r=t.compressed,n=void 0===r?null:r;return l(e,{compressed:n})}function f(e){var t,r=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},n=r.compressed,s=void 0===n?null:n,o=a.RJ(3),u={};try{s=c(s),"string"!==typeof e?(t=a.de(e,"Uint8WasmArray"),i.RE((function(e){return e.read_matrix_market_header_from_buffer(t.offset,t.length,s,o.offset)}))):i.RE((function(t){return t.read_matrix_market_header_from_file(e,s,o.offset)}));var l=o.array();u.rows=l[0],u.columns=l[1],u.lines=l[2]}finally{a.gd(t),a.gd(o)}return u}function d(e,t){var r,i=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{},o=i.layered,u=void 0===o||o,l=null;try{(r=n.R((function(r){return r.read_hdf5_matrix(e,t,u)}),s.p)).isReorganized()&&(l=r.identities(),r.wipeIdentities())}catch(c){throw a.gd(r),c}return{matrix:r,row_ids:l}}function v(e,t){var r={},n=a.Wf(4);try{i.RE((function(r){return r.extract_hdf5_matrix_details(e,t,n.offset)}));var s=n.array();s[0]>0?r.format="dense":s[1]>0?r.format="csc":r.format="csr",r.rows=s[2],r.columns=s[3]}finally{n.free()}return r}function m(e,t,r){var i,o;try{i=a.de(r,null),o=n.R((function(r){return r.initialize_dense_matrix(e,t,i.offset,i.constructor.className.replace("Wasm",""))}),s.p)}catch(u){throw a.gd(o),u}finally{a.gd(i)}return o}function p(e){var t,r=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},i=r.consume,o=void 0!==i&&i,u=r.layered,l=void 0===u||u,c=null;try{(t=n.R((function(t){return t.initialize_sparse_matrix_from_rds(e.object.$$.ptr,l,o)}),s.p)).isReorganized()&&(c=t.identities(),t.wipeIdentities())}catch(h){throw a.gd(t),h}return{matrix:t,row_ids:c}}},6807:function(e,t,r){"use strict";r.d(t,{H:function(){return i}});var n=r(6635);function i(e,t,r,i){var a,s;try{var o=0,u=!1;if(null!==t){if((a=n.de(t,"Int32WasmArray")).length!=r(e))throw new Error("'block' must be of length equal to the number of cells in 'metrics'");u=!0,o=a.offset}s=i(e,u,o)}catch(l){throw n.gd(s),l}finally{n.gd(a)}return s}},6078:function(e,t,r){"use strict";r.d(t,{$:function(){return i}});r(8782);var n=r(6635);r(6737);function i(e,t,r){var i,a,s=[];try{var o=0,u=0;if(null!=t){o=t.length,u=(a=n.GF(o)).offset;for(var l=a.array(),c=0;c<o;c++){var h=n.de(t[c],"Uint8WasmArray");if(h.length!=e.numberOfRows())throw new Error("length of each array in 'subsets' should be equal to the matrix rows");s.push(h),l[c]=BigInt(h.offset)}}i=r(e.matrix,o,u)}catch(m){throw n.gd(i),m}finally{n.gd(a);for(var f=0,d=s;f<d.length;f++){var v=d[f];n.gd(v)}}return i}},6774:function(e,t,r){"use strict";r.d(t,{b:function(){return a},C:function(){return s}});var n=r(7762),i=r(6635);function a(e,t){var r,i=new TextDecoder,a=[],s=0,o=(0,n.Z)(t);try{for(o.s();!(r=o.n()).done;){var u=r.value,l=e.slice(s,s+u);a.push(i.decode(l)),s+=u}}catch(c){o.e(c)}finally{o.f()}return a}function s(e){var t,r,a,s=(0,n.Z)(e);try{for(s.s();!(a=s.n()).done;){if("string"!=typeof a.value)throw new Error("all entries of 'x' should be strings for a string HDF5 dataset")}}catch(f){s.e(f)}finally{s.f()}try{var o=(r=i.Wf(e.length)).array(),u=0,l=new TextEncoder,c=new Array(e.length);e.forEach((function(e,t){var r=l.encode(e);o[t]=r.length,c[t]=r,u+=r.length}));var h=(t=i.TS(u)).array();u=0,c.forEach((function(e){h.set(e,u),u+=e.length}))}catch(d){throw i.gd(t),i.gd(r),d}return[r,t]}},3779:function(e,t,r){"use strict";r.d(t,{tY:function(){return p},St:function(){return _},pG:function(){return A},Qj:function(){return O},Os:function(){return I}});var n=r(5671),i=r(3144),a=r(2346),s=r(6033),o=r(3092),u=r(7108),l=r(8782),c=r(6635),h=r(2306),f=r(6737),d=new WeakMap,v=new WeakMap,m=function(){function e(t,r){(0,n.Z)(this,e),(0,a.Z)(this,d,{writable:!0,value:void 0}),(0,a.Z)(this,v,{writable:!0,value:void 0}),(0,o.Z)(this,d,t),(0,o.Z)(this,v,r)}return(0,i.Z)(e,[{key:"reference",get:function(){return(0,s.Z)(this,v)}},{key:"numberOfSamples",value:function(){return(0,s.Z)(this,v).num_samples()}},{key:"numberOfFeatures",value:function(){return(0,s.Z)(this,v).num_features()}},{key:"numberOfLabels",value:function(){return(0,s.Z)(this,v).num_labels()}},{key:"free",value:function(){null!==(0,s.Z)(this,v)&&(u.A((0,s.Z)(this,d)),(0,o.Z)(this,v,null))}}]),e}();function p(e,t,r){var n,i,a,s;try{i=c.de(e,"Uint8WasmArray"),a=c.de(t,"Uint8WasmArray"),s=c.de(r,"Uint8WasmArray"),n=u.R((function(e){return e.load_singlepp_reference(s.offset,s.length,a.offset,a.length,i.offset,i.length)}),m)}catch(o){throw c.gd(n),o}finally{c.gd(i),c.gd(a),c.gd(s)}return n}var w=new WeakMap,g=new WeakMap,b=function(){function e(t,r){(0,n.Z)(this,e),(0,a.Z)(this,w,{writable:!0,value:void 0}),(0,a.Z)(this,g,{writable:!0,value:void 0}),(0,o.Z)(this,w,t),(0,o.Z)(this,g,r)}return(0,i.Z)(e,[{key:"reference",get:function(){return(0,s.Z)(this,g)}},{key:"sharedFeatures",value:function(){return(0,s.Z)(this,g).shared_features()}},{key:"free",value:function(){null!==(0,s.Z)(this,g)&&(u.A((0,s.Z)(this,w)),(0,o.Z)(this,g,null))}}]),e}();function y(e,t){var r=t.array(),n={},i=0;return e.forEach((function(e){n[e]=i,r[i]=i,i++})),n}function Z(e,t,r){var n=r.array(),i=Object.keys(t).length;e.forEach((function(e,r){e in t?n[r]=t[e]:(n[r]=i,i++)}))}function _(e,t,r){var n,i,a,s=arguments.length>3&&void 0!==arguments[3]?arguments[3]:{},o=s.top,l=void 0===o?20:o,h=s.numberOfThreads,f=void 0===h?null:h,d=c.mV(f);try{var v=e.length;if(n=c.Wf(v),i=c.Wf(t.numberOfFeatures()),r.length!=i.length)throw new Error("length of 'referenceFeatures' should be equal to the number of features in 'reference'");var m=y(e,n);Z(r,m,i),(a=u.R((function(e){return e.build_singlepp_reference(v,n.offset,t.reference,i.offset,l,d)}),b)).expectedNumberOfFeatures=v}catch(p){throw c.gd(a),p}finally{c.gd(n),c.gd(i)}return a}function k(e,t,r,n,i,a,s){var o,l,d,v=null,m=r instanceof f.do;try{var p,w;if(e instanceof h.p)p=e.matrix;else{if(!(e instanceof f.lt))throw new Error("unknown type for 'x'");if(e.length!==n*i)throw new Error("length of 'x' must be equal to the product of 'numberOfFeatures' and 'numberOfCells'");o=c.de(e,null),p=(l=u.R((function(e){return e.initialize_dense_matrix(n,i,o.offset,"Float64Array")}),h.p)).matrix}if(p.nrow()!=t)throw new Error("number of rows in 'x' should be equal to length of 'features' used to build '"+s+"'");w=m?r.offset:(d=c.Wf(p.ncol())).offset,a(p,w),m||(v=d.slice())}finally{c.gd(o),c.gd(l),c.gd(d)}return v}function A(e,t){var r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{},n=r.buffer,i=void 0===n?null:n,a=r.numberOfFeatures,s=void 0===a?null:a,o=r.numberOfCells,u=void 0===o?null:o,h=r.quantile,f=void 0===h?.8:h,d=r.numberOfThreads,v=void 0===d?null:d,m=c.mV(v),p=function(e,r){l.RE((function(n){return n.run_singlepp(e,t.reference,f,r,m)}))},w=k(e,t.expectedNumberOfFeatures,i,s,u,p,"reference");return null===w&&(w=i.array()),w}var x=new WeakMap,E=new WeakMap,S=function(){function e(t,r){(0,n.Z)(this,e),(0,a.Z)(this,x,{writable:!0,value:void 0}),(0,a.Z)(this,E,{writable:!0,value:void 0}),(0,o.Z)(this,x,t),(0,o.Z)(this,E,r)}return(0,i.Z)(e,[{key:"integrated",get:function(){return(0,s.Z)(this,E)}},{key:"numberOfReferences",value:function(){return(0,s.Z)(this,E).num_references()}},{key:"free",value:function(){null!==(0,s.Z)(this,E)&&(u.A((0,s.Z)(this,x)),(0,o.Z)(this,E,null))}}]),e}();function O(e,t,r,n){var i,a,s,o,l,h=arguments.length>4&&void 0!==arguments[4]?arguments[4]:{},d=h.numberOfThreads,v=void 0===d?null:d,m=c.mV(v),p=t.length;if(r.length!=p)throw new Error("'loaded' and 'referenceFeatures' should be of the same length");if(n.length!=p)throw new Error("'loaded' and 'built' should be of the same length");for(var w=0;w<p;w++)if(t[w].numberOfFeatures()!=r[w].length)throw new Error("length of each 'referenceFeatures' should be equal to the number of features in the corresponding 'loaded'");var g=new Array(p);try{i=c.Wf(e.length);var b=y(e,i),_=(a=c.GF(p)).array();for(w=0;w<p;w++)_[w]=BigInt(t[w].reference.$$.ptr);var k=(s=c.GF(p)).array();for(w=0;w<p;w++){var A=r[w];A instanceof f.do?k[w]=BigInt(A.offset):(g[w]=c.Wf(A.length),Z(A,b,g[w]),k[w]=BigInt(g[w].offset))}var x=(o=c.GF(p)).array();for(w=0;w<p;w++)x[w]=BigInt(n[w].reference.$$.ptr);(l=u.R((function(t){return t.integrate_singlepp_references(e.length,i.offset,p,a.offset,s.offset,o.offset,m)}),S)).expectedNumberOfFeatures=e.length}catch(C){throw c.gd(l),C}finally{c.gd(i),c.gd(a),c.gd(o),c.gd(s);for(var E=0,O=g;E<O.length;E++){var I=O[E];c.gd(I)}}return l}function I(e,t,r){var n,i,a=arguments.length>3&&void 0!==arguments[3]?arguments[3]:{},s=a.buffer,o=void 0===s?null:s,u=a.numberOfFeatures,f=void 0===u?null:u,d=a.numberOfCells,v=void 0===d?null:d,m=a.quantile,p=void 0===m?.8:m,w=a.numberOfThreads,g=void 0===w?null:w,b=r.numberOfReferences();if(t.length!=b)throw new Error("length of 'assigned' should be equal to the number of references in 'integrated'");var y=new Array(b),Z=c.mV(g);try{for(var _=(i=c.GF(b)).array(),A=0;A<t.length;A++){var x=t[A],E=!1;if(e instanceof h.p?x.length!=e.numberOfColumns()&&(E=!0):x.length!=v&&(E=!0),E)throw new Error("length of each element 'assigned' should be equal to number of columns in 'x'");y[A]=c.de(x,"Int32WasmArray"),_[A]=BigInt(y[A].offset)}var S=function(e,t){l.RE((function(n){return n.integrate_singlepp(e,_.offset,r.integrated,p,t,Z)}))};n=k(e,r.expectedNumberOfFeatures,o,f,v,S,"integrated")}finally{c.gd(i);for(var O=0,I=y;O<I.length;O++){var C=I[O];c.gd(C)}}return null===n&&(n=o.array()),n}},1184:function(e,t,r){"use strict";r.d(t,{g:function(){return a}});var n=r(7108),i=r(6635);function a(e){var t,r,a,s=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},o=s.sizeFactors,u=void 0===o?null:o,l=s.block,c=void 0===l?null:l,h=s.allowZeros,f=void 0!==h&&h;try{var d=0,v=!1;if(null!==u){if((t=i.de(u,"Float64WasmArray")).length!=e.numberOfColumns())throw new Error("length of 'sizeFactors' must be equal to number of columns in 'x'");d=t.offset,v=!0}var m=0,p=!1;if(null!==c){if((r=i.de(c,"Int32WasmArray")).length!=e.numberOfColumns())throw new Error("'block' must be of length equal to the number of columns in 'x'");p=!0,m=r.offset}a=n.R((function(t){return t.log_norm_counts(e.matrix,v,d,p,m,f)}),e.constructor)}catch(w){throw i.gd(a),w}finally{i.gd(t),i.gd(r)}return a}},845:function(e,t,r){"use strict";r.d(t,{W:function(){return s}});var n=r(8782),i=r(6635),a=(r(2306),r(6737));function s(e){var t,r,s=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},o=s.center,u=void 0===o||o,l=s.reference,c=void 0===l?null:l,h=s.buffer,f=void 0===h?null:h,d=s.priorCount,v=void 0===d?10:d,m=s.numberOfThreads,p=void 0===m?null:m,w=i.mV(p);try{if(f instanceof a.lt){if(f.length!==e.numberOfColumns())throw new Error("length of 'buffer' must be equal to the number of columns in 'x'")}else t=i.RJ(e.numberOfColumns()),f=t;var g=null!==c,b=0;if(g){if((r=i.de(c,"Float64WasmArray")).length!==e.numberOfRows())throw new Error("length of 'reference' must be equal to the number of rows in 'x'");b=r.offset}n.RE((function(t){return t.median_size_factors(e.matrix,g,b,u,v,f.offset,w)}))}catch(y){throw i.gd(t),y}finally{i.gd(r)}return f}},5696:function(e,t,r){"use strict";r.d(t,{F:function(){return s}});var n=r(6635),i=r(5159),a=r(8782);function s(e,t){var r,s,o,u=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{},l=u.buffer,c=void 0===l?null:l,h=u.numberOfDims,f=void 0===h?null:h,d=u.numberOfCells,v=void 0===d?null:d,m=u.k,p=void 0===m?15:m,w=u.numberOfMADs,g=void 0===w?3:w,b=u.robustIterations,y=void 0===b?2:b,Z=u.robustTrim,_=void 0===Z?.25:Z,k=u.referencePolicy,A=void 0===k?"max-size":k,x=u.approximate,E=void 0===x||x,S=u.numberOfThreads,O=void 0===S?null:S,I=n.mV(O);try{if(e instanceof i.R)f=e.numberOfPCs(),v=e.numberOfCells(),e=e.principalComponents({copy:"view"});else{if(null===f||null===v||f*v!==e.length)throw new Error("length of 'x' must be equal to the product of 'numberOfDims' and 'numberOfCells'");s=n.de(e,"Float64WasmArray"),e=s}if(null==c)r=n.RJ(v*f),c=r;else if(c.length!==e.length)throw new Error("length of 'buffer' must be equal to the product of the number of dimensions and cells");if((o=n.de(t,"Int32WasmArray")).length!=v)throw new Error("'block' must be of length equal to the number of cells in 'x'");a.RE((function(t){return t.mnn_correct(f,v,e.offset,o.offset,c.offset,p,g,y,_,A,E,I)}))}catch(C){throw n.gd(r),C}finally{n.gd(s)}return c}},4812:function(e,t,r){"use strict";r.d(t,{_:function(){return f},r:function(){return d}});var n=r(5671),i=r(3144),a=r(2346),s=r(6033),o=r(3092),u=r(7108),l=r(6635),c=new WeakMap,h=new WeakMap,f=function(){function e(t,r){(0,n.Z)(this,e),(0,a.Z)(this,c,{writable:!0,value:void 0}),(0,a.Z)(this,h,{writable:!0,value:void 0}),(0,o.Z)(this,c,t),(0,o.Z)(this,h,r)}return(0,i.Z)(e,[{key:"means",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t=e.block,r=void 0===t?-1:t,n=e.copy,i=void 0===n||n;return l.Yj((0,s.Z)(this,h).means(r),i)}},{key:"variances",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t=e.block,r=void 0===t?-1:t,n=e.copy,i=void 0===n||n;return l.Yj((0,s.Z)(this,h).variances(r),i)}},{key:"fitted",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t=e.block,r=void 0===t?-1:t,n=e.copy,i=void 0===n||n;return l.Yj((0,s.Z)(this,h).fitted(r),i)}},{key:"residuals",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t=e.block,r=void 0===t?-1:t,n=e.copy,i=void 0===n||n;return l.Yj((0,s.Z)(this,h).residuals(r),i)}},{key:"numberOfBlocks",value:function(){return(0,s.Z)(this,h).num_blocks()}},{key:"free",value:function(){null!==(0,s.Z)(this,h)&&(u.A((0,s.Z)(this,c)),(0,o.Z)(this,h,null))}}]),e}();function d(e){var t,r,n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},i=n.block,a=void 0===i?null:i,s=n.span,o=void 0===s?.3:s,c=n.numberOfThreads,h=void 0===c?null:c,d=l.mV(h);try{var v=0,m=!1;if(null!==a){if((t=l.de(a,"Int32WasmArray")).length!=e.numberOfColumns())throw new Error("'block' must be of length equal to the number of columns in 'x'");m=!0,v=t.offset}r=u.R((function(t){return t.model_gene_var(e.matrix,m,v,o,d)}),f)}catch(p){throw l.gd(r),p}finally{l.gd(t)}return r}},8939:function(e,t,r){"use strict";r.d(t,{N:function(){return s}});var n=r(3324),i=r(7762),a=r(2306);function s(e,t){if(e instanceof a.p)throw new Error("supplying a ScranMatrix is deprecated");var r,s=e;if(null===s)r=t.length;else if(r=e.length,t.length!=r)throw new Error("length of 'x' should be the same as length of 'old'");var o=!0;if(null!==s){var u,l=(0,i.Z)(s.entries());try{for(l.s();!(u=l.n()).done;){var c=(0,n.Z)(u.value,2),h=c[0],f=c[1];if(t[h]!=f){o=!1;break}}}catch(_){l.e(_)}finally{l.f()}}else{var d,v=(0,i.Z)(t.entries());try{for(v.s();!(d=v.n()).done;){var m=(0,n.Z)(d.value,2),p=m[0];if(m[1]!=p){o=!1;break}}}catch(_){v.e(_)}finally{v.f()}}if(o)return null;var w={};t.forEach((function(e,t){w[e]=t}));var g=new Int32Array(r);if(null!==s)for(var b=0;b<s.length;b++){var y=s[b];if(!(y in w))throw new Error("mismatch in row identities between 'x' and 'old'");g[b]=w[y]}else for(var Z=0;Z<r;Z++){if(!(Z in w))throw new Error("mismatch in row identities between 'x' and 'old'");g[Z]=w[Z]}return g}},6974:function(e,t,r){"use strict";r.d(t,{C:function(){return u}});var n=r(2494),i=r(1184),a=r(9283),s=r(5159),o=r(6635);function u(e){var t,r,u,l,c=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},h=c.numberOfClusters,f=void 0===h?20:h,d=c.numberOfPCs,v=void 0===d?25:d,m=c.totals,p=void 0===m?null:m,w=c.block,g=void 0===w?null:w,b=c.buffer,y=void 0===b?null:b,Z=c.numberOfThreads,_=void 0===Z?null:Z;try{t=(0,i.g)(e,{sizeFactors:p,block:g}),r=(0,s.d)(t,{numberOfPCs:Math.min(t.numberOfRows()-1,v),numberOfThreads:_})}finally{o.gd(t)}try{u=(0,n.e)(r,f,{numberOfThreads:_})}finally{o.gd(r)}try{if(null===y)y=l=o.RJ(e.numberOfColumns());else if(y.length!==e.numberOfColumns())throw new Error("length of 'buffer' should be equal to the number of columns in 'x'");(0,a.S)(e,u.clusters({copy:"view"}),{buffer:y,numberOfThreads:_})}catch(k){throw o.gd(l),k}finally{o.gd(u)}return y}},6663:function(e,t,r){"use strict";r.d(t,{xL:function(){return v},qu:function(){return m},D6:function(){return p},Ox:function(){return w},k1:function(){return g},II:function(){return b},SV:function(){return y},BA:function(){return Z},aT:function(){return _},o5:function(){return E},p$:function(){return S}});var n=r(2346),i=r(6033),a=r(3092),s=r(136),o=r(9388),u=r(5671),l=r(3144),c=r(6635),h=r(8782),f=r(7108),d=r(6774),v=function(){function e(t,r,n){(0,u.Z)(this,e),this.id=t,this.object=r,this.parent=n}return(0,l.Z)(e,[{key:"type",value:function(){return this.object.type()}},{key:"free",value:function(){null!==this.object&&(f.A(this.id),this.object=null)}}]),e}(),m=function(e){(0,s.Z)(r,e);var t=(0,o.Z)(r);function r(e,n,i){return(0,u.Z)(this,r),t.call(this,e,n,i)}return(0,l.Z)(r,[{key:"length",value:function(){return this.object.size()}},{key:"attributeNames",value:function(){var e=this;return h.RE((function(t){e.object.fill_attribute_names();var r=e.object.attribute_names_buffer(),n=e.object.attribute_names_length();return d.b(r,n)}))}},{key:"findAttribute",value:function(e){var t=this;return h.RE((function(r){return t.object.find_attribute(e)}))}},{key:"attribute",value:function(e){var t=this;return k("number"==typeof e?function(r){return t.object.load_attribute_by_index(e)}:function(r){return t.object.load_attribute_by_name(e)},this.parent)}}]),r}(v),p=function(e){(0,s.Z)(r,e);var t=(0,o.Z)(r);function r(e,n,i){return(0,u.Z)(this,r),t.call(this,e,n,i)}return(0,l.Z)(r,[{key:"values",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t=e.copy,r=void 0===t||t;return c.Yj(this.object.numeric_vector(),r)}}]),r}(m),w=function(e){(0,s.Z)(r,e);var t=(0,o.Z)(r);function r(e,n,i){return(0,u.Z)(this,r),t.call(this,e,n,i)}return(0,l.Z)(r,[{key:"values",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t=e.copy,r=void 0===t||t;return c.Yj(this.object.numeric_vector(),r)}}]),r}(m),g=function(e){(0,s.Z)(r,e);var t=(0,o.Z)(r);function r(e,n,i){return(0,u.Z)(this,r),t.call(this,e,n,i)}return(0,l.Z)(r,[{key:"values",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t=e.copy,r=void 0===t||t;return c.Yj(this.object.numeric_vector(),r)}}]),r}(m),b=function(e){(0,s.Z)(r,e);var t=(0,o.Z)(r);function r(e,n,i){return(0,u.Z)(this,r),t.call(this,e,n,i)}return(0,l.Z)(r,[{key:"values",value:function(){var e=this;return h.RE((function(t){e.object.fill_string_vector();var r=e.object.string_vector_buffer(),n=e.object.string_vector_length();return d.b(r,n)}))}}]),r}(m),y=function(e){(0,s.Z)(r,e);var t=(0,o.Z)(r);function r(e,n,i){return(0,u.Z)(this,r),t.call(this,e,n,i)}return(0,l.Z)(r,[{key:"load",value:function(e){var t=this;return k((function(r){return t.object.load_list_element(e)}),this.parent)}}]),r}(m),Z=function(e){(0,s.Z)(r,e);var t=(0,o.Z)(r);function r(e,n,i){return(0,u.Z)(this,r),t.call(this,e,n,i)}return(0,l.Z)(r,[{key:"className",value:function(){var e=this;return h.RE((function(t){return e.object.class_name()}))}},{key:"packageName",value:function(){var e=this;return h.RE((function(t){return e.object.package_name()}))}},{key:"attributeNames",value:function(){var e=this;return h.RE((function(t){e.object.fill_attribute_names();var r=e.object.attribute_names_buffer(),n=e.object.attribute_names_length();return d.b(r,n)}))}},{key:"findAttribute",value:function(e){var t=this;return h.RE((function(r){return t.object.find_attribute(e)}))}},{key:"attribute",value:function(e){var t=this;return k("number"==typeof e?function(r){return t.object.load_attribute_by_index(e)}:function(r){return t.object.load_attribute_by_name(e)},this.parent)}}]),r}(v),_=function(e){(0,s.Z)(r,e);var t=(0,o.Z)(r);function r(e,n,i){return(0,u.Z)(this,r),t.call(this,e,n,i)}return(0,l.Z)(r)}(m);function k(e,t){var r,n=h.RE(e),i=null;try{i=n.type()}catch(a){throw n.delete(),a}return r="integer"==i?p:"double"==i?g:"boolean"==i?w:"string"==i?b:"vector"==i?y:"S4"==i?Z:"null"==i?_:v,f.R((function(e){return n}),r,t)}var A=new WeakMap,x=new WeakMap,E=function(){function e(t,r){(0,u.Z)(this,e),(0,n.Z)(this,A,{writable:!0,value:void 0}),(0,n.Z)(this,x,{writable:!0,value:void 0}),(0,a.Z)(this,A,t),(0,a.Z)(this,x,r)}return(0,l.Z)(e,[{key:"formatVersion",value:function(){return(0,i.Z)(this,x).format_version()}},{key:"writerVersion",value:function(){var e=(0,i.Z)(this,x).writer_version();return String(e[0])+"."+String(e[1])+"."+String(e[2])}},{key:"readerVersion",value:function(){var e=(0,i.Z)(this,x).reader_version();return String(e[0])+"."+String(e[1])+"."+String(e[2])}},{key:"value",value:function(){var e=this;return k((function(t){return(0,i.Z)(e,x).load()}),this)}},{key:"free",value:function(){null!==(0,i.Z)(this,x)&&(f.A((0,i.Z)(this,A)),(0,a.Z)(this,x,null))}}]),e}();function S(e){var t,r;try{"string"==typeof e?r=f.R((function(t){return t.parse_rds_from_file(e)}),E):(t=c.de(e,"Uint8WasmArray"),r=f.R((function(e){return e.parse_rds_from_buffer(t.offset,t.length)}),E))}finally{c.gd(t)}return r}},3459:function(e,t,r){"use strict";r.d(t,{_:function(){return s},$:function(){return o}});var n=r(489);function i(e,t){var r;do{r=e+String(Number(new Date))+"_"+String(Math.round(1e4*Math.random()))+t}while(n.xW(r));return r}function a(e){throw new Error("cannot access the file system in a browser context")}function s(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t=e.extension,r=void 0===t?"":t;return i("temp_",r)}function o(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},r=t.extension,i=void 0===r?"":r;if("string"==typeof e)return a();var o=s({extension:i});return n.NC(o,e),{path:o,flush:function(){return n.Yd(o)}}}},5159:function(e,t,r){"use strict";r.d(t,{R:function(){return f},d:function(){return d}});var n=r(5671),i=r(3144),a=r(2346),s=r(6033),o=r(3092),u=r(7108),l=r(6635),c=new WeakMap,h=new WeakMap,f=function(){function e(t,r){(0,n.Z)(this,e),(0,a.Z)(this,c,{writable:!0,value:void 0}),(0,a.Z)(this,h,{writable:!0,value:void 0}),(0,o.Z)(this,c,t),(0,o.Z)(this,h,r)}return(0,i.Z)(e,[{key:"principalComponents",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t=e.copy,r=void 0===t||t;return l.Yj((0,s.Z)(this,h).pcs(),r)}},{key:"varianceExplained",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t=e.copy,r=void 0===t||t;return l.Yj((0,s.Z)(this,h).variance_explained(),r)}},{key:"totalVariance",value:function(){return(0,s.Z)(this,h).total_variance()}},{key:"numberOfPCs",value:function(){return(0,s.Z)(this,h).num_pcs()}},{key:"numberOfCells",value:function(){return this.principalComponents({copy:!1}).length/this.numberOfPCs()}},{key:"free",value:function(){null!==(0,s.Z)(this,h)&&(u.A((0,s.Z)(this,c)),(0,o.Z)(this,h,null))}}]),e}();function d(e){var t,r,n,i=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},a=i.features,s=void 0===a?null:a,o=i.numberOfPCs,c=void 0===o?25:o,h=i.scale,d=void 0!==h&&h,v=i.block,m=void 0===v?null:v,p=i.blockMethod,w=void 0===p?"regress":p,g=i.numberOfThreads,b=void 0===g?null:g;l.c2("blockMethod",w,["none","regress","weight","block"]);var y=l.mV(b);try{var Z=!1,_=0;if(null!==s){if((t=l.de(s,"Uint8WasmArray")).length!=e.numberOfRows())throw new Error("length of 'features' should be equal to number of rows in 'x'");Z=!0,_=t.offset}if(c=Math.min(c,e.numberOfRows()-1,e.numberOfColumns()-1),null===m||"none"==w)n=u.R((function(t){return t.run_pca(e.matrix,c,Z,_,d,y)}),f);else{if((r=l.de(m,"Int32WasmArray")).length!=e.numberOfColumns())throw new Error("length of 'block' should be equal to the number of columns in 'x'");if("regress"==w||"block"==w)n=u.R((function(t){return t.run_blocked_pca(e.matrix,c,Z,_,d,r.offset,y)}),f);else{if("weight"!=w)throw new Error("unknown value '"+w+"' for 'blockMethod='");n=u.R((function(t){return t.run_multibatch_pca(e.matrix,c,Z,_,d,r.offset,y)}),f)}}}catch(k){throw l.gd(n),k}finally{l.gd(t),l.gd(r)}return n}},2732:function(e,t,r){"use strict";r.d(t,{j:function(){return a}});var n=r(8782),i=r(6635);r(7067);function a(e,t){var r,a,s,o,u,l=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{},c=l.neighbors,h=void 0===c?20:c,f=l.indices,d=void 0===f?null:f,v=l.buffer,m=void 0===v?null:v,p=l.approximate,w=void 0===p||p,g=l.weights,b=void 0===g?null:g,y=l.numberOfThreads,Z=void 0===y?null:y,_=e.length,k=i.mV(Z),A=[];try{for(var x=(r=i.GF(_)).array(),E=0;E<_;E++)x[E]=BigInt(e[E].offset);var S=0,O=!1;if(null!==b){if(O=!0,(o=i.de(b,"Float64WasmArray")).length!=_)throw new Error("length of 'weights' should be equal to the number of embeddings");S=o.offset}var I=function(e){var r=e*t;if(null===m)u=i.RJ(r),m=u;else if(r!==m.length)throw new Error("length of 'buffer' should be equal to the product of 'numberOfCells' and the total number of dimensions")};if(null!==d){if(_!==d.length)throw new Error("'indices' and 'embeddings' should have the same length");var C=(a=i.GF(_)).array(),R=0;for(E=0;E<_;E++){var N=d[E];if(t!=N.numberOfCells())throw new Error("each element of 'indices' should have the same number of cells as 'numberOfCells'");if(e[E].length!=N.numberOfCells()*N.numberOfDims())throw new Error("length of arrays in 'embeddings' should equal the length of arrays used to build 'indices'");C[E]=BigInt(d[E].index.$$.ptr),R+=d[E].numberOfDims()}I(R),n.RE((function(e){return e.scale_by_neighbors_indices(t,_,r.offset,a.offset,m.offset,h,O,S,k)}))}else{var M=(s=i.Wf(_)).array(),F=0;for(E=0;E<_;E++){var D=e[E].length;if(M[E]=Math.floor(D/t),t*M[E]!==D)throw new Error("length of arrays in 'embeddings' should be a multiple of 'numberOfCells'");F+=M[E]}I(F),n.RE((function(e){return e.scale_by_neighbors_matrices(t,_,s.offset,r.offset,m.offset,h,O,S,w,k)}))}}catch(G){throw i.gd(u),G}finally{for(var z=0,B=A;z<B.length;z++){var W=B[z];W.free()}i.gd(r),i.gd(a),i.gd(o),i.gd(s)}return m}},9249:function(e,t,r){"use strict";r.d(t,{O:function(){return f},y:function(){return d}});var n=r(5671),i=r(3144),a=r(2346),s=r(6033),o=r(3092),u=r(7108),l=r(6635),c=new WeakMap,h=new WeakMap,f=function(){function e(t,r){(0,n.Z)(this,e),(0,a.Z)(this,c,{writable:!0,value:void 0}),(0,a.Z)(this,h,{writable:!0,value:void 0}),(0,o.Z)(this,c,t),(0,o.Z)(this,h,r)}return(0,i.Z)(e,[{key:"numberOfBlocks",value:function(){return(0,s.Z)(this,h).num_blocks()}},{key:"numberOfGroups",value:function(){return(0,s.Z)(this,h).num_groups()}},{key:"means",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},r=t.block,n=void 0===r?-1:r,i=t.copy,a=void 0===i||i;return l.Yj((0,s.Z)(this,h).means(e,n),a)}},{key:"detected",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},r=t.block,n=void 0===r?-1:r,i=t.copy,a=void 0===i||i;return l.Yj((0,s.Z)(this,h).detected(e,n),a)}},{key:"cohen",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},r=t.summary,n=void 0===r?1:r,i=t.copy,a=void 0===i||i;return l.Yj((0,s.Z)(this,h).cohen(e,n),a)}},{key:"auc",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},r=t.summary,n=void 0===r?1:r,i=t.copy,a=void 0===i||i;return l.Yj((0,s.Z)(this,h).auc(e,n),a)}},{key:"lfc",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},r=t.summary,n=void 0===r?1:r,i=t.copy,a=void 0===i||i;return l.Yj((0,s.Z)(this,h).lfc(e,n),a)}},{key:"deltaDetected",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},r=t.summary,n=void 0===r?1:r,i=t.copy,a=void 0===i||i;return l.Yj((0,s.Z)(this,h).delta_detected(e,n),a)}},{key:"free",value:function(){null!==(0,s.Z)(this,h)&&(u.A((0,s.Z)(this,c)),(0,o.Z)(this,h,null))}}]),e}();function d(e,t){var r,n,i,a=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{},s=a.block,o=void 0===s?null:s,c=a.numberOfThreads,h=void 0===c?null:c,d=l.mV(h);try{if((i=l.de(t,"Int32WasmArray")).length!=e.numberOfColumns())throw new Error("length of 'groups' should be equal to number of columns in 'x'");var v=0,m=!1;if(null!==o){if((n=l.de(o,"Int32WasmArray")).length!=e.numberOfColumns())throw new Error("'block' must be of length equal to the number of columns in 'x'");m=!0,v=n.offset}r=u.R((function(t){return t.score_markers(e.matrix,i.offset,m,v,d)}),f)}catch(p){throw l.gd(r),p}finally{l.gd(n),l.gd(i)}return r}},1196:function(e,t,r){"use strict";r.d(t,{O7:function(){return s},ZW:function(){return o},vc:function(){return u}});var n=r(6635),i=r(8782),a=r(4021);function s(e,t){var r,a,s,o=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{},u=o.inPlace,l=void 0!==u&&u;try{l?a=e:(r=e.clone(),a=r),s=n.de(t,"Int32WasmArray"),i.RE((function(e){return e.row_subset(a.matrix,s.offset,s.length)}))}catch(c){throw n.gd(r),c}finally{n.gd(s)}return a}function o(e,t){var r,a,s,o=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{},u=o.inPlace,l=void 0!==u&&u;try{l?a=e:(r=e.clone(),a=r),s=n.de(t,"Int32WasmArray"),i.RE((function(e){return e.column_subset(a.matrix,s.offset,s.length)}))}catch(c){throw n.gd(r),c}finally{n.gd(s)}return a}function u(e,t){var r,n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{},i=n.singleNull,o=void 0!==i&&i,u=n.createMultiMatrix,l=void 0!==u&&u,c={},h=Object.keys(t);if(1==h.length){var f=t[h[0]],d=f.length==e.numberOfRows();if(d)for(var v=0;v<f.length;v++)if(v!=f[v]){d=!1;break}if(d)return o?null:(c[h[0]]=e.clone(),c)}try{for(var m=0,p=h;m<p.length;m++){var w=p[m];c[w]=s(e,t[w])}l&&(r=new a.V({store:c}))}catch(Z){for(var g=0,b=Object.values(c);g<b.length;g++){var y=b[g];y.free()}throw Z}return l?r:c}},6635:function(e,t,r){"use strict";r.d(t,{TS:function(){return a},Wf:function(){return s},GF:function(){return o},RJ:function(){return u},de:function(){return l},mV:function(){return c},gd:function(){return h},ek:function(){return f},ab:function(){return d},Yj:function(){return v},c2:function(){return m}});var n=r(8782),i=r(6737);function a(e){return i.TS((0,n.Fx)(),e)}function s(e){return i.Wf((0,n.Fx)(),e)}function o(e){return i.GF((0,n.Fx)(),e)}function u(e){return i.RJ((0,n.Fx)(),e)}function l(e,t){if(e instanceof i.PQ){if(null!==t&&t!=e.constructor.className)throw new Error("expected '"+t+"', got '"+e.constructor.className+"'");return e.space===(0,n.Fx)()?null===e.owner?e.view():e:e.clone((0,n.Fx)())}return null!==t?i.Zv((0,n.Fx)(),e,i.rr(t)):i.Zv((0,n.Fx)(),e)}function c(e){return null==e?(0,n.TT)():e}function h(e){if("undefined"!=typeof e&&null!=e)return e.free()}function f(e){return h(e)}function d(e,t){for(var r=new Float64Array(e),n=new Float64Array(e),i=0;i<e;i++)r[i]=t[2*i],n[i]=t[2*i+1];return{x:r,y:n}}function v(e,t){if("view"===t){if(e.buffer!==(0,n.f3)())throw new Error('cannot use copy = "view" for non-Wasm TypedArrays');var r=e.constructor.name.replace("Array","WasmArray");return i.dt((0,n.Fx)(),e.length,e.byteOffset,i.rr(r))}return t?e.slice():e}function m(e,t,r){if(-1==r.indexOf(t))throw new Error("'"+e+"=' should be one of '"+r.join("', '")+"'")}},8782:function(e,t,r){"use strict";r.d(t,{j2:function(){return u},TT:function(){return c},RE:function(){return h},f3:function(){return f},Fx:function(){return d},RA:function(){return v},M1:function(){return m}});var n=r(5861),i=r(7757),a=r(8308),s=r(6737),o=(r(5941),{});function u(){return l.apply(this,arguments)}function l(){return l=(0,n.Z)(i.mark((function e(){var t,r,n,u,l,c,h=arguments;return i.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(t=h.length>0&&void 0!==h[0]?h[0]:{},r=t.numberOfThreads,n=void 0===r?4:r,u=t.localFile,l=void 0!==u&&u,!("module"in o)){e.next=3;break}return e.abrupt("return",!1);case 3:return c={scran_custom_nthreads:n},l&&(c.locateFile=function(e){return"file:///home/runner/work/kana/kana/node_modules/scran.js/browser/wasm.js".substring(7)+"/../wasm/"+e}),e.next=7,(0,a.default)(c);case 7:return o.module=e.sent,o.space=(0,s.z2)(o.module),e.abrupt("return",!0);case 10:case"end":return e.stop()}}),e)}))),l.apply(this,arguments)}function c(){return o.module.scran_custom_nthreads}function h(e){if(!("module"in o))throw new Error("Wasm module needs to be initialized via 'initialize()'");var t;try{t=e(o.module)}catch(r){throw"number"==typeof r?new Error(o.module.get_error_message(r)):r}return t}function f(){if(!("module"in o))throw new Error("Wasm module needs to be initialized via 'initialize()'");return o.module.wasmMemory.buffer}function d(){return o.space}function v(){o.module.PThread.terminateAllThreads(),delete o.module}function m(){return f().byteLength}},2905:function(e,t,r){"use strict";r.d(t,{P:function(){return m}});var n,i=r(5671),a=r(3144),s=r(2346),o=r(6033),u=r(3092),l=r(2813),c=new WeakMap,h=new WeakMap,f=new WeakMap,d=new WeakMap,v=new WeakMap;n=Symbol.iterator;var m=function(){function e(t,r,n,a,o){(0,i.Z)(this,e),(0,s.Z)(this,c,{writable:!0,value:void 0}),(0,s.Z)(this,h,{writable:!0,value:void 0}),(0,s.Z)(this,f,{writable:!0,value:void 0}),(0,s.Z)(this,d,{writable:!0,value:void 0}),(0,s.Z)(this,v,{writable:!0,value:void 0}),(0,u.Z)(this,c,t),(0,u.Z)(this,h,r),(0,u.Z)(this,f,n),(0,u.Z)(this,d,a),(0,u.Z)(this,v,o)}return(0,a.Z)(e,[{key:"space",get:function(){return(0,o.Z)(this,c)}},{key:"id",get:function(){return(0,o.Z)(this,h)}},{key:"offset",get:function(){return(0,o.Z)(this,d)}},{key:"byteOffset",get:function(){return(0,o.Z)(this,d)}},{key:"buffer",get:function(){return(0,l.f3)((0,o.Z)(this,c))}},{key:"byteLength",get:function(){return this.length*this.constructor.valueSize}},{key:"length",get:function(){return(0,o.Z)(this,f)}},{key:"owner",get:function(){return(0,o.Z)(this,v)}},{key:"fill",value:function(e,t,r){var n=this.array();return n.fill.apply(n,arguments),n}},{key:"set",value:function(e,t){var r;(r=this.array()).set.apply(r,arguments)}},{key:"slice",value:function(e,t){var r;return(r=this.array()).slice.apply(r,arguments)}},{key:"clone",value:function(e){"undefined"===typeof e&&(e=(0,o.Z)(this,c));var t=(0,l.TK)(e,(0,o.Z)(this,f),this.constructor);return t.set(this.array()),t}},{key:"view",value:function(e,t){"undefined"===typeof e&&(e=0),"undefined"===typeof t&&(t=(0,o.Z)(this,f));var r=t-e,n=(0,o.Z)(this,v);null===n&&(n=this);var i=e*this.constructor.valueSize;return new this.constructor((0,o.Z)(this,c),-1,r,(0,o.Z)(this,d)+i,n)}},{key:"free",value:function(){null===(0,o.Z)(this,v)&&null!==(0,o.Z)(this,d)&&((0,l.Ar)((0,o.Z)(this,c),(0,o.Z)(this,h)),(0,u.Z)(this,d,null))}},{key:n,value:function(){return this.values()}},{key:"values",value:function(){return this.array().values()}},{key:"keys",value:function(){return this.array().keys()}},{key:"at",value:function(e){return this.array().at(e)}},{key:"forEach",value:function(e,t){var r;(r=this.array()).forEach.apply(r,arguments)}},{key:"filter",value:function(e,t){var r;return(r=this.array()).filter.apply(r,arguments)}},{key:"map",value:function(e,t){var r;return(r=this.array()).map.apply(r,arguments)}},{key:"subarray",value:function(e,t){return this.array().subarray(e,t)}},{key:"every",value:function(e,t){var r;return(r=this.array()).every.apply(r,arguments)}},{key:"some",value:function(e,t){var r;return(r=this.array()).some.apply(r,arguments)}},{key:"reduce",value:function(e,t){var r;return(r=this.array()).reduce.apply(r,arguments)}},{key:"reduceRight",value:function(e,t){var r;return(r=this.array()).reduceRight.apply(r,arguments)}},{key:"sort",value:function(e){return this.array().sort(e)}},{key:"reverse",value:function(){return this.array().reverse()}}]),e}()},8383:function(e,t,r){"use strict";r.d(t,{yh:function(){return c},do:function(){return m},g1:function(){return p},lt:function(){return b},rr:function(){return Z}});var n=r(5671),i=r(3144),a=r(136),s=r(9388),o=r(4942),u=r(2813),l=r(2905),c=function(e){(0,a.Z)(r,e);var t=(0,s.Z)(r);function r(){return(0,n.Z)(this,r),t.apply(this,arguments)}return(0,i.Z)(r,[{key:"array",value:function(){return new Uint8Array((0,u.f3)(this.space),this.offset,this.length)}}]),r}(l.P);(0,o.Z)(c,"className","Uint8WasmArray"),(0,o.Z)(c,"valueSize",1);var h=function(e){(0,a.Z)(r,e);var t=(0,s.Z)(r);function r(){return(0,n.Z)(this,r),t.apply(this,arguments)}return(0,i.Z)(r,[{key:"array",value:function(){return new Int8Array((0,u.f3)(this.space),this.offset,this.length)}}]),r}(l.P);(0,o.Z)(h,"className","Int8WasmArray"),(0,o.Z)(h,"valueSize",1);var f=function(e){(0,a.Z)(r,e);var t=(0,s.Z)(r);function r(){return(0,n.Z)(this,r),t.apply(this,arguments)}return(0,i.Z)(r,[{key:"array",value:function(){return new Uint16Array((0,u.f3)(this.space),this.offset,this.length)}}]),r}(l.P);(0,o.Z)(f,"className","Uint16WasmArray"),(0,o.Z)(f,"valueSize",2);var d=function(e){(0,a.Z)(r,e);var t=(0,s.Z)(r);function r(){return(0,n.Z)(this,r),t.apply(this,arguments)}return(0,i.Z)(r,[{key:"array",value:function(){return new Int16Array((0,u.f3)(this.space),this.offset,this.length)}}]),r}(l.P);(0,o.Z)(d,"className","Int16WasmArray"),(0,o.Z)(d,"valueSize",2);var v=function(e){(0,a.Z)(r,e);var t=(0,s.Z)(r);function r(){return(0,n.Z)(this,r),t.apply(this,arguments)}return(0,i.Z)(r,[{key:"array",value:function(){return new Uint32Array((0,u.f3)(this.space),this.offset,this.length)}}]),r}(l.P);(0,o.Z)(v,"className","Uint32WasmArray"),(0,o.Z)(v,"valueSize",4);var m=function(e){(0,a.Z)(r,e);var t=(0,s.Z)(r);function r(){return(0,n.Z)(this,r),t.apply(this,arguments)}return(0,i.Z)(r,[{key:"array",value:function(){return new Int32Array((0,u.f3)(this.space),this.offset,this.length)}}]),r}(l.P);(0,o.Z)(m,"className","Int32WasmArray"),(0,o.Z)(m,"valueSize",4);var p=function(e){(0,a.Z)(r,e);var t=(0,s.Z)(r);function r(){return(0,n.Z)(this,r),t.apply(this,arguments)}return(0,i.Z)(r,[{key:"array",value:function(){return new BigUint64Array((0,u.f3)(this.space),this.offset,this.length)}}]),r}(l.P);(0,o.Z)(p,"className","BigUint64WasmArray"),(0,o.Z)(p,"valueSize",8);var w=function(e){(0,a.Z)(r,e);var t=(0,s.Z)(r);function r(){return(0,n.Z)(this,r),t.apply(this,arguments)}return(0,i.Z)(r,[{key:"array",value:function(){return new BigInt64Array((0,u.f3)(this.space),this.offset,this.length)}}]),r}(l.P);(0,o.Z)(w,"className","BigInt64WasmArray"),(0,o.Z)(w,"valueSize",8);var g=function(e){(0,a.Z)(r,e);var t=(0,s.Z)(r);function r(){return(0,n.Z)(this,r),t.apply(this,arguments)}return(0,i.Z)(r,[{key:"array",value:function(){return new Float32Array((0,u.f3)(this.space),this.offset,this.length)}}]),r}(l.P);(0,o.Z)(g,"className","Float32WasmArray"),(0,o.Z)(g,"valueSize",4);var b=function(e){(0,a.Z)(r,e);var t=(0,s.Z)(r);function r(){return(0,n.Z)(this,r),t.apply(this,arguments)}return(0,i.Z)(r,[{key:"array",value:function(){return new Float64Array((0,u.f3)(this.space),this.offset,this.length)}}]),r}(l.P);(0,o.Z)(b,"className","Float64WasmArray"),(0,o.Z)(b,"valueSize",8);var y={Uint8WasmArray:c,Int8WasmArray:h,Uint16WasmArray:f,Int16WasmArray:d,Uint32WasmArray:v,Int32WasmArray:m,BigUint64WasmArray:p,BigInt64WasmArray:w,Float32WasmArray:g,Float64WasmArray:b};function Z(e){if(!(e in y))throw new Error("unknown WasmArray class '"+e+"'");return y[e]}},6737:function(e,t,r){"use strict";r.d(t,{lt:function(){return i.lt},do:function(){return i.do},PQ:function(){return n.P},Zv:function(){return h.Zv},GF:function(){return l},RJ:function(){return c},Wf:function(){return u},TS:function(){return o},dt:function(){return f},z2:function(){return a.z2},rr:function(){return i.rr}});var n=r(2905),i=r(8383),a=r(2813);function s(e,t,r){return(0,a.TK)(e,t,r)}function o(e,t){return s(e,t,i.yh)}function u(e,t){return s(e,t,i.do)}function l(e,t){return s(e,t,i.g1)}function c(e,t){return s(e,t,i.lt)}var h=r(4163);function f(e,t,r,n){return new n(e,-1,t,r,{})}}}]);
//# sourceMappingURL=164.7ded7c7e.chunk.js.map